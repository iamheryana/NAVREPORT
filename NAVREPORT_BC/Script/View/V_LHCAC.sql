CREATE VIEW V_LHCAC AS

SELECT M08.KdCaba,M08.NmCaba,M08.SkCaba,M08.KaCaba,M08.AlCaba,M08.Kota,M08.Telpon,M08.Fax,M08.NoAcc,
M08.Created_By,M08.Updated_By,M08.Updated_On,M08.JABATAN,
    CASE WHEN M08.NPWP=' ' OR CAST (M08.NPWP AS DECIMAL(20,0))=0
	THEN ' '
	ELSE
		SUBSTRING (RIGHT('00000000000000'||M08.NPWP,15) FROM 1 FOR 2)||'.'||
		SUBSTRING (RIGHT('00000000000000'||M08.NPWP,15) FROM 3 FOR 3)||'.'||
		SUBSTRING (RIGHT('00000000000000'||M08.NPWP,15) FROM 6 FOR 3)||'.'||
		SUBSTRING (RIGHT('00000000000000'||M08.NPWP,15) FROM 9 FOR 1)||'.'||
		SUBSTRING (RIGHT('00000000000000'||M08.NPWP,15) FROM 10 FOR 3)||'.'||
		SUBSTRING (RIGHT('00000000000000'||M08.NPWP,15) FROM 13 FOR 3)
	END AS NPWP, 
	
	CASE     
	WHEN M08.NPWP2=' ' OR CAST (M08.NPWP2 AS DECIMAL(20,0))=0
	THEN ' '
	
	ELSE
		SUBSTRING (RIGHT('00000000000000'||M08.NPWP2,15) FROM 1 FOR 2)||'.'||
		SUBSTRING (RIGHT('00000000000000'||M08.NPWP2,15) FROM 3 FOR 3)||'.'||
		SUBSTRING (RIGHT('00000000000000'||M08.NPWP2,15) FROM 6 FOR 3)||'.'||
		SUBSTRING (RIGHT('00000000000000'||M08.NPWP2,15) FROM 9 FOR 1)||'.'||
		SUBSTRING (RIGHT('00000000000000'||M08.NPWP2,15) FROM 10 FOR 3)||'.'||
		SUBSTRING (RIGHT('00000000000000'||M08.NPWP2,15) FROM 13 FOR 3)
	END AS NPWP2

FROM M08HCAB M08;