<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="COGSAnalysis" language="groovy" pageWidth="800" pageHeight="595" orientation="Landscape" columnWidth="760" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="d67d58b6-db98-43fc-b2fe-6c1d43bc5f9a">
	<property name="ireport.zoom" value="1.9487171000000312"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="13"/>
	<parameter name="PeriodeFrom" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="PeriodeUpto" class="java.util.Date"/>
	<parameter name="Cabang" class="java.lang.String"/>
	<parameter name="Pembagi" class="java.math.BigDecimal">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT	XXX.GRUP_TITLE
		, XXX.AMOUNT_SALES
		, CASE WHEN XXX.TOTAL_SALES <> 0 THEN (XXX.AMOUNT_SALES / XXX.TOTAL_SALES ) * 100  ELSE 0 END AS PCN_TTL_SALES
		, XXX.AMOUNT_COGS
		, CASE WHEN XXX.TOTAL_COGS <> 0 THEN (XXX.AMOUNT_COGS / XXX.TOTAL_COGS ) * 100 ELSE 0 END AS PCN_TTL_COGS
		, (XXX.AMOUNT_SALES -  XXX.AMOUNT_COGS) AS MARGIN
		, CASE WHEN XXX.AMOUNT_SALES <> 0 THEN ((XXX.AMOUNT_SALES -  XXX.AMOUNT_COGS) / XXX.AMOUNT_SALES) * 100 ELSE 0 END AS PCN_MARGIN
		, CASE WHEN XXX.TOTAL_SALES <> 0 THEN ((XXX.TOTAL_SALES -  XXX.TOTAL_COGS) / XXX.TOTAL_SALES) * 100 ELSE 0 END AS PCN_MARGIN_TTL
FROM	(
SELECT	XX.GRUP_TITLE
		,SUM(ROUND((XX.AMOUNT_SALES / $P{Pembagi}),0)) OVER() AS TOTAL_SALES
		,SUM(ROUND((XX.AMOUNT_COGS / $P{Pembagi}),0)) OVER() AS TOTAL_COGS
		,ROUND((XX.AMOUNT_SALES / $P{Pembagi}),0) AS AMOUNT_SALES
		,ROUND((XX.AMOUNT_COGS / $P{Pembagi}),0) AS AMOUNT_COGS
FROM	(
SELECT	X.GRUP_TITLE
		,ROUND(SUM(X.AMOUNT_SALES_AJ),0) + ROUND(SUM(X.AMOUNT_SALES_SP),0) AS AMOUNT_SALES
		,ROUND(SUM(X.AMOUNT_COGS_AJ),0) + ROUND(SUM(X.AMOUNT_COGS_SP),0) AS AMOUNT_COGS
FROM (
SELECT	'1. HARDWARE' AS GRUP_TITLE
		, 0 AS AMOUNT_SALES_AJ
		, 0 AS AMOUNT_SALES_SP
		, 0 AS AMOUNT_COGS_AJ
		, 0 AS AMOUNT_COGS_SP
UNION ALL
SELECT	'2. 3rd PARTY SOFTWARE' AS GRUP_TITLE
		, 0 AS AMOUNT_SALES_AJ
		, 0 AS AMOUNT_SALES_SP
		, 0 AS AMOUNT_COGS_AJ
		, 0 AS AMOUNT_COGS_SP
UNION ALL
SELECT	'3. OWN SOFTWARE' AS GRUP_TITLE
		, 0 AS AMOUNT_SALES_AJ
		, 0 AS AMOUNT_SALES_SP
		, 0 AS AMOUNT_COGS_AJ
		, 0 AS AMOUNT_COGS_SP
UNION ALL
SELECT	'4. TECHNOLOGY SERVICE' AS GRUP_TITLE
		, 0 AS AMOUNT_SALES_AJ
		, 0 AS AMOUNT_SALES_SP
		, 0 AS AMOUNT_COGS_AJ
		, 0 AS AMOUNT_COGS_SP
UNION ALL
SELECT	'5. HARDWARE SERVICE' AS GRUP_TITLE
		, 0 AS AMOUNT_SALES_AJ
		, 0 AS AMOUNT_SALES_SP
		, 0 AS AMOUNT_COGS_AJ
		, 0 AS AMOUNT_COGS_SP
UNION ALL
SELECT	'6. MANAGE SERVICE' AS GRUP_TITLE
		, 0 AMOUNT_SALES_AJ
		, 0 AS AMOUNT_SALES_SP
		, 0 AS AMOUNT_COGS_AJ
		, 0 AS AMOUNT_COGS_SP
UNION ALL
SELECT	CASE	WHEN DIMS.ITEM_CAT = 'HW01' THEN '1. HARDWARE'
				WHEN DIMS.ITEM_CAT = 'PS01' THEN '2. 3rd PARTY SOFTWARE'
				WHEN DIMS.ITEM_CAT = 'PS02' THEN '3. OWN SOFTWARE'
				WHEN DIMS.ITEM_CAT = 'PS03' THEN '4. TECHNOLOGY SERVICE'
				WHEN DIMS.ITEM_CAT = 'PS04' THEN '5. HARDWARE SERVICE'
				WHEN DIMS.ITEM_CAT = 'PS05' THEN '6. MANAGE SERVICE'
		END AS GRUP_TITLE
		,SUM(GLE.[Amount]) * -1 AS AMOUNT_SALES_AJ
		, 0 AS AMOUNT_SALES_SP
		, 0 AS AMOUNT_COGS_AJ
		, 0 AS AMOUNT_COGS_SP
FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
LEFT JOIN	(
				SELECT	DIM.DIM_ID
						,MAX(DIM.BRANCHES) AS BRANCHES
						,MAX(DIM.ITEM_CAT) AS ITEM_CAT
						,MAX(DIM.SALESMAN) AS SALESMAN
				FROM	(
							SELECT [Dimension Set ID] AS DIM_ID
								  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
								  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
								  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
							FROM [AUTOJAYA].[dbo].[AUTOJAYA$Dimension Set Entry]
						) DIM
				GROUP BY DIM.DIM_ID
			) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
WHERE	(GLE.[G_L Account No_] BETWEEN '400.110.00'  AND '420.110.01') AND
		GLE.[G_L Account No_] <> '400.110.04' AND
		DIMS.ITEM_CAT <> '' AND
		(DIMS.BRANCHES = $P{Cabang} OR $P{Cabang} = 'ALL') AND
		(GLE.[Posting Date] >= $P{PeriodeFrom} AND GLE.[Posting Date] <=  $P{PeriodeUpto})
GROUP BY DIMS.ITEM_CAT
UNION ALL
SELECT	CASE	WHEN DIMS.ITEM_CAT = 'HW01' THEN '1. HARDWARE'
				WHEN DIMS.ITEM_CAT = 'PS01' THEN '2. 3rd PARTY SOFTWARE'
				WHEN DIMS.ITEM_CAT = 'PS02' THEN '3. OWN SOFTWARE'
				WHEN DIMS.ITEM_CAT = 'PS03' THEN '4. TECHNOLOGY SERVICE'
				WHEN DIMS.ITEM_CAT = 'PS04' THEN '5. HARDWARE SERVICE'
				WHEN DIMS.ITEM_CAT = 'PS05' THEN '6. MANAGE SERVICE'
		END AS GRUP_TITLE
		,SUM(GLE.[Amount]) AS AMOUNT_SALES_AJ
		, 0 AS AMOUNT_SALES_SP
		, 0 AS AMOUNT_COGS_AJ
		, 0 AS AMOUNT_COGS_SP
FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
LEFT JOIN	(
				SELECT	DIM.DIM_ID
						,MAX(DIM.BRANCHES) AS BRANCHES
						,MAX(DIM.ITEM_CAT) AS ITEM_CAT
						,MAX(DIM.SALESMAN) AS SALESMAN
				FROM	(
							SELECT [Dimension Set ID] AS DIM_ID
								  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
								  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
								  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
							FROM [AUTOJAYA].[dbo].[AUTOJAYA$Dimension Set Entry]
						) DIM
				GROUP BY DIM.DIM_ID
			) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Header] SLH ON SLH.[No_] = SIH.[Prepayment Order No_]
LEFT JOIN	(
				SELECT CLE.[Entry No_]
						, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE.[Document No_] ELSE CLE2.[Document No_] END AS NO_UM
						, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE2.[Document No_] ELSE CLE.[Document No_] END AS NO_CM
				FROM [AUTOJAYA].[dbo].[AUTOJAYA$Cust_ Ledger Entry] CLE
				LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Cust_ Ledger Entry] CLE2 ON CLE2.[Entry No_] = CLE.[Closed by Entry No_]
				WHERE CLE.[Document Type] IN (2,3)
				AND ((CLE.[Document No_]  LIKE 'UM%' AND CLE2.[Document Type] = 3) OR
					(CLE2.[Document No_]  LIKE 'UM%' AND CLE.[Document Type] = 3) )
			) CM ON CM.NO_UM = GLE.[Document No_]
LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Cr_Memo Header] CMH ON CMH.[No_] = CM.NO_CM
LEFT JOIN	(
				SELECT [Order No_] AS NO_SO
						,MAX([Posting Date]) AS TGL_INV
				FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header]
				WHERE [Order No_] <> ''
				GROUP BY [Order No_]
			) INV ON INV.NO_SO = SIH.[Prepayment Order No_]
WHERE GLE.[G_L Account No_] = '400.110.03'
	  AND GLE.[Document No_] LIKE 'UM%'
	  AND (DIMS.BRANCHES = $P{Cabang} OR $P{Cabang} = 'ALL')
	  AND (CM.NO_CM IS NULL OR (CM.NO_CM IS NOT NULL AND CMH.[Posting Date] > $P{PeriodeUpto} ))
	  AND (INV.TGL_INV IS NULL OR (INV.TGL_INV IS NOT NULL AND INV.TGL_INV > $P{PeriodeUpto}))
	  AND (SIH.[Posting Date] >= $P{PeriodeFrom} AND SIH.[Posting Date] <= $P{PeriodeUpto})
GROUP BY DIMS.ITEM_CAT
UNION ALL
SELECT	CASE	WHEN DIMS.ITEM_CAT = 'HW01' THEN '1. HARDWARE'
				WHEN DIMS.ITEM_CAT = 'PS01' THEN '2. 3rd PARTY SOFTWARE'
				WHEN DIMS.ITEM_CAT = 'PS02' THEN '3. OWN SOFTWARE'
				WHEN DIMS.ITEM_CAT = 'PS03' THEN '4. TECHNOLOGY SERVICE'
				WHEN DIMS.ITEM_CAT = 'PS04' THEN '5. HARDWARE SERVICE'
				WHEN DIMS.ITEM_CAT = 'PS05' THEN '6. MANAGE SERVICE'
		END AS GRUP_TITLE
		,SUM(GLE.[Amount]) * -1 AS AMOUNT_SALES_AJ
		, 0 AS AMOUNT_SALES_SP
		, 0 AS AMOUNT_COGS_AJ
		, 0 AS AMOUNT_COGS_SP
FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
LEFT JOIN	(
				SELECT	DIM.DIM_ID
						,MAX(DIM.BRANCHES) AS BRANCHES
						,MAX(DIM.ITEM_CAT) AS ITEM_CAT
						,MAX(DIM.SALESMAN) AS SALESMAN
				FROM	(
							SELECT [Dimension Set ID] AS DIM_ID
								  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
								  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
								  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
							FROM [AUTOJAYA].[dbo].[AUTOJAYA$Dimension Set Entry]
						) DIM
				GROUP BY DIM.DIM_ID
			) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Header] SLH ON SLH.[No_] = SIH.[Prepayment Order No_]
LEFT JOIN	(
				SELECT CLE.[Entry No_]
						, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE.[Document No_] ELSE CLE2.[Document No_] END AS NO_UM
						, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE2.[Document No_] ELSE CLE.[Document No_] END AS NO_CM
				FROM [AUTOJAYA].[dbo].[AUTOJAYA$Cust_ Ledger Entry] CLE
				LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Cust_ Ledger Entry] CLE2 ON CLE2.[Entry No_] = CLE.[Closed by Entry No_]
				WHERE CLE.[Document Type] IN (2,3)
				AND ((CLE.[Document No_]  LIKE 'UM%' AND CLE2.[Document Type] = 3) OR
					(CLE2.[Document No_]  LIKE 'UM%' AND CLE.[Document Type] = 3) )
			) CM ON CM.NO_UM = GLE.[Document No_]
LEFT JOIN	(
				SELECT [Order No_] AS NO_SO
						,MAX([Posting Date]) AS TGL_INV
				FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header]
				WHERE [Order No_] <> ''
				GROUP BY [Order No_]
			) INV ON INV.NO_SO = SIH.[Prepayment Order No_]
WHERE GLE.[G_L Account No_] = '400.110.03'
	  AND GLE.[Document No_] LIKE 'UM%'
	  AND (DIMS.BRANCHES = $P{Cabang} OR $P{Cabang} = 'ALL')
	  AND CM.NO_CM IS NULL
	  AND (INV.TGL_INV >= $P{PeriodeFrom} AND INV.TGL_INV <= $P{PeriodeUpto})
	  AND (SIH.[Posting Date] < $P{PeriodeFrom})
GROUP BY DIMS.ITEM_CAT
UNION ALL
SELECT	CASE	WHEN DIMS.ITEM_CAT = 'HW01' THEN '1. HARDWARE'
				WHEN DIMS.ITEM_CAT = 'PS01' THEN '2. 3rd PARTY SOFTWARE'
				WHEN DIMS.ITEM_CAT = 'PS02' THEN '3. OWN SOFTWARE'
				WHEN DIMS.ITEM_CAT = 'PS03' THEN '4. TECHNOLOGY SERVICE'
				WHEN DIMS.ITEM_CAT = 'PS04' THEN '5. HARDWARE SERVICE'
				WHEN DIMS.ITEM_CAT = 'PS05' THEN '6. MANAGE SERVICE'
		END AS GRUP_TITLE
		,SUM(GLE.[Amount]) * -1 AS AMOUNT_SALES_AJ
		, 0 AS AMOUNT_SALES_SP
		, 0 AS AMOUNT_COGS_AJ
		, 0 AS AMOUNT_COGS_SP
FROM [AUTOJAYA].[dbo].[AJ-ADJ$G_L Entry] GLE
LEFT JOIN	(
				SELECT	DIM.DIM_ID
						,MAX(DIM.BRANCHES) AS BRANCHES
						,MAX(DIM.ITEM_CAT) AS ITEM_CAT
						,MAX(DIM.SALESMAN) AS SALESMAN
				FROM	(
							SELECT [Dimension Set ID] AS DIM_ID
								  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
								  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
								  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
							FROM [AUTOJAYA].[dbo].[AJ-ADJ$Dimension Set Entry]
						) DIM
				GROUP BY DIM.DIM_ID
			) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
WHERE	(GLE.[G_L Account No_] BETWEEN '400.110.00'  AND '420.110.01') AND
		GLE.[G_L Account No_] <> '400.110.04' AND
		DIMS.ITEM_CAT <> '' AND
		(DIMS.BRANCHES = $P{Cabang} OR $P{Cabang} = 'ALL') AND
		(GLE.[Posting Date] >= $P{PeriodeFrom} AND GLE.[Posting Date] <=  $P{PeriodeUpto})
GROUP BY DIMS.ITEM_CAT
UNION ALL
SELECT	'1. HARDWARE' AS GRUP_TITLE
		, SUM(SLC.[Amount]) AS AMOUNT_SALES_AJ
		, 0 AS AMOUNT_SALES_SP
		, 0 AS AMOUNT_COGS_AJ
		, 0 AS AMOUNT_COGS_SP
FROM	(
			SELECT	CASE WHEN GLE.[Source No_] = 'SOPE001' THEN '2. Sales INTERCOY' ELSE '1. Sales FA' END AS SALES_TITLE
					,CASE WHEN GLE.[Source No_] = 'SOPE001' THEN '(-) Sales INTERCOY' ELSE '(-) Sales FA' END AS SALES_TITLE2
					,CASE WHEN GLE.[Source No_] = 'SOPE001' THEN 'SLS-0302' ELSE 'SLS-0301' END AS SORT_SLS
					, GLE.[Amount]
			FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
			WHERE GLE.[G_L Account No_] IN ('400.110.01', '410.110.01', '420.110.01')
					AND GLE.[Posting Date] >= $P{PeriodeFrom} AND GLE.[Posting Date] <=  $P{PeriodeUpto}
			UNION ALL
			SELECT	'3. Others Sales Adjustment' AS SALES_TITLE
					,'(-/+) Others Management Adjustment' AS SALES_TITLE2
					,'SLS-0303' AS SORT_SLS
					, GLE.[Amount]
			FROM [AUTOJAYA].[dbo].[AJ-ADJ$G_L Entry] GLE
			WHERE GLE.[G_L Account No_] IN ('400.110.01', '410.110.01', '420.110.01')
					AND GLE.[Posting Date] >= $P{PeriodeFrom} AND GLE.[Posting Date] <=  $P{PeriodeUpto}
		) SLC
WHERE $P{Cabang} = 'ALL' OR $P{Cabang} = '10'
GROUP BY SLC.SALES_TITLE, SLC.SALES_TITLE2, SLC.SORT_SLS
UNION ALL
SELECT	CASE	WHEN DIMS.ITEM_CAT = 'HW01' THEN '1. HARDWARE'
				WHEN DIMS.ITEM_CAT = 'PS01' THEN '2. 3rd PARTY SOFTWARE'
				WHEN DIMS.ITEM_CAT = 'PS02' THEN '3. OWN SOFTWARE'
				WHEN DIMS.ITEM_CAT = 'PS03' THEN '4. TECHNOLOGY SERVICE'
				WHEN DIMS.ITEM_CAT = 'PS04' THEN '5. HARDWARE SERVICE'
				WHEN DIMS.ITEM_CAT = 'PS05' THEN '6. MANAGE SERVICE'
		END AS GRUP_TITLE
		, 0 AS AMOUNT_SALES_AJ
		, SUM(GLE.[Amount]) * -1 AS AMOUNT_SALES_SP
		, 0 AS AMOUNT_COGS_AJ
		, 0 AS AMOUNT_COGS_SP
FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
LEFT JOIN	(
				SELECT	DIM.DIM_ID
						,MAX(DIM.BRANCHES) AS BRANCHES
						,MAX(DIM.ITEM_CAT) AS ITEM_CAT
						,MAX(DIM.SALESMAN) AS SALESMAN
				FROM	(
							SELECT [Dimension Set ID] AS DIM_ID
								  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
								  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
								  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
							FROM [AUTOJAYA].[dbo].[SOLUSI$Dimension Set Entry]
						) DIM
				GROUP BY DIM.DIM_ID
			) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
WHERE	(GLE.[G_L Account No_] BETWEEN '400.110.00'  AND '420.110.01') AND
		GLE.[G_L Account No_] <> '400.110.04' AND
		DIMS.ITEM_CAT <> '' AND
		(DIMS.BRANCHES = $P{Cabang} OR $P{Cabang} = 'ALL') AND
		(GLE.[Posting Date] >= $P{PeriodeFrom} AND GLE.[Posting Date] <=  $P{PeriodeUpto})
GROUP BY DIMS.ITEM_CAT
UNION ALL
SELECT	CASE	WHEN DIMS.ITEM_CAT = 'HW01' THEN '1. HARDWARE'
				WHEN DIMS.ITEM_CAT = 'PS01' THEN '2. 3rd PARTY SOFTWARE'
				WHEN DIMS.ITEM_CAT = 'PS02' THEN '3. OWN SOFTWARE'
				WHEN DIMS.ITEM_CAT = 'PS03' THEN '4. TECHNOLOGY SERVICE'
				WHEN DIMS.ITEM_CAT = 'PS04' THEN '5. HARDWARE SERVICE'
				WHEN DIMS.ITEM_CAT = 'PS05' THEN '6. MANAGE SERVICE'
		END AS GRUP_TITLE
		, 0 AS AMOUNT_SALES_AJ
		, SUM(GLE.[Amount]) AS AMOUNT_SALES_SP
		, 0 AS AMOUNT_COGS_AJ
		, 0 AS AMOUNT_COGS_SP
FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
LEFT JOIN	(
				SELECT	DIM.DIM_ID
						,MAX(DIM.BRANCHES) AS BRANCHES
						,MAX(DIM.ITEM_CAT) AS ITEM_CAT
						,MAX(DIM.SALESMAN) AS SALESMAN
				FROM	(
							SELECT [Dimension Set ID] AS DIM_ID
								  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
								  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
								  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
							FROM [AUTOJAYA].[dbo].[SOLUSI$Dimension Set Entry]
						) DIM
				GROUP BY DIM.DIM_ID
			) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Header] SLH ON SLH.[No_] = SIH.[Prepayment Order No_]
LEFT JOIN	(
				SELECT CLE.[Entry No_]
						, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE.[Document No_] ELSE CLE2.[Document No_] END AS NO_UM
						, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE2.[Document No_] ELSE CLE.[Document No_] END AS NO_CM
				FROM [AUTOJAYA].[dbo].[SOLUSI$Cust_ Ledger Entry] CLE
				LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Cust_ Ledger Entry] CLE2 ON CLE2.[Entry No_] = CLE.[Closed by Entry No_]
				WHERE CLE.[Document Type] IN (2,3)
				AND ((CLE.[Document No_]  LIKE 'UM%' AND CLE2.[Document Type] = 3) OR
					(CLE2.[Document No_]  LIKE 'UM%' AND CLE.[Document Type] = 3) )
			) CM ON CM.NO_UM = GLE.[Document No_]
LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Cr_Memo Header] CMH ON CMH.[No_] = CM.NO_CM
LEFT JOIN	(
				SELECT [Order No_] AS NO_SO
						,MAX([Posting Date]) AS TGL_INV
				FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header]
				WHERE [Order No_] <> ''
				GROUP BY [Order No_]
			) INV ON INV.NO_SO = SIH.[Prepayment Order No_]
WHERE GLE.[G_L Account No_] = '400.110.03'
	  AND GLE.[Document No_] LIKE 'UM%'
	  AND (DIMS.BRANCHES = $P{Cabang} OR $P{Cabang} = 'ALL')
	  AND (CM.NO_CM IS NULL OR (CM.NO_CM IS NOT NULL AND CMH.[Posting Date] > $P{PeriodeUpto} ))
	  AND (INV.TGL_INV IS NULL OR (INV.TGL_INV IS NOT NULL AND INV.TGL_INV > $P{PeriodeUpto}))
	  AND (SIH.[Posting Date] >= $P{PeriodeFrom} AND SIH.[Posting Date] <= $P{PeriodeUpto})
GROUP BY DIMS.ITEM_CAT
UNION ALL
SELECT	CASE	WHEN DIMS.ITEM_CAT = 'HW01' THEN '1. HARDWARE'
				WHEN DIMS.ITEM_CAT = 'PS01' THEN '2. 3rd PARTY SOFTWARE'
				WHEN DIMS.ITEM_CAT = 'PS02' THEN '3. OWN SOFTWARE'
				WHEN DIMS.ITEM_CAT = 'PS03' THEN '4. TECHNOLOGY SERVICE'
				WHEN DIMS.ITEM_CAT = 'PS04' THEN '5. HARDWARE SERVICE'
				WHEN DIMS.ITEM_CAT = 'PS05' THEN '6. MANAGE SERVICE'
		END AS GRUP_TITLE
		, 0 AS AMOUNT_SALES_AJ
		, SUM(GLE.[Amount]) * -1 AS AMOUNT_SALES_SP
		, 0 AS AMOUNT_COGS_AJ
		, 0 AS AMOUNT_COGS_SP
FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
LEFT JOIN	(
				SELECT	DIM.DIM_ID
						,MAX(DIM.BRANCHES) AS BRANCHES
						,MAX(DIM.ITEM_CAT) AS ITEM_CAT
						,MAX(DIM.SALESMAN) AS SALESMAN
				FROM	(
							SELECT [Dimension Set ID] AS DIM_ID
								  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
								  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
								  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
							FROM [AUTOJAYA].[dbo].[SOLUSI$Dimension Set Entry]
						) DIM
				GROUP BY DIM.DIM_ID
			) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Header] SLH ON SLH.[No_] = SIH.[Prepayment Order No_]
LEFT JOIN	(
				SELECT CLE.[Entry No_]
						, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE.[Document No_] ELSE CLE2.[Document No_] END AS NO_UM
						, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE2.[Document No_] ELSE CLE.[Document No_] END AS NO_CM
				FROM [AUTOJAYA].[dbo].[SOLUSI$Cust_ Ledger Entry] CLE
				LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Cust_ Ledger Entry] CLE2 ON CLE2.[Entry No_] = CLE.[Closed by Entry No_]
				WHERE CLE.[Document Type] IN (2,3)
				AND ((CLE.[Document No_]  LIKE 'UM%' AND CLE2.[Document Type] = 3) OR
					(CLE2.[Document No_]  LIKE 'UM%' AND CLE.[Document Type] = 3) )
			) CM ON CM.NO_UM = GLE.[Document No_]
LEFT JOIN	(
				SELECT [Order No_] AS NO_SO
						,MAX([Posting Date]) AS TGL_INV
				FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header]
				WHERE [Order No_] <> ''
				GROUP BY [Order No_]
			) INV ON INV.NO_SO = SIH.[Prepayment Order No_]
WHERE GLE.[G_L Account No_] = '400.110.03'
	  AND GLE.[Document No_] LIKE 'UM%'
	  AND (DIMS.BRANCHES = $P{Cabang} OR $P{Cabang} = 'ALL')
	  AND CM.NO_CM IS NULL
	  AND (INV.TGL_INV >= $P{PeriodeFrom} AND INV.TGL_INV <= $P{PeriodeUpto})
	  AND (SIH.[Posting Date] < $P{PeriodeFrom})
GROUP BY DIMS.ITEM_CAT
UNION ALL
SELECT	CASE	WHEN DIMS.ITEM_CAT = 'HW01' THEN '1. HARDWARE'
				WHEN DIMS.ITEM_CAT = 'PS01' THEN '2. 3rd PARTY SOFTWARE'
				WHEN DIMS.ITEM_CAT = 'PS02' THEN '3. OWN SOFTWARE'
				WHEN DIMS.ITEM_CAT = 'PS03' THEN '4. TECHNOLOGY SERVICE'
				WHEN DIMS.ITEM_CAT = 'PS04' THEN '5. HARDWARE SERVICE'
				WHEN DIMS.ITEM_CAT = 'PS05' THEN '6. MANAGE SERVICE'
		END AS GRUP_TITLE
		, 0 AS AMOUNT_SALES_AJ
		, SUM(GLE.[Amount]) * -1 AS AMOUNT_SALES_SP
		, 0 AS AMOUNT_COGS_AJ
		, 0 AS AMOUNT_COGS_SP
FROM [AUTOJAYA].[dbo].[SP-ADJ$G_L Entry] GLE
LEFT JOIN	(
				SELECT	DIM.DIM_ID
						,MAX(DIM.BRANCHES) AS BRANCHES
						,MAX(DIM.ITEM_CAT) AS ITEM_CAT
						,MAX(DIM.SALESMAN) AS SALESMAN
				FROM	(
							SELECT [Dimension Set ID] AS DIM_ID
								  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
								  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
								  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
							FROM [AUTOJAYA].[dbo].[SP-ADJ$Dimension Set Entry]
						) DIM
				GROUP BY DIM.DIM_ID
			) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
WHERE	(GLE.[G_L Account No_] BETWEEN '400.110.00'  AND '420.110.01') AND
		GLE.[G_L Account No_] <> '400.110.04' AND
		DIMS.ITEM_CAT <> '' AND
		(DIMS.BRANCHES = $P{Cabang} OR $P{Cabang} = 'ALL') AND
		(GLE.[Posting Date] >= $P{PeriodeFrom} AND GLE.[Posting Date] <= $P{PeriodeUpto})
GROUP BY DIMS.ITEM_CAT
UNION ALL
SELECT	'1. HARDWARE' AS GRUP_TITLE
		, 0 AS AMOUNT_SALES_AJ
		, SUM(SLC.[Amount]) AS AMOUNT_SALES_SP
		, 0 AS AMOUNT_COGS_AJ
		, 0 AS AMOUNT_COGS_SP
FROM	(
			SELECT	CASE WHEN GLE.[Source No_] <> 'SOPE001' THEN '2. Sales INTERCOY' ELSE '1. Sales FA' END AS SALES_TITLE
					,CASE WHEN GLE.[Source No_] <> 'SOPE001' THEN '(-) Sales INTERCOY' ELSE '(-) Sales FA' END AS SALES_TITLE2
					,CASE WHEN GLE.[Source No_] <> 'SOPE001' THEN 'SLS-0302' ELSE 'SLS-0301' END AS SORT_SLS
					, GLE.[Amount]
			FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
			WHERE GLE.[G_L Account No_] IN ('400.110.01', '410.110.01', '420.110.01')
					AND (GLE.[Posting Date] >= $P{PeriodeFrom} AND GLE.[Posting Date] <= $P{PeriodeUpto})
			UNION ALL
			SELECT	'3. Others Sales Adjustment' AS SALES_TITLE
					,'(-/+) Others Management Adjustment' AS SALES_TITLE2
					,'SLS-0303' AS SORT_SLS
					, GLE.[Amount]
			FROM [AUTOJAYA].[dbo].[SP-ADJ$G_L Entry] GLE
			WHERE GLE.[G_L Account No_] IN ('400.110.01', '410.110.01', '420.110.01')
					AND GLE.[Posting Date] >= $P{PeriodeFrom} AND GLE.[Posting Date] <=  $P{PeriodeUpto}
		) SLC
WHERE $P{Cabang} = 'ALL' OR $P{Cabang} = '10'
GROUP BY SLC.SALES_TITLE, SLC.SALES_TITLE2, SLC.SORT_SLS
UNION ALL
SELECT	CASE	WHEN DIMS.ITEM_CAT = 'HW01' THEN '1. HARDWARE'
				WHEN DIMS.ITEM_CAT = 'PS01' THEN '2. 3rd PARTY SOFTWARE'
				WHEN DIMS.ITEM_CAT = 'PS02' THEN '3. OWN SOFTWARE'
				WHEN DIMS.ITEM_CAT = 'PS03' THEN '4. TECHNOLOGY SERVICE'
				WHEN DIMS.ITEM_CAT = 'PS04' THEN '5. HARDWARE SERVICE'
				WHEN DIMS.ITEM_CAT = 'PS05' THEN '6. MANAGE SERVICE'
		END AS GRUP_TITLE
		, 0 AS AMOUNT_SALES_AJ
		, 0 AS AMOUNT_SALES_SP
		, SUM(GLE.[Amount]) AS AMOUNT_COGS_AJ
		, 0 AS AMOUNT_COGS_SP
FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
LEFT JOIN	(
				SELECT	DIM.DIM_ID
						,MAX(DIM.BRANCHES) AS BRANCHES
						,MAX(DIM.ITEM_CAT) AS ITEM_CAT
						,MAX(DIM.SALESMAN) AS SALESMAN
				FROM	(
							SELECT [Dimension Set ID] AS DIM_ID
								  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
								  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
								  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
							FROM [AUTOJAYA].[dbo].[AUTOJAYA$Dimension Set Entry]
						) DIM
				GROUP BY DIM.DIM_ID
			) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
WHERE	GLE.[G_L Account No_] BETWEEN '500.110.00'  AND '500.111.00' AND
		DIMS.ITEM_CAT <> '' AND
		(DIMS.BRANCHES = $P{Cabang} OR $P{Cabang} = 'ALL') AND
		(GLE.[Posting Date] >= $P{PeriodeFrom} AND GLE.[Posting Date] <= $P{PeriodeUpto})
GROUP BY DIMS.ITEM_CAT
UNION ALL
SELECT	CASE	WHEN DII.CATEGORY = 'HW01' THEN '1. HARDWARE'
				WHEN DII.CATEGORY = 'PS01' THEN '2. 3rd PARTY SOFTWARE'
				WHEN DII.CATEGORY = 'PS02' THEN '3. OWN SOFTWARE'
				WHEN DII.CATEGORY = 'PS03' THEN '4. TECHNOLOGY SERVICE'
				WHEN DII.CATEGORY = 'PS04' THEN '5. HARDWARE SERVICE'
				WHEN DII.CATEGORY = 'PS05' THEN '6. MANAGE SERVICE'
		END AS GRUP_TITLE
		, 0 AS AMOUNT_SALES_AJ
		, 0 AS AMOUNT_SALES_SP
		,SUM(DII.AMOUNT) * -1 AS AMOUNT_COGS_AJ
		, 0 AS AMOUNT_COGS_SP
FROM
(
SELECT	DOO.TGL_SJ
		,DOO.NO_SJ
		,DOO.CABANG
		,DOO.CATEGORY
		,DOO.AMOUNT
		,CASE WHEN DOI.NO_INVOICE IS NULL AND
			(
				SELECT CASE WHEN SUM(SHL.[Quantity]) = SUM(SHL.[Quantity Invoiced]) THEN 'Y' ELSE 'N' END AS INV
				FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Shipment Line] SHL
				WHERE SHL.[Document No_] = DOO.NO_SJ
				GROUP BY SHL.[Document No_]
			) = 'Y' THEN
			(
				SELECT (IOO.NO_INV)
				FROM	(
							SELECT
									DISTINCT SIH.[No_] AS NO_INV,
									SIH.[Posting Date] AS TGL_INV,
									CASE WHEN SIL.[Shipment No_] <> '' THEN SIL.[Shipment No_] ELSE DOA.[No_] END AS NO_DO
							FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] SIH
							INNER JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Line] SIL ON SIL.[Document No_] = SIH.[No_]
							LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Shipment Header] DOA ON DOA.[Order No_] = SIH.[Order No_]
							WHERE SIL.[Type] = 2
						)IOO
				WHERE IOO.NO_DO  = DOO.NO_SJ AND
					  IOO.TGL_INV < DOO.TGL_SJ
			) ELSE DOI.NO_INVOICE END AS NO_INVOICE
		,DOI.TGL_INV
FROM
(
	SELECT GLE.[Posting Date] AS TGL_SJ
		  ,GLE.[Document No_] AS NO_SJ
		  ,GLE.[Global Dimension 1 Code] AS CABANG
		  ,GLE.[Global Dimension 2 Code] AS CATEGORY
		  ,SUM(GLE.[Amount]) AS AMOUNT
	FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
	INNER JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Shipment Header] DOA ON DOA.[No_] = GLE.[Document No_]
	WHERE GLE.[G_L Account No_]= '500.110.00'
			AND DOA.[Bill-to Customer No_] NOT IN ('SOPE001', 'AUJA001', 'AUJA002')
	GROUP BY GLE.[Posting Date], GLE.[Document No_]
			,GLE.[Global Dimension 1 Code] ,GLE.[Global Dimension 2 Code]
) DOO
LEFT JOIN	(
				SELECT XXX.NO_SJ
						,XXX.TGL_INV
						,(
							SELECT MAX(ISJ.[No_]) AS NO_INVOICE
							FROM (
									SELECT
											SIH.[No_],
											SIH.[Posting Date],
											CASE WHEN SIL.[Shipment No_] <> '' THEN SIL.[Shipment No_] ELSE DOA.[No_] END AS NO_DO
									FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] SIH
									INNER JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Line] SIL ON SIL.[Document No_] = SIH.[No_]
									LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Shipment Header] DOA ON DOA.[Order No_] = SIH.[Order No_]
									WHERE SIL.[Type] = 2
								) ISJ
							WHERE ISJ.NO_DO = XXX.NO_SJ AND ISJ.[Posting Date] = XXX.TGL_INV
						) AS NO_INVOICE
				FROM
				(
				SELECT  DO.[No_] AS NO_SJ
						,
						(
								SELECT MIN(ISJ2.[Posting Date])
								FROM	(
										SELECT	SIH2.[Posting Date],
												CASE WHEN SIL2.[Shipment No_] <> '' THEN SIL2.[Shipment No_] ELSE DOA2.[No_] END AS NO_DO
										FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] SIH2
										INNER JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Line] SIL2 ON SIL2.[Document No_] = SIH2.[No_]
										LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Shipment Header] DOA2 ON DOA2.[Order No_] = SIH2.[Order No_]
										WHERE SIL2.[Type] = 2
										) ISJ2
								WHERE ISJ2.NO_DO  = DO.[No_]
									   AND CONVERT(VARCHAR(6), ISJ2.[Posting Date], 112) >= CONVERT(VARCHAR(6), DO.[Posting Date], 112)
						) AS TGL_INV
				FROM[AUTOJAYA].[dbo].[AUTOJAYA$Sales Shipment Header] DO
				) XXX
			) DOI ON DOI.NO_SJ = DOO.NO_SJ
LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Cr_Memo Header] CRM ON CRM.[Applies-to Doc_ No_] = DOI.NO_INVOICE
WHERE DOO.AMOUNT <> 0
		AND CRM.[No_] IS NULL
) DII
LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] SIH3 ON SIH3.[No_] = DII.NO_INVOICE
LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Cr_Memo Header] CRM2 ON CRM2.[Applies-to Doc_ No_] = DII.NO_INVOICE
WHERE	CRM2.[No_] IS NULL
		AND (	DII.NO_INVOICE IS NULL
				OR
				SIH3.[Posting Date] > $P{PeriodeUpto}
			)
		AND (DII.TGL_SJ >= $P{PeriodeFrom}  AND DII.TGL_SJ <= $P{PeriodeUpto})
		AND (DII.CABANG = $P{Cabang} OR $P{Cabang} = 'ALL')
GROUP BY DII.CATEGORY
UNION ALL
SELECT	CASE	WHEN DII.CATEGORY = 'HW01' THEN '1. HARDWARE'
				WHEN DII.CATEGORY = 'PS01' THEN '2. 3rd PARTY SOFTWARE'
				WHEN DII.CATEGORY = 'PS02' THEN '3. OWN SOFTWARE'
				WHEN DII.CATEGORY = 'PS03' THEN '4. TECHNOLOGY SERVICE'
				WHEN DII.CATEGORY = 'PS04' THEN '5. HARDWARE SERVICE'
				WHEN DII.CATEGORY = 'PS05' THEN '6. MANAGE SERVICE'
		END AS GRUP_TITLE
		, 0 AS AMOUNT_SALES_AJ
		, 0 AS AMOUNT_SALES_SP
		,SUM(DII.AMOUNT) AS AMOUNT_COGS_AJ
		, 0 AS AMOUNT_COGS_SP
FROM
(
SELECT	DOO.TGL_SJ
		,DOO.NO_SJ
		,DOO.CABANG
		,DOO.CATEGORY
		,DOO.AMOUNT
		,CASE WHEN DOI.NO_INVOICE IS NULL AND
			(
				SELECT CASE WHEN SUM(SHL.[Quantity]) = SUM(SHL.[Quantity Invoiced]) THEN 'Y' ELSE 'N' END AS INV
				FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Shipment Line] SHL
				WHERE SHL.[Document No_] = DOO.NO_SJ
				GROUP BY SHL.[Document No_]
			) = 'Y' THEN
			(
				SELECT (IOO.NO_INV)
				FROM	(
							SELECT
									DISTINCT SIH.[No_] AS NO_INV,
									SIH.[Posting Date] AS TGL_INV,
									CASE WHEN SIL.[Shipment No_] <> '' THEN SIL.[Shipment No_] ELSE DOA.[No_] END AS NO_DO
							FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] SIH
							INNER JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Line] SIL ON SIL.[Document No_] = SIH.[No_]
							LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Shipment Header] DOA ON DOA.[Order No_] = SIH.[Order No_]
							WHERE SIL.[Type] = 2
						)IOO
				WHERE IOO.NO_DO  = DOO.NO_SJ AND
					  IOO.TGL_INV < DOO.TGL_SJ
			) ELSE DOI.NO_INVOICE END AS NO_INVOICE
		,DOI.TGL_INV
FROM
(
	SELECT GLE.[Posting Date] AS TGL_SJ
		  ,GLE.[Document No_] AS NO_SJ
		  ,GLE.[Global Dimension 1 Code] AS CABANG
		  ,GLE.[Global Dimension 2 Code] AS CATEGORY
		  ,SUM(GLE.[Amount]) AS AMOUNT
	FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
	INNER JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Shipment Header] DOA ON DOA.[No_] = GLE.[Document No_]
	WHERE GLE.[G_L Account No_]= '500.110.00'
			AND DOA.[Bill-to Customer No_] NOT IN ('SOPE001', 'AUJA001', 'AUJA002')
	GROUP BY GLE.[Posting Date], GLE.[Document No_]
			,GLE.[Global Dimension 1 Code] ,GLE.[Global Dimension 2 Code]
) DOO
LEFT JOIN	(
				SELECT XXX.NO_SJ
						,XXX.TGL_INV
						,(
							SELECT MAX(ISJ.[No_]) AS NO_INVOICE
							FROM (
									SELECT
											SIH.[No_],
											SIH.[Posting Date],
											CASE WHEN SIL.[Shipment No_] <> '' THEN SIL.[Shipment No_] ELSE DOA.[No_] END AS NO_DO
									FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] SIH
									INNER JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Line] SIL ON SIL.[Document No_] = SIH.[No_]
									LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Shipment Header] DOA ON DOA.[Order No_] = SIH.[Order No_]
									WHERE SIL.[Type] = 2
								) ISJ
							WHERE ISJ.NO_DO = XXX.NO_SJ AND ISJ.[Posting Date] = XXX.TGL_INV
						) AS NO_INVOICE
				FROM
				(
				SELECT  DO.[No_] AS NO_SJ
						,
						(
								SELECT MIN(ISJ2.[Posting Date])
								FROM	(
										SELECT	SIH2.[Posting Date],
												CASE WHEN SIL2.[Shipment No_] <> '' THEN SIL2.[Shipment No_] ELSE DOA2.[No_] END AS NO_DO
										FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] SIH2
										INNER JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Line] SIL2 ON SIL2.[Document No_] = SIH2.[No_]
										LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Shipment Header] DOA2 ON DOA2.[Order No_] = SIH2.[Order No_]
										WHERE SIL2.[Type] = 2
										) ISJ2
								WHERE ISJ2.NO_DO  = DO.[No_]
									   AND CONVERT(VARCHAR(6), ISJ2.[Posting Date], 112) >= CONVERT(VARCHAR(6), DO.[Posting Date], 112)
						) AS TGL_INV
				FROM[AUTOJAYA].[dbo].[AUTOJAYA$Sales Shipment Header] DO
				) XXX
			) DOI ON DOI.NO_SJ = DOO.NO_SJ
LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Cr_Memo Header] CRM ON CRM.[Applies-to Doc_ No_] = DOI.NO_INVOICE
WHERE DOO.AMOUNT <> 0
		AND CRM.[No_] IS NULL
) DII
LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] SIH3 ON SIH3.[No_] = DII.NO_INVOICE
LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Cr_Memo Header] CRM2 ON CRM2.[Applies-to Doc_ No_] = DII.NO_INVOICE
WHERE	CRM2.[No_] IS NULL
		AND (SIH3.[Posting Date] >= $P{PeriodeFrom}  AND SIH3.[Posting Date] <= $P{PeriodeUpto} )
		AND (DII.TGL_SJ < $P{PeriodeFrom})
		AND (DII.CABANG = $P{Cabang} OR $P{Cabang} = 'ALL')
GROUP BY DII.CATEGORY
UNION ALL
SELECT	'1. HARDWARE' AS GRUP_TITLE
		, 0 AS AMOUNT_SALES_AJ
		, 0 AS AMOUNT_SALES_SP
		, ISNULL(SUM(GLE.[Amount]),0)  AS AMOUNT_COGS_AJ
		, 0 AS AMOUNT_COGS_SP
FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
WHERE	GLE.[G_L Account No_] = '600.110.00'
		AND (GLE.[Global Dimension 1 Code] = $P{Cabang} OR $P{Cabang} = 'ALL')
		AND (GLE.[Posting Date] >= $P{PeriodeFrom} AND GLE.[Posting Date] <= $P{PeriodeUpto})
UNION ALL
SELECT	'1. HARDWARE' AS GRUP_TITLE
		, 0 AS AMOUNT_SALES_AJ
		, 0 AS AMOUNT_SALES_SP
		, ISNULL(SUM(GLE.[Amount]),0) AS AMOUNT_COGS_AJ
		, 0 AS AMOUNT_COGS_SP
FROM [AUTOJAYA].[dbo].[AJ-ADJ$G_L Entry] GLE
WHERE	GLE.[G_L Account No_] = '600.110.00'
		AND (GLE.[Global Dimension 1 Code] = $P{Cabang} OR $P{Cabang} = 'ALL')
		AND (GLE.[Posting Date] >= $P{PeriodeFrom} AND GLE.[Posting Date] <= $P{PeriodeUpto})
UNION ALL
SELECT	CASE	WHEN DIMS.ITEM_CAT = 'HW01' THEN '1. HARDWARE'
				WHEN DIMS.ITEM_CAT = 'PS01' THEN '2. 3rd PARTY SOFTWARE'
				WHEN DIMS.ITEM_CAT = 'PS02' THEN '3. OWN SOFTWARE'
				WHEN DIMS.ITEM_CAT = 'PS03' THEN '4. TECHNOLOGY SERVICE'
				WHEN DIMS.ITEM_CAT = 'PS04' THEN '5. HARDWARE SERVICE'
				WHEN DIMS.ITEM_CAT = 'PS05' THEN '6. MANAGE SERVICE'
		END AS GRUP_TITLE
		, 0 AS AMOUNT_SALES_AJ
		, 0 AS AMOUNT_SALES_SP
		, SUM(GLE.[Amount]) AS AMOUNT_COGS_AJ
		, 0 AS AMOUNT_COGS_SP
FROM [AUTOJAYA].[dbo].[AJ-ADJ$G_L Entry] GLE
LEFT JOIN	(
				SELECT	DIM.DIM_ID
						,MAX(DIM.BRANCHES) AS BRANCHES
						,MAX(DIM.ITEM_CAT) AS ITEM_CAT
						,MAX(DIM.SALESMAN) AS SALESMAN
				FROM	(
							SELECT [Dimension Set ID] AS DIM_ID
								  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
								  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
								  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
							FROM [AUTOJAYA].[dbo].[AJ-ADJ$Dimension Set Entry]
						) DIM
				GROUP BY DIM.DIM_ID
			) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
WHERE	GLE.[G_L Account No_] BETWEEN '500.110.00'  AND '500.111.00' AND
		DIMS.ITEM_CAT <> '' AND
		(DIMS.BRANCHES = $P{Cabang} OR $P{Cabang} = 'ALL') AND
		(GLE.[Posting Date] >= $P{PeriodeFrom} AND GLE.[Posting Date] <= $P{PeriodeUpto})
GROUP BY DIMS.ITEM_CAT
UNION ALL
SELECT	SLC.GRUP_TITLE
		, 0 AS AMOUNT_SALES_AJ
		, 0 AS AMOUNT_SALES_SP
		, CASE WHEN  SLC.SALES_TITLE = '1. COGS FA' THEN SUM(SLC.[Amount]) ELSE 0 END  AS AMOUNT_COGS_AJ
		, CASE WHEN  SLC.SALES_TITLE = '1. COGS FA' THEN 0 ELSE SUM(SLC.[Amount]) END AS AMOUNT_COGS_SP
FROM	(
			SELECT	CASE	WHEN DIMS.ITEM_CAT = 'HW01' THEN '1. HARDWARE'
							WHEN DIMS.ITEM_CAT = 'PS01' THEN '2. 3rd PARTY SOFTWARE'
							WHEN DIMS.ITEM_CAT = 'PS02' THEN '3. OWN SOFTWARE'
							WHEN DIMS.ITEM_CAT = 'PS03' THEN '4. TECHNOLOGY SERVICE'
							WHEN DIMS.ITEM_CAT = 'PS04' THEN '5. HARDWARE SERVICE'
							WHEN DIMS.ITEM_CAT = 'PS05' THEN '6. MANAGE SERVICE'
					END AS GRUP_TITLE
					,CASE WHEN GLE.[Source No_] = 'SOPE001' THEN '2. COGS INTERCOY' ELSE '1. COGS FA' END AS SALES_TITLE
					,CASE WHEN GLE.[Source No_] = 'SOPE001' THEN '(-) COGS INTERCOY' ELSE '(-) COGS FA' END AS SALES_TITLE2
					,CASE WHEN GLE.[Source No_] = 'SOPE001' THEN 'SLS-0402' ELSE 'SLS-0401' END AS SORT_SLS
					, GLE.[Amount]
			FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
			LEFT JOIN	(
							SELECT	DIM.DIM_ID
									,MAX(DIM.BRANCHES) AS BRANCHES
									,MAX(DIM.ITEM_CAT) AS ITEM_CAT
									,MAX(DIM.SALESMAN) AS SALESMAN
							FROM	(
										SELECT [Dimension Set ID] AS DIM_ID
											  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
											  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
											  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
										FROM [AUTOJAYA].[dbo].[AUTOJAYA$Dimension Set Entry]
									) DIM
							GROUP BY DIM.DIM_ID
						) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
			WHERE GLE.[G_L Account No_] IN ('400.110.01', '410.110.01', '420.110.01')
					AND (GLE.[Posting Date] >= $P{PeriodeFrom} AND GLE.[Posting Date] <=  $P{PeriodeUpto})
			UNION ALL
			SELECT	CASE	WHEN DIMS.ITEM_CAT = 'HW01' THEN '1. HARDWARE'
							WHEN DIMS.ITEM_CAT = 'PS01' THEN '2. 3rd PARTY SOFTWARE'
							WHEN DIMS.ITEM_CAT = 'PS02' THEN '3. OWN SOFTWARE'
							WHEN DIMS.ITEM_CAT = 'PS03' THEN '4. TECHNOLOGY SERVICE'
							WHEN DIMS.ITEM_CAT = 'PS04' THEN '5. HARDWARE SERVICE'
							WHEN DIMS.ITEM_CAT = 'PS05' THEN '6. MANAGE SERVICE'
					END AS GRUP_TITLE
					,CASE WHEN GLE.[Description] LIKE 'FA%' THEN '1. COGS FA' ELSE '2. COGS INTERCOY' END AS SALES_TITLE
					,'(-/+) Others Management Adjustment' AS SALES_TITLE2
					,'SLS-0403' AS SORT_SLS
					, GLE.[Amount]
			FROM [AUTOJAYA].[dbo].[AJ-ADJ$G_L Entry] GLE
			LEFT JOIN	(
							SELECT	DIM.DIM_ID
									,MAX(DIM.BRANCHES) AS BRANCHES
									,MAX(DIM.ITEM_CAT) AS ITEM_CAT
									,MAX(DIM.SALESMAN) AS SALESMAN
							FROM	(
										SELECT [Dimension Set ID] AS DIM_ID
											  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
											  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
											  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
										FROM [AUTOJAYA].[dbo].[AJ-ADJ$Dimension Set Entry]
									) DIM
							GROUP BY DIM.DIM_ID
						) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
			WHERE GLE.[G_L Account No_] IN ('400.110.01', '410.110.01', '420.110.01')
					AND (GLE.[Posting Date] >= $P{PeriodeFrom} AND GLE.[Posting Date] <=  $P{PeriodeUpto})
		) SLC
WHERE $P{Cabang} = 'ALL' OR $P{Cabang} = '10'
GROUP BY SLC.GRUP_TITLE, SLC.SALES_TITLE, SLC.SALES_TITLE2, SLC.SORT_SLS
UNION ALL
SELECT	CASE	WHEN DIMS.ITEM_CAT = 'HW01' THEN '1. HARDWARE'
				WHEN DIMS.ITEM_CAT = 'PS01' THEN '2. 3rd PARTY SOFTWARE'
				WHEN DIMS.ITEM_CAT = 'PS02' THEN '3. OWN SOFTWARE'
				WHEN DIMS.ITEM_CAT = 'PS03' THEN '4. TECHNOLOGY SERVICE'
				WHEN DIMS.ITEM_CAT = 'PS04' THEN '5. HARDWARE SERVICE'
				WHEN DIMS.ITEM_CAT = 'PS05' THEN '6. MANAGE SERVICE'
		END AS GRUP_TITLE
		, 0 AS AMOUNT_SALES_AJ
		, 0 AS AMOUNT_SALES_SP
		, 0 AS AMOUNT_COGS_AJ
		, SUM(GLE.[Amount]) AS AMOUNT_COGS_SP
FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
LEFT JOIN	(
				SELECT	DIM.DIM_ID
						,MAX(DIM.BRANCHES) AS BRANCHES
						,MAX(DIM.ITEM_CAT) AS ITEM_CAT
						,MAX(DIM.SALESMAN) AS SALESMAN
				FROM	(
							SELECT [Dimension Set ID] AS DIM_ID
								  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
								  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
								  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
							FROM [AUTOJAYA].[dbo].[SOLUSI$Dimension Set Entry]
						) DIM
				GROUP BY DIM.DIM_ID
			) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
WHERE	GLE.[G_L Account No_] BETWEEN '500.110.00'  AND '500.111.00' AND
		DIMS.ITEM_CAT <> '' AND
		(DIMS.BRANCHES = $P{Cabang} OR $P{Cabang} = 'ALL') AND
		(GLE.[Posting Date] >= $P{PeriodeFrom} AND GLE.[Posting Date] <= $P{PeriodeUpto})
GROUP BY DIMS.ITEM_CAT
UNION ALL
SELECT	CASE	WHEN DII.CATEGORY = 'HW01' THEN '1. HARDWARE'
				WHEN DII.CATEGORY = 'PS01' THEN '2. 3rd PARTY SOFTWARE'
				WHEN DII.CATEGORY = 'PS02' THEN '3. OWN SOFTWARE'
				WHEN DII.CATEGORY = 'PS03' THEN '4. TECHNOLOGY SERVICE'
				WHEN DII.CATEGORY = 'PS04' THEN '5. HARDWARE SERVICE'
				WHEN DII.CATEGORY = 'PS05' THEN '6. MANAGE SERVICE'
		END AS GRUP_TITLE
		, 0 AS AMOUNT_SALES_AJ
		, 0 AS AMOUNT_SALES_SP
		, 0 AS AMOUNT_COGS_AJ
		, SUM(DII.AMOUNT) * -1 AS AMOUNT_COGS_SP
FROM
(
SELECT	DOO.TGL_SJ
		,DOO.NO_SJ
		,DOO.CABANG
		,DOO.CATEGORY
		,DOO.AMOUNT
		,CASE WHEN DOI.NO_INVOICE IS NULL AND
			(
				SELECT CASE WHEN SUM(SHL.[Quantity]) = SUM(SHL.[Quantity Invoiced]) THEN 'Y' ELSE 'N' END AS INV
				FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Shipment Line] SHL
				WHERE SHL.[Document No_] = DOO.NO_SJ
				GROUP BY SHL.[Document No_]
			) = 'Y' THEN
			(
				SELECT (IOO.NO_INV)
				FROM	(
							SELECT
									DISTINCT SIH.[No_] AS NO_INV,
									SIH.[Posting Date] AS TGL_INV,
									CASE WHEN SIL.[Shipment No_] <> '' THEN SIL.[Shipment No_] ELSE DOA.[No_] END AS NO_DO
							FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] SIH
							INNER JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Line] SIL ON SIL.[Document No_] = SIH.[No_]
							LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Shipment Header] DOA ON DOA.[Order No_] = SIH.[Order No_]
							WHERE SIL.[Type] = 2
						)IOO
				WHERE IOO.NO_DO  = DOO.NO_SJ AND
					  IOO.TGL_INV < DOO.TGL_SJ
			) ELSE DOI.NO_INVOICE END AS NO_INVOICE
		,DOI.TGL_INV
FROM
(
	SELECT GLE.[Posting Date] AS TGL_SJ
		  ,GLE.[Document No_] AS NO_SJ
		  ,GLE.[Global Dimension 1 Code] AS CABANG
		  ,GLE.[Global Dimension 2 Code] AS CATEGORY
		  ,SUM(GLE.[Amount]) AS AMOUNT
	FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
	INNER JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Shipment Header] DOA ON DOA.[No_] = GLE.[Document No_]
	WHERE GLE.[G_L Account No_]= '500.110.00'
			AND DOA.[Bill-to Customer No_] NOT IN ('SOPE001', 'AUJA001', 'AUJA002')
	GROUP BY GLE.[Posting Date], GLE.[Document No_]
			,GLE.[Global Dimension 1 Code] ,GLE.[Global Dimension 2 Code]
) DOO
LEFT JOIN	(
				SELECT XXX.NO_SJ
						,XXX.TGL_INV
						,(
							SELECT MAX(ISJ.[No_]) AS NO_INVOICE
							FROM (
									SELECT
											SIH.[No_],
											SIH.[Posting Date],
											CASE WHEN SIL.[Shipment No_] <> '' THEN SIL.[Shipment No_] ELSE DOA.[No_] END AS NO_DO
									FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] SIH
									INNER JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Line] SIL ON SIL.[Document No_] = SIH.[No_]
									LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Shipment Header] DOA ON DOA.[Order No_] = SIH.[Order No_]
									WHERE SIL.[Type] = 2
								) ISJ
							WHERE ISJ.NO_DO = XXX.NO_SJ AND ISJ.[Posting Date] = XXX.TGL_INV
						) AS NO_INVOICE
				FROM
				(
				SELECT  DO.[No_] AS NO_SJ
						,
						(
								SELECT MIN(ISJ2.[Posting Date])
								FROM	(
										SELECT	SIH2.[Posting Date],
												CASE WHEN SIL2.[Shipment No_] <> '' THEN SIL2.[Shipment No_] ELSE DOA2.[No_] END AS NO_DO
										FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] SIH2
										INNER JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Line] SIL2 ON SIL2.[Document No_] = SIH2.[No_]
										LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Shipment Header] DOA2 ON DOA2.[Order No_] = SIH2.[Order No_]
										WHERE SIL2.[Type] = 2
										) ISJ2
								WHERE ISJ2.NO_DO  = DO.[No_]
									   AND CONVERT(VARCHAR(6), ISJ2.[Posting Date], 112) >= CONVERT(VARCHAR(6), DO.[Posting Date], 112)
						) AS TGL_INV
				FROM[AUTOJAYA].[dbo].[SOLUSI$Sales Shipment Header] DO
				) XXX
			) DOI ON DOI.NO_SJ = DOO.NO_SJ
LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Cr_Memo Header] CRM ON CRM.[Applies-to Doc_ No_] = DOI.NO_INVOICE
WHERE DOO.AMOUNT <> 0
		AND CRM.[No_] IS NULL
) DII
LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] SIH3 ON SIH3.[No_] = DII.NO_INVOICE
LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Cr_Memo Header] CRM2 ON CRM2.[Applies-to Doc_ No_] = DII.NO_INVOICE
WHERE	CRM2.[No_] IS NULL
		AND (	DII.NO_INVOICE IS NULL
				OR
				SIH3.[Posting Date] > $P{PeriodeUpto}
			)
		AND (DII.TGL_SJ >= $P{PeriodeFrom}  AND DII.TGL_SJ <= $P{PeriodeUpto})
		AND (DII.CABANG = $P{Cabang} OR $P{Cabang} = 'ALL')
GROUP BY DII.CATEGORY
UNION ALL
SELECT	CASE	WHEN DII.CATEGORY = 'HW01' THEN '1. HARDWARE'
				WHEN DII.CATEGORY = 'PS01' THEN '2. 3rd PARTY SOFTWARE'
				WHEN DII.CATEGORY = 'PS02' THEN '3. OWN SOFTWARE'
				WHEN DII.CATEGORY = 'PS03' THEN '4. TECHNOLOGY SERVICE'
				WHEN DII.CATEGORY = 'PS04' THEN '5. HARDWARE SERVICE'
				WHEN DII.CATEGORY = 'PS05' THEN '6. MANAGE SERVICE'
		END AS GRUP_TITLE
		, 0 AS AMOUNT_SALES_AJ
		, 0 AS AMOUNT_SALES_SP
		, 0 AS AMOUNT_COGS_AJ
		, SUM(DII.AMOUNT) AS AMOUNT_COGS_SP
FROM
(
SELECT	DOO.TGL_SJ
		,DOO.NO_SJ
		,DOO.CABANG
		,DOO.CATEGORY
		,DOO.AMOUNT
		,CASE WHEN DOI.NO_INVOICE IS NULL AND
			(
				SELECT CASE WHEN SUM(SHL.[Quantity]) = SUM(SHL.[Quantity Invoiced]) THEN 'Y' ELSE 'N' END AS INV
				FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Shipment Line] SHL
				WHERE SHL.[Document No_] = DOO.NO_SJ
				GROUP BY SHL.[Document No_]
			) = 'Y' THEN
			(
				SELECT (IOO.NO_INV)
				FROM	(
							SELECT
									DISTINCT SIH.[No_] AS NO_INV,
									SIH.[Posting Date] AS TGL_INV,
									CASE WHEN SIL.[Shipment No_] <> '' THEN SIL.[Shipment No_] ELSE DOA.[No_] END AS NO_DO
							FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] SIH
							INNER JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Line] SIL ON SIL.[Document No_] = SIH.[No_]
							LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Shipment Header] DOA ON DOA.[Order No_] = SIH.[Order No_]
							WHERE SIL.[Type] = 2
						)IOO
				WHERE IOO.NO_DO  = DOO.NO_SJ AND
					  IOO.TGL_INV < DOO.TGL_SJ
			) ELSE DOI.NO_INVOICE END AS NO_INVOICE
		,DOI.TGL_INV
FROM
(
	SELECT GLE.[Posting Date] AS TGL_SJ
		  ,GLE.[Document No_] AS NO_SJ
		  ,GLE.[Global Dimension 1 Code] AS CABANG
		  ,GLE.[Global Dimension 2 Code] AS CATEGORY
		  ,SUM(GLE.[Amount]) AS AMOUNT
	FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
	INNER JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Shipment Header] DOA ON DOA.[No_] = GLE.[Document No_]
	WHERE GLE.[G_L Account No_]= '500.110.00'
			AND DOA.[Bill-to Customer No_] NOT IN ('SOPE001', 'AUJA001', 'AUJA002')
	GROUP BY GLE.[Posting Date], GLE.[Document No_]
			,GLE.[Global Dimension 1 Code] ,GLE.[Global Dimension 2 Code]
) DOO
LEFT JOIN	(
				SELECT XXX.NO_SJ
						,XXX.TGL_INV
						,(
							SELECT MAX(ISJ.[No_]) AS NO_INVOICE
							FROM (
									SELECT
											SIH.[No_],
											SIH.[Posting Date],
											CASE WHEN SIL.[Shipment No_] <> '' THEN SIL.[Shipment No_] ELSE DOA.[No_] END AS NO_DO
									FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] SIH
									INNER JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Line] SIL ON SIL.[Document No_] = SIH.[No_]
									LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Shipment Header] DOA ON DOA.[Order No_] = SIH.[Order No_]
									WHERE SIL.[Type] = 2
								) ISJ
							WHERE ISJ.NO_DO = XXX.NO_SJ AND ISJ.[Posting Date] = XXX.TGL_INV
						) AS NO_INVOICE
				FROM
				(
				SELECT  DO.[No_] AS NO_SJ
						,
						(
								SELECT MIN(ISJ2.[Posting Date])
								FROM	(
										SELECT	SIH2.[Posting Date],
												CASE WHEN SIL2.[Shipment No_] <> '' THEN SIL2.[Shipment No_] ELSE DOA2.[No_] END AS NO_DO
										FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] SIH2
										INNER JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Line] SIL2 ON SIL2.[Document No_] = SIH2.[No_]
										LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Shipment Header] DOA2 ON DOA2.[Order No_] = SIH2.[Order No_]
										WHERE SIL2.[Type] = 2
										) ISJ2
								WHERE ISJ2.NO_DO  = DO.[No_]
									   AND CONVERT(VARCHAR(6), ISJ2.[Posting Date], 112) >= CONVERT(VARCHAR(6), DO.[Posting Date], 112)
						) AS TGL_INV
				FROM[AUTOJAYA].[dbo].[SOLUSI$Sales Shipment Header] DO
				) XXX
			) DOI ON DOI.NO_SJ = DOO.NO_SJ
LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Cr_Memo Header] CRM ON CRM.[Applies-to Doc_ No_] = DOI.NO_INVOICE
WHERE DOO.AMOUNT <> 0
		AND CRM.[No_] IS NULL
) DII
LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] SIH3 ON SIH3.[No_] = DII.NO_INVOICE
LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Cr_Memo Header] CRM2 ON CRM2.[Applies-to Doc_ No_] = DII.NO_INVOICE
WHERE	CRM2.[No_] IS NULL
		AND (SIH3.[Posting Date] >= $P{PeriodeFrom}  AND SIH3.[Posting Date] <= $P{PeriodeUpto} )
		AND (DII.TGL_SJ < $P{PeriodeFrom})
		AND (DII.CABANG = $P{Cabang} OR $P{Cabang} = 'ALL')
GROUP BY DII.CATEGORY
UNION ALL
SELECT	'1. HARDWARE' AS GRUP_TITLE
		, 0 AS AMOUNT_SALES_AJ
		, 0 AS AMOUNT_SALES_SP
		, 0 AS AMOUNT_COGS_AJ
		, ISNULL(SUM(GLE.[Amount]),0) AS AMOUNT_COGS_SP
FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
WHERE	GLE.[G_L Account No_] IN ( '600.110.00', '600.120.00')
		AND (GLE.[Global Dimension 1 Code] = $P{Cabang} OR $P{Cabang} = 'ALL')
		AND (GLE.[Posting Date] >= $P{PeriodeFrom} AND GLE.[Posting Date] <= $P{PeriodeUpto})
UNION ALL
SELECT	'1. HARDWARE' AS GRUP_TITLE
		, 0 AS AMOUNT_SALES_AJ
		, 0 AS AMOUNT_SALES_SP
		, 0 AS AMOUNT_COGS_AJ
		, ISNULL(SUM(GLE.[Amount]),0) AS AMOUNT_COGS_SP
FROM [AUTOJAYA].[dbo].[SP-ADJ$G_L Entry] GLE
WHERE	GLE.[G_L Account No_] IN ( '600.110.00', '600.120.00')
		AND (GLE.[Global Dimension 1 Code] = $P{Cabang} OR $P{Cabang} = 'ALL')
		AND (GLE.[Posting Date] >= $P{PeriodeFrom} AND GLE.[Posting Date] <= $P{PeriodeUpto})
UNION ALL
SELECT	CASE	WHEN DIMS.ITEM_CAT = 'HW01' THEN '1. HARDWARE'
				WHEN DIMS.ITEM_CAT = 'PS01' THEN '2. 3rd PARTY SOFTWARE'
				WHEN DIMS.ITEM_CAT = 'PS02' THEN '3. OWN SOFTWARE'
				WHEN DIMS.ITEM_CAT = 'PS03' THEN '4. TECHNOLOGY SERVICE'
				WHEN DIMS.ITEM_CAT = 'PS04' THEN '5. HARDWARE SERVICE'
				WHEN DIMS.ITEM_CAT = 'PS05' THEN '6. MANAGE SERVICE'
		END AS GRUP_TITLE
		, 0 AS AMOUNT_SALES_AJ
		, 0 AS AMOUNT_SALES_SP
		, 0 AS AMOUNT_COGS_AJ
		, SUM(GLE.[Amount]) AS AMOUNT_COGS_SP
FROM [AUTOJAYA].[dbo].[SP-ADJ$G_L Entry] GLE
LEFT JOIN	(
				SELECT	DIM.DIM_ID
						,MAX(DIM.BRANCHES) AS BRANCHES
						,MAX(DIM.ITEM_CAT) AS ITEM_CAT
						,MAX(DIM.SALESMAN) AS SALESMAN
				FROM	(
							SELECT [Dimension Set ID] AS DIM_ID
								  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
								  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
								  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
							FROM [AUTOJAYA].[dbo].[SP-ADJ$Dimension Set Entry]
						) DIM
				GROUP BY DIM.DIM_ID
			) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
WHERE	GLE.[G_L Account No_] BETWEEN '500.110.00'  AND '500.111.00' AND
		DIMS.ITEM_CAT <> '' AND
		(DIMS.BRANCHES = $P{Cabang} OR $P{Cabang} = 'ALL') AND
		(GLE.[Posting Date] >= $P{PeriodeFrom} AND GLE.[Posting Date] <= $P{PeriodeUpto})
GROUP BY DIMS.ITEM_CAT
UNION ALL
SELECT	SLC.GRUP_TITLE
		, 0 AS AMOUNT_SALES_AJ
		, 0 AS AMOUNT_SALES_SP
		, CASE WHEN  SLC.SALES_TITLE = '1. COGS FA' THEN 0 ELSE SUM(SLC.[Amount]) END AS AMOUNT_COGS_AJ
		, CASE WHEN  SLC.SALES_TITLE = '1. COGS FA' THEN SUM(SLC.[Amount]) ELSE 0 END AS AMOUNT_COGS_SP
FROM	(
			SELECT	CASE	WHEN DIMS.ITEM_CAT = 'HW01' THEN '1. HARDWARE'
							WHEN DIMS.ITEM_CAT = 'PS01' THEN '2. 3rd PARTY SOFTWARE'
							WHEN DIMS.ITEM_CAT = 'PS02' THEN '3. OWN SOFTWARE'
							WHEN DIMS.ITEM_CAT = 'PS03' THEN '4. TECHNOLOGY SERVICE'
							WHEN DIMS.ITEM_CAT = 'PS04' THEN '5. HARDWARE SERVICE'
							WHEN DIMS.ITEM_CAT = 'PS05' THEN '6. MANAGE SERVICE'
					END AS GRUP_TITLE
					,CASE WHEN GLE.[Source No_] <> 'SOPE001' THEN '2. COGS INTERCOY' ELSE '1. COGS FA' END AS SALES_TITLE
					,CASE WHEN GLE.[Source No_] <> 'SOPE001' THEN '(-) COGS INTERCOY' ELSE '(-) COGS FA' END AS SALES_TITLE2
					,CASE WHEN GLE.[Source No_] <> 'SOPE001' THEN 'SLS-0402' ELSE 'SLS-0401' END AS SORT_SLS
					, GLE.[Amount]
			FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
			LEFT JOIN	(
							SELECT	DIM.DIM_ID
									,MAX(DIM.BRANCHES) AS BRANCHES
									,MAX(DIM.ITEM_CAT) AS ITEM_CAT
									,MAX(DIM.SALESMAN) AS SALESMAN
							FROM	(
										SELECT [Dimension Set ID] AS DIM_ID
											  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
											  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
											  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
										FROM [AUTOJAYA].[dbo].[SOLUSI$Dimension Set Entry]
									) DIM
							GROUP BY DIM.DIM_ID
						) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
			WHERE GLE.[G_L Account No_] IN ('400.110.01', '410.110.01', '420.110.01')
					AND (GLE.[Posting Date] >= $P{PeriodeFrom} AND GLE.[Posting Date] <=  $P{PeriodeUpto})
			UNION ALL
			SELECT	CASE	WHEN DIMS.ITEM_CAT = 'HW01' THEN '1. HARDWARE'
							WHEN DIMS.ITEM_CAT = 'PS01' THEN '2. 3rd PARTY SOFTWARE'
							WHEN DIMS.ITEM_CAT = 'PS02' THEN '3. OWN SOFTWARE'
							WHEN DIMS.ITEM_CAT = 'PS03' THEN '4. TECHNOLOGY SERVICE'
							WHEN DIMS.ITEM_CAT = 'PS04' THEN '5. HARDWARE SERVICE'
							WHEN DIMS.ITEM_CAT = 'PS05' THEN '6. MANAGE SERVICE'
					END AS GRUP_TITLE
					,CASE WHEN GLE.[Description] LIKE 'FA%' THEN '1. COGS FA' ELSE '2. COGS INTERCOY' END AS SALES_TITLE
					,'(-/+) Others Management Adjustment' AS SALES_TITLE2
					,'SLS-0403' AS SORT_SLS
					, GLE.[Amount]
			FROM [AUTOJAYA].[dbo].[SP-ADJ$G_L Entry] GLE
			LEFT JOIN	(
							SELECT	DIM.DIM_ID
									,MAX(DIM.BRANCHES) AS BRANCHES
									,MAX(DIM.ITEM_CAT) AS ITEM_CAT
									,MAX(DIM.SALESMAN) AS SALESMAN
							FROM	(
										SELECT [Dimension Set ID] AS DIM_ID
											  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
											  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
											  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
										FROM [AUTOJAYA].[dbo].[SP-ADJ$Dimension Set Entry]
									) DIM
							GROUP BY DIM.DIM_ID
						) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
			WHERE GLE.[G_L Account No_] IN ('400.110.01', '410.110.01', '420.110.01')
					AND (GLE.[Posting Date] >= $P{PeriodeFrom} AND GLE.[Posting Date] <=  $P{PeriodeUpto})
		) SLC
WHERE $P{Cabang} = 'ALL' OR $P{Cabang} = '10'
GROUP BY SLC.GRUP_TITLE, SLC.SALES_TITLE, SLC.SALES_TITLE2, SLC.SORT_SLS
) X
GROUP BY X.GRUP_TITLE
) XX
) XXX]]>
	</queryString>
	<field name="GRUP_TITLE" class="java.lang.String"/>
	<field name="AMOUNT_SALES" class="java.math.BigDecimal"/>
	<field name="PCN_TTL_SALES" class="java.math.BigDecimal"/>
	<field name="AMOUNT_COGS" class="java.math.BigDecimal"/>
	<field name="PCN_TTL_COGS" class="java.math.BigDecimal"/>
	<field name="MARGIN" class="java.math.BigDecimal"/>
	<field name="PCN_MARGIN" class="java.math.BigDecimal"/>
	<field name="PCN_MARGIN_TTL" class="java.math.BigDecimal"/>
	<sortField name="GRUP_TITLE"/>
	<variable name="AMOUNT_SALES_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{AMOUNT_SALES}]]></variableExpression>
	</variable>
	<variable name="PCN_TTL_SALES_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{PCN_TTL_SALES}]]></variableExpression>
	</variable>
	<variable name="AMOUNT_COGS_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{AMOUNT_COGS}]]></variableExpression>
	</variable>
	<variable name="MARGIN_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{MARGIN}]]></variableExpression>
	</variable>
	<variable name="PCN_TTL_COGS_1" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{PCN_TTL_COGS}]]></variableExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="102" splitType="Stretch">
			<textField pattern="dd-MM-yyyy HH:mm:ss">
				<reportElement x="222" y="60" width="144" height="14" uuid="354c48b6-c745-4179-8c35-437bfbe26bc6"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="8" y="60" width="214" height="14" uuid="2416e567-b590-46cd-b14e-f9281133ba81"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Dicetak Pada :]]></text>
			</staticText>
			<staticText>
				<reportElement x="8" y="4" width="214" height="14" uuid="b3e39015-60b7-4554-84b0-56f951c68c37"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[COGS Analysis]]></text>
			</staticText>
			<staticText>
				<reportElement x="8" y="18" width="214" height="14" uuid="4eb2c989-0b8b-464e-9e93-b047e47ba9df"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Periode :]]></text>
			</staticText>
			<staticText>
				<reportElement x="8" y="88" width="214" height="14" uuid="f47a3c22-aad1-4ef8-8762-fa524640460e"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[PRODUCT]]></text>
			</staticText>
			<staticText>
				<reportElement x="8" y="74" width="214" height="14" uuid="c2958fed-a0e5-405b-876d-a86598f384bc"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<textField pattern="MM-yyyy">
				<reportElement x="222" y="18" width="144" height="14" uuid="e2c01df6-3d02-4a09-835c-4f47a195324f"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{PeriodeUpto}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="222" y="88" width="107" height="14" uuid="70b1d2e9-c2af-42a4-be49-aca0f41c2cc3"/>
				<textElement textAlignment="Right">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[NETT SALES (Rp)]]></text>
			</staticText>
			<staticText>
				<reportElement x="329" y="88" width="68" height="14" uuid="1d57e90c-e048-4f3e-9a17-ea771c5f90a6"/>
				<textElement textAlignment="Right">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[% TTL SALES]]></text>
			</staticText>
			<staticText>
				<reportElement x="8" y="32" width="214" height="14" uuid="c9a88818-b3ec-4c9a-b030-c8c0872d44d0"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Cabang :]]></text>
			</staticText>
			<textField>
				<reportElement x="222" y="32" width="144" height="14" uuid="793eeb2e-2ae8-45d8-847c-4b3790d8ab85"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{Cabang}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="397" y="88" width="107" height="14" uuid="262a8c13-7388-425a-a2d1-10c1b42979cb"/>
				<textElement textAlignment="Right">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[NETT COGS (Rp)]]></text>
			</staticText>
			<staticText>
				<reportElement x="504" y="88" width="68" height="14" uuid="47f7ecec-22e0-4d2f-b6d6-d2cd4c9bbecf"/>
				<textElement textAlignment="Right">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[% TTL COGS]]></text>
			</staticText>
			<staticText>
				<reportElement x="572" y="88" width="107" height="14" uuid="de5098f1-77b0-44c9-8ccb-6846624eea7f"/>
				<textElement textAlignment="Right">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[GROSS MARGIN (Rp)]]></text>
			</staticText>
			<staticText>
				<reportElement x="679" y="88" width="68" height="14" uuid="ca984132-6d0f-46ee-beff-2d2d1543ff0a"/>
				<textElement textAlignment="Right">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[GM %]]></text>
			</staticText>
			<staticText>
				<reportElement x="8" y="46" width="214" height="14" uuid="632771e1-0b93-4533-acf6-3b301e7923bc"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Show Amount in :]]></text>
			</staticText>
			<textField pattern="#,###" isBlankWhenNull="true">
				<reportElement x="222" y="46" width="144" height="14" uuid="86a0c37e-b63c-4353-9b97-14dd9ce69dd9"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{Pembagi}]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<detail>
		<band height="14" splitType="Stretch">
			<textField>
				<reportElement x="8" y="0" width="214" height="14" uuid="39857d09-21d4-4a58-9fa1-43b9545acf38"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{GRUP_TITLE}]]></textFieldExpression>
			</textField>
			<textField pattern="#,###" isBlankWhenNull="true">
				<reportElement x="222" y="0" width="107" height="14" uuid="b073ec6f-2645-4b0d-9e51-02c1c4cf9474"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{AMOUNT_SALES}]]></textFieldExpression>
			</textField>
			<textField pattern="#,###" isBlankWhenNull="true">
				<reportElement x="397" y="0" width="107" height="14" uuid="73c0209a-8b92-45bc-bc9d-4b5cfe299ef4"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{AMOUNT_COGS}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement x="329" y="0" width="68" height="14" uuid="d48035a5-677d-41bd-bd79-aef411ba679a"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{PCN_TTL_SALES}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement x="504" y="0" width="68" height="14" uuid="dd6d3d6b-1121-4243-bf54-f64c9356bfa4"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{PCN_TTL_COGS}]]></textFieldExpression>
			</textField>
			<textField pattern="#,###" isBlankWhenNull="true">
				<reportElement x="572" y="0" width="107" height="14" uuid="6237c468-7869-418e-a90b-332b0844f3f3"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{MARGIN}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement x="679" y="0" width="68" height="14" uuid="5c933dfe-a2c9-455b-b56a-5475cef2a529"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{PCN_MARGIN}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<summary>
		<band height="35" splitType="Stretch">
			<staticText>
				<reportElement x="8" y="0" width="214" height="14" uuid="ebf5135b-5b97-4a76-9d4e-f221054ae158"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[TOTAL]]></text>
			</staticText>
			<textField pattern="#,###" isBlankWhenNull="true">
				<reportElement x="222" y="0" width="107" height="14" uuid="0cf16de8-5ff0-407c-a5b7-3b275076928b"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{AMOUNT_SALES_1}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement x="329" y="0" width="68" height="14" uuid="31aaed8a-e115-4582-a476-c65f9a97322c"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{PCN_TTL_SALES_1}]]></textFieldExpression>
			</textField>
			<textField pattern="#,###" isBlankWhenNull="true">
				<reportElement x="397" y="0" width="107" height="14" uuid="8edaf115-1a08-4371-a3c2-e9011e9413c0"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{AMOUNT_COGS_1}]]></textFieldExpression>
			</textField>
			<textField pattern="#,###" isBlankWhenNull="true">
				<reportElement x="572" y="0" width="107" height="14" uuid="f720aa73-cfa7-4cdd-830a-18a615774e8a"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{MARGIN_1}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement x="504" y="0" width="68" height="14" uuid="8d5c757c-5e3a-4cdd-994e-3ef26ec19d3e"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{PCN_TTL_COGS_1}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement x="679" y="0" width="68" height="14" uuid="25f008c8-f6f0-4cdc-9a3c-3db75d4ad45d"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{PCN_MARGIN_TTL}]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
