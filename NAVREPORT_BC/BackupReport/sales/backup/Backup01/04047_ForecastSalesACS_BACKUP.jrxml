<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="04047_ForecastSalesACS" language="groovy" pageWidth="693" pageHeight="595" orientation="Landscape" whenNoDataType="NoDataSection" columnWidth="653" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="b406b291-7ccc-4e85-8d33-6ed4d9da73cd">
	<property name="ireport.zoom" value="1.3310000000001365"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="Tahun" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="AmtBig" class="java.math.BigDecimal">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="SpvBy" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT	1 AS MAIN_GRP
		,1 AS GROUP_NO
		,('SALES REVENUE ') AS GROUP_DESC
		,1 AS SUBGROUP_NO
		,'Sales Revenue' AS SUBGROUP_DESC
		,(ROUND((SUM(XX.AMOUNT_S1)/1000000),2) + ROUND((SUM(XX.AMOUNT_S2)/1000000),2)) AS AMOUNT
		,ROUND((SUM(XX.AMOUNT_S1)/1000000),2) AS AMOUNT_S1
		,ROUND((SUM(XX.AMOUNT_S2)/1000000),2) AS AMOUNT_S2
		,'' AS SALES_CODE
		,'' AS BRANCHES
		,'' AS SPV_BY
FROM	(
			SELECT	X.BRANCHES
					,X.SALESMAN
					,X.AMOUNT_S1
					,X.AMOUNT_S2
			FROM	(
						SELECT	'SALES ALL' AS NOTE
								,GLL.BRANCHES
								,GLL.ITEM_CAT
								,GLL.SALESMAN
								,SUM(GLL.AMOUNT_S1) AS AMOUNT_S1
								,SUM(GLL.AMOUNT_S2) AS AMOUNT_S2
						FROM	(
									SELECT	DIMS.BRANCHES
											,DIMS.ITEM_CAT
											,CASE WHEN GLE.[Document No_] = 'PCJR1808/035' THEN 'NGM' ELSE DIMS.SALESMAN END AS SALESMAN
											, SUM((CASE WHEN DATEPART(quarter, GLE.[Posting Date]) IN (1,2) THEN GLE.[Amount] ELSE 0 END)) * -1 AS AMOUNT_S1
											, SUM((CASE WHEN DATEPART(quarter, GLE.[Posting Date]) IN (3,4) THEN GLE.[Amount] ELSE 0 END)) * -1 AS AMOUNT_S2
									FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
									LEFT JOIN	(
													SELECT	DIM.DIM_ID
															,MAX(DIM.BRANCHES) AS BRANCHES
															,MAX(DIM.ITEM_CAT) AS ITEM_CAT
															,MAX(DIM.SALESMAN) AS SALESMAN
													FROM	(
																SELECT [Dimension Set ID] AS DIM_ID
																	  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																	  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																	  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																FROM [AUTOJAYA].[dbo].[AUTOJAYA$Dimension Set Entry]
															) DIM
													GROUP BY DIM.DIM_ID
												) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
									WHERE	(GLE.[G_L Account No_] BETWEEN '400.110.00'  AND '420.110.01') AND
											GLE.[G_L Account No_] <> '400.110.04' AND
											DIMS.ITEM_CAT <> '' AND
											(GLE.[Posting Date] >= (CAST((CAST($P{Tahun} as varchar(4))+'-01-01') AS datetime)) AND GLE.[Posting Date] <=  (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime)))
									GROUP BY DIMS.BRANCHES, DIMS.ITEM_CAT, DIMS.SALESMAN, GLE.[Document No_]
								) GLL
						GROUP BY GLL.BRANCHES, GLL.ITEM_CAT, GLL.SALESMAN
						UNION ALL
						SELECT	'Sales - LAINNYA' AS NOTE
								,'10' BRANCHES
								,'HW01' AS ITEM_CAT
								,'OFC' AS SALESMAN
								,SUM(CASE WHEN DATEPART(quarter, GLE.[Posting Date]) IN (1,2) THEN GLE.[Amount] ELSE 0 END) * -1 AS AMOUNT_S1
								,SUM(CASE WHEN DATEPART(quarter, GLE.[Posting Date]) IN (3,4) THEN GLE.[Amount] ELSE 0 END) * -1 AS AMOUNT_S2
						FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
						LEFT JOIN	(
										SELECT	DIM.DIM_ID
												,MAX(DIM.BRANCHES) AS BRANCHES
												,MAX(DIM.ITEM_CAT) AS ITEM_CAT
												,MAX(DIM.SALESMAN) AS SALESMAN
										FROM	(
													SELECT [Dimension Set ID] AS DIM_ID
														  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
														  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
														  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
													FROM [AUTOJAYA].[dbo].[AUTOJAYA$Dimension Set Entry]
												) DIM
										GROUP BY DIM.DIM_ID
									) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
						WHERE	GLE.[G_L Account No_] = '400.110.04' AND
								(GLE.[Posting Date] >= (CAST((CAST($P{Tahun} as varchar(4))+'-01-01') AS datetime)) AND GLE.[Posting Date] <=  (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime)))
						UNION ALL
						SELECT	'(-) Accured Sales Current Year Semester 1' AS NOTE
								,ASCY.BRANCHES
								,ASCY.ITEM_CAT
								,ASCY.SALESMAN
								,SUM(ASCY.AMOUNT) * -1 AS AMOUNT_S1
								,0 AS AMOUNT_S2
						FROM	(
									SELECT	OUM.ITEM_CAT
											,OUM.BRANCHES
											,OUM.SALESMAN
											,OUM.AMOUNT
									FROM	(
												SELECT	UM.ITEM_CAT
														,UM.BRANCHES
														,UM.SALESMAN
														,UM.TGL_UM
														,	CASE WHEN ISNULL(INV.AMOUNT,0) = 0 THEN UM.AMOUNT ELSE
																CASE WHEN SUM(UM.AMOUNT)OVER(PARTITION BY UM.NO_SO, UM.BRANCHES, UM.ITEM_CAT, UM.SALESMAN  ORDER BY UM.TGL_UM) <= ISNULL(INV.AMOUNT,0) THEN 0 ELSE
																	SUM(UM.AMOUNT)OVER(PARTITION BY UM.NO_SO, UM.BRANCHES, UM.ITEM_CAT, UM.SALESMAN  ORDER BY UM.TGL_UM) - ISNULL(INV.AMOUNT,0)
																END
															END AS AMOUNT
												FROM	(
															SELECT	DIMS.ITEM_CAT
																	,DIMS.BRANCHES
																	,DIMS.SALESMAN
																	,SIH.[Posting Date] AS TGL_UM
																	,SIH.[No_] AS NO_UM
																	,SIH.[External Document No_] AS NO_PO_CUST
																	,SIH.[Bill-to Customer No_] AS CUST_NO
																	,SIH.[Bill-to Name] AS CUST_NAME
																	,SIH.[Prepayment Order No_] AS NO_SO
																	, (SUM(GLE.[Amount]) * -1) AS AMOUNT
															FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
															LEFT JOIN	(
																			SELECT	DIM.DIM_ID
																					,MAX(DIM.BRANCHES) AS BRANCHES
																					,MAX(DIM.ITEM_CAT) AS ITEM_CAT
																					,MAX(DIM.SALESMAN) AS SALESMAN
																			FROM	(
																						SELECT [Dimension Set ID] AS DIM_ID
																							  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																							  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																							  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																						FROM [AUTOJAYA].[dbo].[AUTOJAYA$Dimension Set Entry]
																					) DIM
																			GROUP BY DIM.DIM_ID
																		) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
															LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
															LEFT JOIN	(
																			SELECT CLE.[Entry No_]
																					, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE.[Document No_] ELSE CLE2.[Document No_] END AS NO_UM
																					, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE2.[Document No_] ELSE CLE.[Document No_] END AS NO_CM
																			FROM [AUTOJAYA].[dbo].[AUTOJAYA$Cust_ Ledger Entry] CLE
																			LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Cust_ Ledger Entry] CLE2 ON CLE2.[Entry No_] = CLE.[Closed by Entry No_]
																			WHERE CLE.[Document Type] IN (2,3)
																			AND ((CLE.[Document No_]  LIKE 'UM%' AND CLE2.[Document Type] = 3) OR
																				(CLE2.[Document No_]  LIKE 'UM%' AND CLE.[Document Type] = 3) )
																		) CM ON CM.NO_UM = GLE.[Document No_]
															LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Cr_Memo Header] CMH ON CMH.[No_] = CM.NO_CM
															WHERE GLE.[G_L Account No_] = '400.110.03'
																  AND GLE.[Document No_] LIKE 'UM%'
																  AND (CM.NO_CM IS NULL OR (CM.NO_CM IS NOT NULL AND CMH.[Posting Date] > (CAST((CAST($P{Tahun} as varchar(4))+'-06-30') AS datetime)) ))
																  AND (SIH.[Posting Date] >= (CAST((CAST($P{Tahun} as varchar(4))+'-01-01') AS datetime)) AND SIH.[Posting Date]<= (CAST((CAST($P{Tahun} as varchar(4))+'-06-30') AS datetime)))
															GROUP BY DIMS.ITEM_CAT
																	 ,DIMS.BRANCHES
																	 ,DIMS.SALESMAN
																	 ,SIH.[Posting Date]
																	 ,SIH.[No_]
																	 ,SIH.[External Document No_]
																	 ,SIH.[Bill-to Customer No_]
																	 ,SIH.[Bill-to Name]
																	 ,SIH.[Prepayment Order No_]
														) UM
												LEFT JOIN	(
																SELECT	DIMS.ITEM_CAT
																		,DIMS.BRANCHES
																		,DIMS.SALESMAN
																		,SIH.[Order No_] AS NO_SO
																		,MAX(SIH.[Posting Date]) AS TGL_INV
																		,SUM(GLE.[Amount]) AS AMOUNT
																FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
																LEFT JOIN	(
																				SELECT	DIM.DIM_ID
																						,MAX(DIM.BRANCHES) AS BRANCHES
																						,MAX(DIM.ITEM_CAT) AS ITEM_CAT
																						,MAX(DIM.SALESMAN) AS SALESMAN
																				FROM	(
																							SELECT [Dimension Set ID] AS DIM_ID
																								  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																								  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																								  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																							FROM [AUTOJAYA].[dbo].[AUTOJAYA$Dimension Set Entry]
																						) DIM
																				GROUP BY DIM.DIM_ID
																			) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
																LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
																WHERE GLE.[G_L Account No_] = '400.110.03'
																	  AND GLE.[Document No_] NOT LIKE 'UM%'
																	  AND GLE.[Posting Date] <=  (CAST((CAST($P{Tahun} as varchar(4))+'-06-30') AS datetime))
																GROUP BY DIMS.ITEM_CAT
																		,DIMS.BRANCHES
																		,DIMS.SALESMAN
																		,SIH.[Order No_]
															) INV ON INV.NO_SO = UM.NO_SO AND INV.BRANCHES = UM.BRANCHES AND INV.ITEM_CAT = UM.ITEM_CAT AND INV.SALESMAN = UM.SALESMAN
											) OUM
									WHERE OUM.AMOUNT > 0
								) ASCY
						GROUP BY ASCY.BRANCHES, ASCY.ITEM_CAT, ASCY.SALESMAN
						UNION ALL
						SELECT	'(-) Accured Sales Current Year Semester 2' AS NOTE
								,ASCY.BRANCHES
								,ASCY.ITEM_CAT
								,ASCY.SALESMAN
								,0 AS AMOUNT_S1
								,SUM(ASCY.AMOUNT) * -1 AS AMOUNT_S2
						FROM	(
									SELECT	OUM.ITEM_CAT
											,OUM.BRANCHES
											,OUM.SALESMAN
											,OUM.AMOUNT
									FROM	(
												SELECT	UM.ITEM_CAT
														,UM.BRANCHES
														,UM.SALESMAN
														,UM.TGL_UM
														,	CASE WHEN ISNULL(INV.AMOUNT,0) = 0 THEN UM.AMOUNT ELSE
																CASE WHEN SUM(UM.AMOUNT)OVER(PARTITION BY UM.NO_SO, UM.BRANCHES, UM.ITEM_CAT, UM.SALESMAN  ORDER BY UM.TGL_UM) <= ISNULL(INV.AMOUNT,0) THEN 0 ELSE
																	SUM(UM.AMOUNT)OVER(PARTITION BY UM.NO_SO, UM.BRANCHES, UM.ITEM_CAT, UM.SALESMAN  ORDER BY UM.TGL_UM) - ISNULL(INV.AMOUNT,0)
																END
															END AS AMOUNT
												FROM	(
															SELECT	DIMS.ITEM_CAT
																	,DIMS.BRANCHES
																	,DIMS.SALESMAN
																	,SIH.[Posting Date] AS TGL_UM
																	,SIH.[No_] AS NO_UM
																	,SIH.[External Document No_] AS NO_PO_CUST
																	,SIH.[Bill-to Customer No_] AS CUST_NO
																	,SIH.[Bill-to Name] AS CUST_NAME
																	,SIH.[Prepayment Order No_] AS NO_SO
																	, (SUM(GLE.[Amount]) * -1) AS AMOUNT
															FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
															LEFT JOIN	(
																			SELECT	DIM.DIM_ID
																					,MAX(DIM.BRANCHES) AS BRANCHES
																					,MAX(DIM.ITEM_CAT) AS ITEM_CAT
																					,MAX(DIM.SALESMAN) AS SALESMAN
																			FROM	(
																						SELECT [Dimension Set ID] AS DIM_ID
																							  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																							  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																							  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																						FROM [AUTOJAYA].[dbo].[AUTOJAYA$Dimension Set Entry]
																					) DIM
																			GROUP BY DIM.DIM_ID
																		) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
															LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
															LEFT JOIN	(
																			SELECT CLE.[Entry No_]
																					, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE.[Document No_] ELSE CLE2.[Document No_] END AS NO_UM
																					, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE2.[Document No_] ELSE CLE.[Document No_] END AS NO_CM
																			FROM [AUTOJAYA].[dbo].[AUTOJAYA$Cust_ Ledger Entry] CLE
																			LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Cust_ Ledger Entry] CLE2 ON CLE2.[Entry No_] = CLE.[Closed by Entry No_]
																			WHERE CLE.[Document Type] IN (2,3)
																			AND ((CLE.[Document No_]  LIKE 'UM%' AND CLE2.[Document Type] = 3) OR
																				(CLE2.[Document No_]  LIKE 'UM%' AND CLE.[Document Type] = 3) )
																		) CM ON CM.NO_UM = GLE.[Document No_]
															LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Cr_Memo Header] CMH ON CMH.[No_] = CM.NO_CM
															WHERE GLE.[G_L Account No_] = '400.110.03'
																  AND GLE.[Document No_] LIKE 'UM%'
																  AND (CM.NO_CM IS NULL OR (CM.NO_CM IS NOT NULL AND CMH.[Posting Date] > (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime)) ))
																  AND (SIH.[Posting Date] >= (CAST((CAST($P{Tahun} as varchar(4))+'-07-01') AS datetime)) AND SIH.[Posting Date]<= (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime)))
															GROUP BY DIMS.ITEM_CAT
																	 ,DIMS.BRANCHES
																	 ,DIMS.SALESMAN
																	 ,SIH.[Posting Date]
																	 ,SIH.[No_]
																	 ,SIH.[External Document No_]
																	 ,SIH.[Bill-to Customer No_]
																	 ,SIH.[Bill-to Name]
																	 ,SIH.[Prepayment Order No_]
														) UM
												LEFT JOIN	(
																SELECT	DIMS.ITEM_CAT
																		,DIMS.BRANCHES
																		,DIMS.SALESMAN
																		,SIH.[Order No_] AS NO_SO
																		,MAX(SIH.[Posting Date]) AS TGL_INV
																		,SUM(GLE.[Amount]) AS AMOUNT
																FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
																LEFT JOIN	(
																				SELECT	DIM.DIM_ID
																						,MAX(DIM.BRANCHES) AS BRANCHES
																						,MAX(DIM.ITEM_CAT) AS ITEM_CAT
																						,MAX(DIM.SALESMAN) AS SALESMAN
																				FROM	(
																							SELECT [Dimension Set ID] AS DIM_ID
																								  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																								  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																								  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																							FROM [AUTOJAYA].[dbo].[AUTOJAYA$Dimension Set Entry]
																						) DIM
																				GROUP BY DIM.DIM_ID
																			) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
																LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
																WHERE GLE.[G_L Account No_] = '400.110.03'
																	  AND GLE.[Document No_] NOT LIKE 'UM%'
																	  AND GLE.[Posting Date] <=  (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime))
																GROUP BY DIMS.ITEM_CAT
																		,DIMS.BRANCHES
																		,DIMS.SALESMAN
																		,SIH.[Order No_]
															) INV ON INV.NO_SO = UM.NO_SO AND INV.BRANCHES = UM.BRANCHES AND INV.ITEM_CAT = UM.ITEM_CAT AND INV.SALESMAN = UM.SALESMAN
											) OUM
									WHERE OUM.AMOUNT > 0
								) ASCY
						GROUP BY ASCY.BRANCHES, ASCY.ITEM_CAT, ASCY.SALESMAN
						UNION ALL
						SELECT	'(+) Accured Sales Previous Year' AS NOTE
								,ASPY.BRANCHES
								,ASPY.ITEM_CAT
								,ASPY.SALESMAN
								,SUM(ASPY.AMOUNT_S1)  AS AMOUNT_S1
								,SUM(ASPY.AMOUNT_S2)  AS AMOUNT_S2
						FROM	(
									SELECT	OUM.ITEM_CAT
											,OUM.BRANCHES
											,OUM.SALESMAN
											,CASE WHEN DATEPART(quarter, OUM.TGL_INV) IN (1,2) THEN OUM.AMOUNT ELSE 0 END AS AMOUNT_S1
											,CASE WHEN DATEPART(quarter, OUM.TGL_INV) IN (3,4) THEN OUM.AMOUNT ELSE 0 END AS AMOUNT_S2
									FROM	(
												SELECT	UM.ITEM_CAT
														,UM.BRANCHES
														,UM.SALESMAN
														,INV.TGL_INV
														, CASE WHEN ISNULL(INV.AMOUNT,0) =  0 THEN 0 ELSE
															CASE WHEN SUM(UM.AMOUNT)OVER(PARTITION BY UM.NO_SO, UM.BRANCHES, UM.ITEM_CAT, UM.SALESMAN  ORDER BY UM.TGL_UM) <= ISNULL(INV.AMOUNT,0) THEN
																UM.AMOUNT ELSE SUM(UM.AMOUNT)OVER(PARTITION BY UM.NO_SO, UM.BRANCHES, UM.ITEM_CAT, UM.SALESMAN  ORDER BY UM.TGL_UM) - ISNULL(INV.AMOUNT,0)
															END
														  END AS AMOUNT
												FROM	(
															SELECT	DIMS.ITEM_CAT
																	,DIMS.BRANCHES
																	,CASE WHEN SIH.[No_] = 'UMAT150027' THEN 'HRY' ELSE DIMS.SALESMAN END AS SALESMAN
																	,SIH.[Posting Date] AS TGL_UM
																	,SIH.[No_] AS NO_UM
																	,SIH.[External Document No_] AS NO_PO_CUST
																	,SIH.[Bill-to Customer No_] AS CUST_NO
																	,SIH.[Bill-to Name] AS CUST_NAME
																	,SIH.[Prepayment Order No_] AS NO_SO
																	, (SUM(GLE.[Amount]) * -1) AS AMOUNT
															FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
															LEFT JOIN	(
																			SELECT	DIM.DIM_ID
																					,MAX(DIM.BRANCHES) AS BRANCHES
																					,MAX(DIM.ITEM_CAT) AS ITEM_CAT
																					,MAX(DIM.SALESMAN) AS SALESMAN
																			FROM	(
																						SELECT [Dimension Set ID] AS DIM_ID
																							  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																							  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																							  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																						FROM [AUTOJAYA].[dbo].[AUTOJAYA$Dimension Set Entry]
																					) DIM
																			GROUP BY DIM.DIM_ID
																		) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
															LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
															LEFT JOIN	(
																			SELECT CLE.[Entry No_]
																					, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE.[Document No_] ELSE CLE2.[Document No_] END AS NO_UM
																					, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE2.[Document No_] ELSE CLE.[Document No_] END AS NO_CM
																			FROM [AUTOJAYA].[dbo].[AUTOJAYA$Cust_ Ledger Entry] CLE
																			LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Cust_ Ledger Entry] CLE2 ON CLE2.[Entry No_] = CLE.[Closed by Entry No_]
																			WHERE CLE.[Document Type] IN (2,3)
																			AND ((CLE.[Document No_]  LIKE 'UM%' AND CLE2.[Document Type] = 3) OR
																				(CLE2.[Document No_]  LIKE 'UM%' AND CLE.[Document Type] = 3) )
																		) CM ON CM.NO_UM = GLE.[Document No_]
															LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Cr_Memo Header] CMH ON CMH.[No_] = CM.NO_CM
															WHERE GLE.[G_L Account No_] = '400.110.03'
																  AND GLE.[Document No_] LIKE 'UM%'
																  AND CM.NO_CM IS NULL
																  AND (SIH.[Posting Date] < (CAST((CAST($P{Tahun} as varchar(4))+'-01-01') AS datetime)))
															GROUP BY DIMS.ITEM_CAT
																	 ,DIMS.BRANCHES
																	 ,DIMS.SALESMAN
																	 ,SIH.[Posting Date]
																	 ,SIH.[No_]
																	 ,SIH.[External Document No_]
																	 ,SIH.[Bill-to Customer No_]
																	 ,SIH.[Bill-to Name]
																	 ,SIH.[Prepayment Order No_]
														) UM
												LEFT JOIN	(
																SELECT	DIMS.ITEM_CAT
																		,DIMS.BRANCHES
																		,DIMS.SALESMAN
																		,SIH.[Order No_] AS NO_SO
																		,MAX(SIH.[Posting Date]) AS TGL_INV
																		,SUM(GLE.[Amount]) AS AMOUNT
																FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
																LEFT JOIN	(
																				SELECT	DIM.DIM_ID
																						,MAX(DIM.BRANCHES) AS BRANCHES
																						,MAX(DIM.ITEM_CAT) AS ITEM_CAT
																						,MAX(DIM.SALESMAN) AS SALESMAN
																				FROM	(
																							SELECT [Dimension Set ID] AS DIM_ID
																								  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																								  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																								  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																							FROM [AUTOJAYA].[dbo].[AUTOJAYA$Dimension Set Entry]
																						) DIM
																				GROUP BY DIM.DIM_ID
																			) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
																LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
																WHERE GLE.[G_L Account No_] = '400.110.03'
																	  AND GLE.[Document No_] NOT LIKE 'UM%'
																	  AND (GLE.[Posting Date] >= (CAST((CAST($P{Tahun} as varchar(4))+'-01-01') AS datetime)) AND GLE.[Posting Date] <= (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime)))
																GROUP BY DIMS.ITEM_CAT
																		,DIMS.BRANCHES
																		,DIMS.SALESMAN
																		,SIH.[Order No_]
															) INV ON INV.NO_SO = UM.NO_SO AND INV.BRANCHES = UM.BRANCHES AND INV.ITEM_CAT = UM.ITEM_CAT AND INV.SALESMAN = UM.SALESMAN
											) OUM
									WHERE OUM.AMOUNT > 0
								) ASPY
						GROUP BY ASPY.BRANCHES, ASPY.ITEM_CAT, ASPY.SALESMAN
						UNION ALL
						SELECT	'(+) Accured Sales Previous Semester' AS NOTE
								,ASPY.BRANCHES
								,ASPY.ITEM_CAT
								,ASPY.SALESMAN
								,0 AS AMOUNT_S1
								,SUM(ASPY.AMOUNT)  AS AMOUNT_S2
						FROM	(
									SELECT	OUM.ITEM_CAT
											,OUM.BRANCHES
											,OUM.SALESMAN
											,OUM.AMOUNT
									FROM	(
												SELECT	UM.ITEM_CAT
														,UM.BRANCHES
														,UM.SALESMAN
														,INV.TGL_INV
														, CASE WHEN ISNULL(INV.AMOUNT,0) =  0 THEN 0 ELSE
															CASE WHEN SUM(UM.AMOUNT)OVER(PARTITION BY UM.NO_SO, UM.BRANCHES, UM.ITEM_CAT, UM.SALESMAN  ORDER BY UM.TGL_UM) <= ISNULL(INV.AMOUNT,0) THEN
																UM.AMOUNT ELSE SUM(UM.AMOUNT)OVER(PARTITION BY UM.NO_SO, UM.BRANCHES, UM.ITEM_CAT, UM.SALESMAN  ORDER BY UM.TGL_UM) - ISNULL(INV.AMOUNT,0)
															END
														  END AS AMOUNT
												FROM	(
															SELECT	DIMS.ITEM_CAT
																	,DIMS.BRANCHES
																	,CASE WHEN SIH.[No_] = 'UMAT150027' THEN 'HRY' ELSE DIMS.SALESMAN END AS SALESMAN
																	,SIH.[Posting Date] AS TGL_UM
																	,SIH.[No_] AS NO_UM
																	,SIH.[External Document No_] AS NO_PO_CUST
																	,SIH.[Bill-to Customer No_] AS CUST_NO
																	,SIH.[Bill-to Name] AS CUST_NAME
																	,SIH.[Prepayment Order No_] AS NO_SO
																	, (SUM(GLE.[Amount]) * -1) AS AMOUNT
															FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
															LEFT JOIN	(
																			SELECT	DIM.DIM_ID
																					,MAX(DIM.BRANCHES) AS BRANCHES
																					,MAX(DIM.ITEM_CAT) AS ITEM_CAT
																					,MAX(DIM.SALESMAN) AS SALESMAN
																			FROM	(
																						SELECT [Dimension Set ID] AS DIM_ID
																							  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																							  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																							  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																						FROM [AUTOJAYA].[dbo].[AUTOJAYA$Dimension Set Entry]
																					) DIM
																			GROUP BY DIM.DIM_ID
																		) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
															LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
															LEFT JOIN	(
																			SELECT CLE.[Entry No_]
																					, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE.[Document No_] ELSE CLE2.[Document No_] END AS NO_UM
																					, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE2.[Document No_] ELSE CLE.[Document No_] END AS NO_CM
																			FROM [AUTOJAYA].[dbo].[AUTOJAYA$Cust_ Ledger Entry] CLE
																			LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Cust_ Ledger Entry] CLE2 ON CLE2.[Entry No_] = CLE.[Closed by Entry No_]
																			WHERE CLE.[Document Type] IN (2,3)
																			AND ((CLE.[Document No_]  LIKE 'UM%' AND CLE2.[Document Type] = 3) OR
																				(CLE2.[Document No_]  LIKE 'UM%' AND CLE.[Document Type] = 3) )
																		) CM ON CM.NO_UM = GLE.[Document No_]
															LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Cr_Memo Header] CMH ON CMH.[No_] = CM.NO_CM
															WHERE GLE.[G_L Account No_] = '400.110.03'
																  AND GLE.[Document No_] LIKE 'UM%'
																  AND CM.NO_CM IS NULL
																  AND (SIH.[Posting Date] >= (CAST((CAST($P{Tahun} as varchar(4))+'-01-01') AS datetime)) AND SIH.[Posting Date]<= (CAST((CAST($P{Tahun} as varchar(4))+'-06-30') AS datetime)))
															GROUP BY DIMS.ITEM_CAT
																	 ,DIMS.BRANCHES
																	 ,DIMS.SALESMAN
																	 ,SIH.[Posting Date]
																	 ,SIH.[No_]
																	 ,SIH.[External Document No_]
																	 ,SIH.[Bill-to Customer No_]
																	 ,SIH.[Bill-to Name]
																	 ,SIH.[Prepayment Order No_]
														) UM
												LEFT JOIN	(
																SELECT	DIMS.ITEM_CAT
																		,DIMS.BRANCHES
																		,DIMS.SALESMAN
																		,SIH.[Order No_] AS NO_SO
																		,MAX(SIH.[Posting Date]) AS TGL_INV
																		,SUM(GLE.[Amount]) AS AMOUNT
																FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
																LEFT JOIN	(
																				SELECT	DIM.DIM_ID
																						,MAX(DIM.BRANCHES) AS BRANCHES
																						,MAX(DIM.ITEM_CAT) AS ITEM_CAT
																						,MAX(DIM.SALESMAN) AS SALESMAN
																				FROM	(
																							SELECT [Dimension Set ID] AS DIM_ID
																								  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																								  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																								  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																							FROM [AUTOJAYA].[dbo].[AUTOJAYA$Dimension Set Entry]
																						) DIM
																				GROUP BY DIM.DIM_ID
																			) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
																LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
																WHERE GLE.[G_L Account No_] = '400.110.03'
																	  AND GLE.[Document No_] NOT LIKE 'UM%'
																	  AND (GLE.[Posting Date] >= (CAST((CAST($P{Tahun} as varchar(4))+'-07-01') AS datetime)) AND GLE.[Posting Date] <= (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime)))
																GROUP BY DIMS.ITEM_CAT
																		,DIMS.BRANCHES
																		,DIMS.SALESMAN
																		,SIH.[Order No_]
															) INV ON INV.NO_SO = UM.NO_SO AND INV.BRANCHES = UM.BRANCHES AND INV.ITEM_CAT = UM.ITEM_CAT AND INV.SALESMAN = UM.SALESMAN
											) OUM
									WHERE OUM.AMOUNT > 0
								) ASPY
						GROUP BY ASPY.BRANCHES, ASPY.ITEM_CAT, ASPY.SALESMAN
						UNION ALL
						SELECT	'(-/+) Others Management Adjustment - ALL' AS NOTE
								,DIMS.BRANCHES
								,DIMS.ITEM_CAT
								,DIMS.SALESMAN
								,SUM(CASE WHEN DATEPART(quarter, GLE.[Posting Date]) IN (1,2) THEN GLE.[Amount] ELSE 0 END) * -1 AS AMOUNT_S1
								,SUM(CASE WHEN DATEPART(quarter, GLE.[Posting Date]) IN (3,4) THEN GLE.[Amount] ELSE 0 END) * -1 AS AMOUNT_S2
						FROM [AUTOJAYA].[dbo].[AJ-ADJ$G_L Entry] GLE
						LEFT JOIN	(
										SELECT	DIM.DIM_ID
												,MAX(DIM.BRANCHES) AS BRANCHES
												,MAX(DIM.ITEM_CAT) AS ITEM_CAT
												,MAX(DIM.SALESMAN) AS SALESMAN
										FROM	(
													SELECT [Dimension Set ID] AS DIM_ID
														  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
														  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
														  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
													FROM [AUTOJAYA].[dbo].[AJ-ADJ$Dimension Set Entry]
												) DIM
										GROUP BY DIM.DIM_ID
									) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
						WHERE	(GLE.[G_L Account No_] BETWEEN '400.110.00'  AND '420.110.01') AND
								GLE.[G_L Account No_] <> '400.110.04' AND
								DIMS.ITEM_CAT <> '' AND
								(GLE.[Posting Date] >= (CAST((CAST($P{Tahun} as varchar(4))+'-01-01') AS datetime)) AND GLE.[Posting Date] <=  (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime)))
						GROUP BY DIMS.BRANCHES, DIMS.ITEM_CAT, DIMS.SALESMAN
						UNION ALL
						SELECT	'(-/+) Others Management Adjustment - SALES LAINNYA' AS NOTE
								,'10' BRANCHES
								,'HW01' AS ITEM_CAT
								,'OFC' AS SALESMAN
								,SUM(CASE WHEN DATEPART(quarter, GLE.[Posting Date]) IN (1,2) THEN GLE.[Amount] ELSE 0 END) * -1 AS AMOUNT_S1
								,SUM(CASE WHEN DATEPART(quarter, GLE.[Posting Date]) IN (3,4) THEN GLE.[Amount] ELSE 0 END) * -1 AS AMOUNT_S2
						FROM [AUTOJAYA].[dbo].[AJ-ADJ$G_L Entry] GLE
						LEFT JOIN	(
										SELECT	DIM.DIM_ID
												,MAX(DIM.BRANCHES) AS BRANCHES
												,MAX(DIM.ITEM_CAT) AS ITEM_CAT
												,MAX(DIM.SALESMAN) AS SALESMAN
										FROM	(
													SELECT [Dimension Set ID] AS DIM_ID
														  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
														  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
														  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
													FROM [AUTOJAYA].[dbo].[AJ-ADJ$Dimension Set Entry]
												) DIM
										GROUP BY DIM.DIM_ID
									) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
						WHERE	GLE.[G_L Account No_] = '400.110.04' AND
								(GLE.[Posting Date] >= (CAST((CAST($P{Tahun} as varchar(4))+'-01-01') AS datetime)) AND GLE.[Posting Date] <=  (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime)))
						GROUP BY DIMS.BRANCHES, DIMS.ITEM_CAT, DIMS.SALESMAN
						UNION ALL
						SELECT	'SALES CORRECTION - FA/INTERCOY' AS NOTE
								, SLC.BRANCHES
								, SLC.ITEM_CAT
								, SLC.SALESMAN
								, SUM(SLC.AMOUNT_S1) AS AMOUNT_S1
								, SUM(SLC.AMOUNT_S2) AS AMOUNT_S2
						FROM	(
									SELECT	DIMS.BRANCHES
											,DIMS.ITEM_CAT
											,DIMS.SALESMAN
											,CASE WHEN GLE.[Source No_] = 'SOPE001' THEN '2. Sales INTERCOY' ELSE '1. Sales FA' END AS SALES_TITLE
											,CASE WHEN GLE.[Source No_] = 'SOPE001' THEN '(-) Sales INTERCOY' ELSE '(-) Sales FA' END AS SALES_TITLE2
											,CASE WHEN GLE.[Source No_] = 'SOPE001' THEN 'SLS-0302' ELSE 'SLS-0301' END AS SORT_SLS
											,CASE WHEN DATEPART(quarter, GLE.[Posting Date]) IN (1,2) THEN GLE.[Amount] ELSE 0 END AS AMOUNT_S1
											,CASE WHEN DATEPART(quarter, GLE.[Posting Date]) IN (3,4) THEN GLE.[Amount] ELSE 0 END AS AMOUNT_S2
									FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
									LEFT JOIN	(
													SELECT	DIM.DIM_ID
															,MAX(DIM.BRANCHES) AS BRANCHES
															,MAX(DIM.ITEM_CAT) AS ITEM_CAT
															,MAX(DIM.SALESMAN) AS SALESMAN
													FROM	(
																SELECT [Dimension Set ID] AS DIM_ID
																	  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																	  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																	  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																FROM [AUTOJAYA].[dbo].[AUTOJAYA$Dimension Set Entry]
															) DIM
													GROUP BY DIM.DIM_ID
												) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
									WHERE GLE.[G_L Account No_] IN ('400.110.01', '410.110.01', '420.110.01')
											AND GLE.[Posting Date] >= (CAST((CAST($P{Tahun} as varchar(4))+'-01-01') AS datetime)) AND GLE.[Posting Date] <=  (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime))
								) SLC
						GROUP BY SLC.BRANCHES, SLC.ITEM_CAT, SLC.SALESMAN
						UNION ALL
						SELECT	'SALES CORRECTION - FA/INTERCOY ADJ' AS NOTE
								, SLC.BRANCHES
								, SLC.ITEM_CAT
								, SLC.SALESMAN
								, SUM(SLC.AMOUNT_S1) AS AMOUNT_S1
								, SUM(SLC.AMOUNT_S2) AS AMOUNT_S2
						FROM	(
									SELECT	'3. Others Sales Adjustment' AS SALES_TITLE
											,'(-/+) Others Management Adjustment' AS SALES_TITLE2
											,'SLS-0303' AS SORT_SLS
											, DIMS.BRANCHES
											, DIMS.ITEM_CAT
											, DIMS.SALESMAN
											, CASE WHEN DATEPART(quarter, GLE.[Posting Date]) IN (1,2) THEN GLE.[Amount] ELSE 0 END AS AMOUNT_S1
											, CASE WHEN DATEPART(quarter, GLE.[Posting Date]) IN (3,4) THEN GLE.[Amount] ELSE 0 END AS AMOUNT_S2
									FROM [AUTOJAYA].[dbo].[AJ-ADJ$G_L Entry] GLE
									LEFT JOIN	(
													SELECT	DIM.DIM_ID
															,MAX(DIM.BRANCHES) AS BRANCHES
															,MAX(DIM.ITEM_CAT) AS ITEM_CAT
															,MAX(DIM.SALESMAN) AS SALESMAN
													FROM	(
																SELECT [Dimension Set ID] AS DIM_ID
																	  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																	  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																	  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																FROM [AUTOJAYA].[dbo].[AJ-ADJ$Dimension Set Entry]
															) DIM
													GROUP BY DIM.DIM_ID
												) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
									WHERE GLE.[G_L Account No_] IN ('400.110.01', '410.110.01', '420.110.01')
											AND GLE.[Posting Date] >= (CAST((CAST($P{Tahun} as varchar(4))+'-01-01') AS datetime)) AND GLE.[Posting Date] <=  (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime))
								) SLC
						GROUP BY SLC.BRANCHES, SLC.ITEM_CAT, SLC.SALESMAN
						UNION ALL
						SELECT	'SALES ALL' AS NOTE
								, DIMS.BRANCHES
								, DIMS.ITEM_CAT
								, DIMS.SALESMAN
								, SUM(CASE WHEN DATEPART(quarter, GLE.[Posting Date]) IN (1,2) THEN GLE.[Amount] ELSE 0 END) * -1 AS AMOUNT_S1
								, SUM(CASE WHEN DATEPART(quarter, GLE.[Posting Date]) IN (3,4) THEN GLE.[Amount] ELSE 0 END) * -1 AS AMOUNT_S2
						FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
						LEFT JOIN	(
										SELECT	DIM.DIM_ID
												,MAX(DIM.BRANCHES) AS BRANCHES
												,MAX(DIM.ITEM_CAT) AS ITEM_CAT
												,MAX(DIM.SALESMAN) AS SALESMAN
										FROM	(
													SELECT [Dimension Set ID] AS DIM_ID
														  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
														  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
														  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
													FROM [AUTOJAYA].[dbo].[SOLUSI$Dimension Set Entry]
												) DIM
										GROUP BY DIM.DIM_ID
									) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
						WHERE	(GLE.[G_L Account No_] BETWEEN '400.110.00'  AND '420.110.01') AND
								GLE.[G_L Account No_] <> '400.110.04' AND
								DIMS.ITEM_CAT <> ''AND
								(GLE.[Posting Date] >= (CAST((CAST($P{Tahun} as varchar(4))+'-01-01') AS datetime)) AND GLE.[Posting Date] <=  (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime)))
						GROUP BY DIMS.BRANCHES, DIMS.ITEM_CAT, DIMS.SALESMAN
						UNION ALL
						SELECT	'Sales - LAINNYA' AS NOTE
								,'10' BRANCHES
								,'HW01' AS ITEM_CAT
								,'OFC' AS SALESMAN
								, SUM(CASE WHEN DATEPART(quarter, GLE.[Posting Date]) IN (1,2) THEN GLE.[Amount] ELSE 0 END) * -1 AS AMOUNT_S1
								, SUM(CASE WHEN DATEPART(quarter, GLE.[Posting Date]) IN (3,4) THEN GLE.[Amount] ELSE 0 END) * -1 AS AMOUNT_S2
						FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
						LEFT JOIN	(
										SELECT	DIM.DIM_ID
												,MAX(DIM.BRANCHES) AS BRANCHES
												,MAX(DIM.ITEM_CAT) AS ITEM_CAT
												,MAX(DIM.SALESMAN) AS SALESMAN
										FROM	(
													SELECT [Dimension Set ID] AS DIM_ID
														  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
														  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
														  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
													FROM [AUTOJAYA].[dbo].[SOLUSI$Dimension Set Entry]
												) DIM
										GROUP BY DIM.DIM_ID
									) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
						WHERE	GLE.[G_L Account No_] = '400.110.04' AND
								(GLE.[Posting Date] >= (CAST((CAST($P{Tahun} as varchar(4))+'-01-01') AS datetime)) AND GLE.[Posting Date] <=  (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime)))
						UNION ALL
						SELECT	'(-) Accured Sales Current Year Semester 1' AS NOTE
								,ASCY.BRANCHES
								,ASCY.ITEM_CAT
								,ASCY.SALESMAN
								,SUM(ASCY.AMOUNT) * -1 AS AMOUNT_S1
								,0 AS AMOUNT_S2
						FROM (
								SELECT	OUM.ITEM_CAT
										,OUM.BRANCHES
										,OUM.SALESMAN
										,OUM.AMOUNT
								FROM	(
											SELECT	UM.ITEM_CAT
													,UM.BRANCHES
													,UM.SALESMAN
													,UM.TGL_UM
													,CASE WHEN ISNULL(INV.AMOUNT,0) = 0 THEN UM.AMOUNT ELSE
														CASE WHEN SUM(UM.AMOUNT)OVER(PARTITION BY UM.NO_SO, UM.BRANCHES, UM.ITEM_CAT, UM.SALESMAN  ORDER BY UM.TGL_UM) <= ISNULL(INV.AMOUNT,0) THEN 0 ELSE
														SUM(UM.AMOUNT)OVER(PARTITION BY UM.NO_SO, UM.BRANCHES, UM.ITEM_CAT, UM.SALESMAN  ORDER BY UM.TGL_UM) - ISNULL(INV.AMOUNT,0)
													END
													END	 AS AMOUNT
											FROM	(
														SELECT	DIMS.ITEM_CAT
																,DIMS.BRANCHES
																,DIMS.SALESMAN
																,SIH.[Posting Date] AS TGL_UM
																,SIH.[No_] AS NO_UM
																,SIH.[External Document No_] AS NO_PO_CUST
																,SIH.[Bill-to Customer No_] AS CUST_NO
																,SIH.[Bill-to Name] AS CUST_NAME
																,SIH.[Prepayment Order No_] AS NO_SO
																, (SUM(GLE.[Amount]) * -1) AS AMOUNT
														FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
														LEFT JOIN	(
																		SELECT	DIM.DIM_ID
																				,MAX(DIM.BRANCHES) AS BRANCHES
																				,MAX(DIM.ITEM_CAT) AS ITEM_CAT
																				,MAX(DIM.SALESMAN) AS SALESMAN
																		FROM	(
																					SELECT [Dimension Set ID] AS DIM_ID
																						  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																						  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																						  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																					FROM [AUTOJAYA].[dbo].[SOLUSI$Dimension Set Entry]
																				) DIM
																		GROUP BY DIM.DIM_ID
																	) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
														LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
														LEFT JOIN	(
																		SELECT CLE.[Entry No_]
																				, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE.[Document No_] ELSE CLE2.[Document No_] END AS NO_UM
																				, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE2.[Document No_] ELSE CLE.[Document No_] END AS NO_CM
																		FROM [AUTOJAYA].[dbo].[SOLUSI$Cust_ Ledger Entry] CLE
																		LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Cust_ Ledger Entry] CLE2 ON CLE2.[Entry No_] = CLE.[Closed by Entry No_]
																		WHERE CLE.[Document Type] IN (2,3)
																		AND ((CLE.[Document No_]  LIKE 'UM%' AND CLE2.[Document Type] = 3) OR
																			(CLE2.[Document No_]  LIKE 'UM%' AND CLE.[Document Type] = 3) )
																	) CM ON CM.NO_UM = GLE.[Document No_]
														LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Cr_Memo Header] CMH ON CMH.[No_] = CM.NO_CM
														WHERE GLE.[G_L Account No_] = '400.110.03'
															  AND GLE.[Document No_] LIKE 'UM%'
															  AND (CM.NO_CM IS NULL OR (CM.NO_CM IS NOT NULL AND CMH.[Posting Date] > (CAST((CAST($P{Tahun} as varchar(4))+'-06-30') AS datetime)) ))
															  AND (SIH.[Posting Date] >= (CAST((CAST($P{Tahun} as varchar(4))+'-01-01') AS datetime)) AND SIH.[Posting Date]<= (CAST((CAST($P{Tahun} as varchar(4))+'-06-30') AS datetime)))
														GROUP BY DIMS.ITEM_CAT
																 ,DIMS.BRANCHES
																 ,DIMS.SALESMAN
																 ,SIH.[Posting Date]
																 ,SIH.[No_]
																 ,SIH.[External Document No_]
																 ,SIH.[Bill-to Customer No_]
																 ,SIH.[Bill-to Name]
																 ,SIH.[Prepayment Order No_]
													) UM
											LEFT JOIN	(
															SELECT	DIMS.ITEM_CAT
																	,DIMS.BRANCHES
																	,DIMS.SALESMAN
																	,SIH.[Order No_] AS NO_SO
																	,MAX(SIH.[Posting Date]) AS TGL_INV
																	,SUM(GLE.[Amount]) AS AMOUNT
															FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
															LEFT JOIN	(
																			SELECT	DIM.DIM_ID
																					,MAX(DIM.BRANCHES) AS BRANCHES
																					,MAX(DIM.ITEM_CAT) AS ITEM_CAT
																					,MAX(DIM.SALESMAN) AS SALESMAN
																			FROM	(
																						SELECT [Dimension Set ID] AS DIM_ID
																							  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																							  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																							  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																						FROM [AUTOJAYA].[dbo].[SOLUSI$Dimension Set Entry]
																					) DIM
																			GROUP BY DIM.DIM_ID
																		) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
															LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
															WHERE GLE.[G_L Account No_] = '400.110.03'
																  AND GLE.[Document No_] NOT LIKE 'UM%'
																  AND GLE.[Posting Date] <=  (CAST((CAST($P{Tahun} as varchar(4))+'-06-30') AS datetime))
															GROUP BY DIMS.ITEM_CAT
																	,DIMS.BRANCHES
																	,DIMS.SALESMAN
																	,SIH.[Order No_]
														) INV ON INV.NO_SO = UM.NO_SO AND INV.BRANCHES = UM.BRANCHES AND INV.ITEM_CAT = UM.ITEM_CAT AND INV.SALESMAN = UM.SALESMAN
										) OUM
								WHERE OUM.AMOUNT > 0
							 ) ASCY
						GROUP BY ASCY.BRANCHES, ASCY.ITEM_CAT, ASCY.SALESMAN
						UNION ALL
						SELECT	'(-) Accured Sales Current Year Semester 2' AS NOTE
								,ASCY.BRANCHES
								,ASCY.ITEM_CAT
								,ASCY.SALESMAN
								,0 AS AMOUNT_S1
								,SUM(ASCY.AMOUNT) * -1 AS AMOUNT_S2
						FROM (
								SELECT	OUM.ITEM_CAT
										,OUM.BRANCHES
										,OUM.SALESMAN
										,OUM.AMOUNT
								FROM	(
											SELECT	UM.ITEM_CAT
													,UM.BRANCHES
													,UM.SALESMAN
													,UM.TGL_UM
													,CASE WHEN ISNULL(INV.AMOUNT,0) = 0 THEN UM.AMOUNT ELSE
														CASE WHEN SUM(UM.AMOUNT)OVER(PARTITION BY UM.NO_SO, UM.BRANCHES, UM.ITEM_CAT, UM.SALESMAN  ORDER BY UM.TGL_UM) <= ISNULL(INV.AMOUNT,0) THEN 0 ELSE
														SUM(UM.AMOUNT)OVER(PARTITION BY UM.NO_SO, UM.BRANCHES, UM.ITEM_CAT, UM.SALESMAN  ORDER BY UM.TGL_UM) - ISNULL(INV.AMOUNT,0)
													END
													END	 AS AMOUNT
											FROM	(
														SELECT	DIMS.ITEM_CAT
																,DIMS.BRANCHES
																,DIMS.SALESMAN
																,SIH.[Posting Date] AS TGL_UM
																,SIH.[No_] AS NO_UM
																,SIH.[External Document No_] AS NO_PO_CUST
																,SIH.[Bill-to Customer No_] AS CUST_NO
																,SIH.[Bill-to Name] AS CUST_NAME
																,SIH.[Prepayment Order No_] AS NO_SO
																, (SUM(GLE.[Amount]) * -1) AS AMOUNT
														FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
														LEFT JOIN	(
																		SELECT	DIM.DIM_ID
																				,MAX(DIM.BRANCHES) AS BRANCHES
																				,MAX(DIM.ITEM_CAT) AS ITEM_CAT
																				,MAX(DIM.SALESMAN) AS SALESMAN
																		FROM	(
																					SELECT [Dimension Set ID] AS DIM_ID
																						  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																						  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																						  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																					FROM [AUTOJAYA].[dbo].[SOLUSI$Dimension Set Entry]
																				) DIM
																		GROUP BY DIM.DIM_ID
																	) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
														LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
														LEFT JOIN	(
																		SELECT CLE.[Entry No_]
																				, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE.[Document No_] ELSE CLE2.[Document No_] END AS NO_UM
																				, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE2.[Document No_] ELSE CLE.[Document No_] END AS NO_CM
																		FROM [AUTOJAYA].[dbo].[SOLUSI$Cust_ Ledger Entry] CLE
																		LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Cust_ Ledger Entry] CLE2 ON CLE2.[Entry No_] = CLE.[Closed by Entry No_]
																		WHERE CLE.[Document Type] IN (2,3)
																		AND ((CLE.[Document No_]  LIKE 'UM%' AND CLE2.[Document Type] = 3) OR
																			(CLE2.[Document No_]  LIKE 'UM%' AND CLE.[Document Type] = 3) )
																	) CM ON CM.NO_UM = GLE.[Document No_]
														LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Cr_Memo Header] CMH ON CMH.[No_] = CM.NO_CM
														WHERE GLE.[G_L Account No_] = '400.110.03'
															  AND GLE.[Document No_] LIKE 'UM%'
															  AND (CM.NO_CM IS NULL OR (CM.NO_CM IS NOT NULL AND CMH.[Posting Date] > (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime)) ))
															  AND (SIH.[Posting Date] >= (CAST((CAST($P{Tahun} as varchar(4))+'-07-01') AS datetime)) AND SIH.[Posting Date]<= (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime)))
														GROUP BY DIMS.ITEM_CAT
																 ,DIMS.BRANCHES
																 ,DIMS.SALESMAN
																 ,SIH.[Posting Date]
																 ,SIH.[No_]
																 ,SIH.[External Document No_]
																 ,SIH.[Bill-to Customer No_]
																 ,SIH.[Bill-to Name]
																 ,SIH.[Prepayment Order No_]
													) UM
											LEFT JOIN	(
															SELECT	DIMS.ITEM_CAT
																	,DIMS.BRANCHES
																	,DIMS.SALESMAN
																	,SIH.[Order No_] AS NO_SO
																	,MAX(SIH.[Posting Date]) AS TGL_INV
																	,SUM(GLE.[Amount]) AS AMOUNT
															FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
															LEFT JOIN	(
																			SELECT	DIM.DIM_ID
																					,MAX(DIM.BRANCHES) AS BRANCHES
																					,MAX(DIM.ITEM_CAT) AS ITEM_CAT
																					,MAX(DIM.SALESMAN) AS SALESMAN
																			FROM	(
																						SELECT [Dimension Set ID] AS DIM_ID
																							  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																							  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																							  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																						FROM [AUTOJAYA].[dbo].[SOLUSI$Dimension Set Entry]
																					) DIM
																			GROUP BY DIM.DIM_ID
																		) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
															LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
															WHERE GLE.[G_L Account No_] = '400.110.03'
																  AND GLE.[Document No_] NOT LIKE 'UM%'
																  AND GLE.[Posting Date] <=  (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime))
															GROUP BY DIMS.ITEM_CAT
																	,DIMS.BRANCHES
																	,DIMS.SALESMAN
																	,SIH.[Order No_]
														) INV ON INV.NO_SO = UM.NO_SO AND INV.BRANCHES = UM.BRANCHES AND INV.ITEM_CAT = UM.ITEM_CAT AND INV.SALESMAN = UM.SALESMAN
										) OUM
								WHERE OUM.AMOUNT > 0
							 ) ASCY
						GROUP BY ASCY.BRANCHES, ASCY.ITEM_CAT, ASCY.SALESMAN
						UNION ALL
						SELECT	'(+) Accured Sales Previous Year' AS NOTE
								,ASPY.BRANCHES
								,ASPY.ITEM_CAT
								,ASPY.SALESMAN
								, SUM(ASPY.AMOUNT_S1) AS AMOUNT_S1
								, SUM(ASPY.AMOUNT_S2) AS AMOUNT_S2
						FROM	(
									SELECT	OUM.ITEM_CAT
											,OUM.BRANCHES
											,OUM.SALESMAN
											,CASE WHEN DATEPART(quarter, OUM.TGL_INV) IN (1,2) THEN OUM.AMOUNT ELSE 0 END AS AMOUNT_S1
											,CASE WHEN DATEPART(quarter, OUM.TGL_INV) IN (3,4) THEN OUM.AMOUNT ELSE 0 END AS AMOUNT_S2
											,OUM.AMOUNT
									FROM	(
												SELECT	UM.ITEM_CAT
														, UM.BRANCHES
														, UM.SALESMAN
														, INV.TGL_INV
														, CASE WHEN ISNULL(INV.AMOUNT,0) =  0 THEN 0 ELSE
															CASE WHEN SUM(UM.AMOUNT)OVER(PARTITION BY UM.NO_SO, UM.BRANCHES, UM.ITEM_CAT, UM.SALESMAN  ORDER BY UM.TGL_UM) <= ISNULL(INV.AMOUNT,0) THEN
																UM.AMOUNT ELSE SUM(UM.AMOUNT)OVER(PARTITION BY UM.NO_SO, UM.BRANCHES, UM.ITEM_CAT, UM.SALESMAN ORDER BY UM.TGL_UM) - ISNULL(INV.AMOUNT,0)
															END
														  END AS AMOUNT
												FROM	(
															SELECT	DIMS.ITEM_CAT
																	,DIMS.BRANCHES
																	,CASE WHEN SIH.[No_] = 'UMST150023' THEN 'ARH' ELSE DIMS.SALESMAN END AS SALESMAN
																	,SIH.[Posting Date] AS TGL_UM
																	,SIH.[No_] AS NO_UM
																	,SIH.[External Document No_] AS NO_PO_CUST
																	,SIH.[Bill-to Customer No_] AS CUST_NO
																	,SIH.[Bill-to Name] AS CUST_NAME
																	,SIH.[Prepayment Order No_] AS NO_SO
																	, (SUM(GLE.[Amount]) * -1) AS AMOUNT
															FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
															LEFT JOIN	(
																			SELECT	DIM.DIM_ID
																					,MAX(DIM.BRANCHES) AS BRANCHES
																					,MAX(DIM.ITEM_CAT) AS ITEM_CAT
																					,MAX(DIM.SALESMAN) AS SALESMAN
																			FROM	(
																						SELECT [Dimension Set ID] AS DIM_ID
																							  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																							  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																							  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																						FROM [AUTOJAYA].[dbo].[SOLUSI$Dimension Set Entry]
																					) DIM
																			GROUP BY DIM.DIM_ID
																		) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
															LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
															LEFT JOIN	(
																			SELECT CLE.[Entry No_]
																					, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE.[Document No_] ELSE CLE2.[Document No_] END AS NO_UM
																					, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE2.[Document No_] ELSE CLE.[Document No_] END AS NO_CM
																			FROM [AUTOJAYA].[dbo].[SOLUSI$Cust_ Ledger Entry] CLE
																			LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Cust_ Ledger Entry] CLE2 ON CLE2.[Entry No_] = CLE.[Closed by Entry No_]
																			WHERE CLE.[Document Type] IN (2,3)
																			AND ((CLE.[Document No_]  LIKE 'UM%' AND CLE2.[Document Type] = 3) OR
																				(CLE2.[Document No_]  LIKE 'UM%' AND CLE.[Document Type] = 3) )
																		) CM ON CM.NO_UM = GLE.[Document No_]
															LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Cr_Memo Header] CMH ON CMH.[No_] = CM.NO_CM
															WHERE GLE.[G_L Account No_] = '400.110.03'
																  AND GLE.[Document No_] LIKE 'UM%'
																  AND CM.NO_CM IS NULL
																  AND (SIH.[Posting Date] < (CAST((CAST($P{Tahun} as varchar(4))+'-01-01') AS datetime)))
															GROUP BY DIMS.ITEM_CAT
																	 ,DIMS.BRANCHES
																	 ,DIMS.SALESMAN
																	 ,SIH.[Posting Date]
																	 ,SIH.[No_]
																	 ,SIH.[External Document No_]
																	 ,SIH.[Bill-to Customer No_]
																	 ,SIH.[Bill-to Name]
																	 ,SIH.[Prepayment Order No_]
														) UM
												LEFT JOIN	(
																SELECT	DIMS.ITEM_CAT
																		,DIMS.BRANCHES
																		,DIMS.SALESMAN
																		,SIH.[Order No_] AS NO_SO
																		,MAX(SIH.[Posting Date]) AS TGL_INV
																		,SUM(GLE.[Amount]) AS AMOUNT
																FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
																LEFT JOIN	(
																				SELECT	DIM.DIM_ID
																						,MAX(DIM.BRANCHES) AS BRANCHES
																						,MAX(DIM.ITEM_CAT) AS ITEM_CAT
																						,MAX(DIM.SALESMAN) AS SALESMAN
																				FROM	(
																							SELECT [Dimension Set ID] AS DIM_ID
																								  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																								  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																								  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																							FROM [AUTOJAYA].[dbo].[SOLUSI$Dimension Set Entry]
																						) DIM
																				GROUP BY DIM.DIM_ID
																			) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
																LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
																WHERE GLE.[G_L Account No_] = '400.110.03'
																	  AND GLE.[Document No_] NOT LIKE 'UM%'
																	  AND (GLE.[Posting Date] >= (CAST((CAST($P{Tahun} as varchar(4))+'-01-01') AS datetime)) AND GLE.[Posting Date] <= (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime)))
																GROUP BY DIMS.ITEM_CAT
																		,DIMS.BRANCHES
																		,DIMS.SALESMAN
																		,SIH.[Order No_]
															) INV ON INV.NO_SO = UM.NO_SO AND INV.BRANCHES = UM.BRANCHES AND INV.ITEM_CAT = UM.ITEM_CAT AND INV.SALESMAN = UM.SALESMAN
											) OUM
									WHERE OUM.AMOUNT > 0
								) ASPY
						GROUP BY ASPY.BRANCHES, ASPY.ITEM_CAT, ASPY.SALESMAN
						UNION ALL
						SELECT	'(+) Accured Sales Previous Semester' AS NOTE
								,ASPY.BRANCHES
								,ASPY.ITEM_CAT
								,ASPY.SALESMAN
								, 0 AS AMOUNT_S1
								, SUM(ASPY.AMOUNT) AS AMOUNT_S2
						FROM	(
									SELECT	OUM.ITEM_CAT
											,OUM.BRANCHES
											,OUM.SALESMAN
											,OUM.AMOUNT
									FROM	(
												SELECT	UM.ITEM_CAT
														, UM.BRANCHES
														, UM.SALESMAN
														, INV.TGL_INV
														, CASE WHEN ISNULL(INV.AMOUNT,0) =  0 THEN 0 ELSE
															CASE WHEN SUM(UM.AMOUNT)OVER(PARTITION BY UM.NO_SO, UM.BRANCHES, UM.ITEM_CAT, UM.SALESMAN  ORDER BY UM.TGL_UM) <= ISNULL(INV.AMOUNT,0) THEN
																UM.AMOUNT ELSE SUM(UM.AMOUNT)OVER(PARTITION BY UM.NO_SO, UM.BRANCHES, UM.ITEM_CAT, UM.SALESMAN ORDER BY UM.TGL_UM) - ISNULL(INV.AMOUNT,0)
															END
														  END AS AMOUNT
												FROM	(
															SELECT	DIMS.ITEM_CAT
																	,DIMS.BRANCHES
																	,CASE WHEN SIH.[No_] = 'UMST150023' THEN 'ARH' ELSE DIMS.SALESMAN END AS SALESMAN
																	,SIH.[Posting Date] AS TGL_UM
																	,SIH.[No_] AS NO_UM
																	,SIH.[External Document No_] AS NO_PO_CUST
																	,SIH.[Bill-to Customer No_] AS CUST_NO
																	,SIH.[Bill-to Name] AS CUST_NAME
																	,SIH.[Prepayment Order No_] AS NO_SO
																	, (SUM(GLE.[Amount]) * -1) AS AMOUNT
															FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
															LEFT JOIN	(
																			SELECT	DIM.DIM_ID
																					,MAX(DIM.BRANCHES) AS BRANCHES
																					,MAX(DIM.ITEM_CAT) AS ITEM_CAT
																					,MAX(DIM.SALESMAN) AS SALESMAN
																			FROM	(
																						SELECT [Dimension Set ID] AS DIM_ID
																							  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																							  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																							  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																						FROM [AUTOJAYA].[dbo].[SOLUSI$Dimension Set Entry]
																					) DIM
																			GROUP BY DIM.DIM_ID
																		) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
															LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
															LEFT JOIN	(
																			SELECT CLE.[Entry No_]
																					, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE.[Document No_] ELSE CLE2.[Document No_] END AS NO_UM
																					, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE2.[Document No_] ELSE CLE.[Document No_] END AS NO_CM
																			FROM [AUTOJAYA].[dbo].[SOLUSI$Cust_ Ledger Entry] CLE
																			LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Cust_ Ledger Entry] CLE2 ON CLE2.[Entry No_] = CLE.[Closed by Entry No_]
																			WHERE CLE.[Document Type] IN (2,3)
																			AND ((CLE.[Document No_]  LIKE 'UM%' AND CLE2.[Document Type] = 3) OR
																				(CLE2.[Document No_]  LIKE 'UM%' AND CLE.[Document Type] = 3) )
																		) CM ON CM.NO_UM = GLE.[Document No_]
															LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Cr_Memo Header] CMH ON CMH.[No_] = CM.NO_CM
															WHERE GLE.[G_L Account No_] = '400.110.03'
																  AND GLE.[Document No_] LIKE 'UM%'
																  AND (CM.NO_CM IS NULL OR (CM.NO_CM IS NOT NULL AND CMH.[Posting Date] > (CAST((CAST($P{Tahun} as varchar(4))+'-06-30') AS datetime)) ))
															      AND (SIH.[Posting Date] >= (CAST((CAST($P{Tahun} as varchar(4))+'-01-01') AS datetime)) AND SIH.[Posting Date]<= (CAST((CAST($P{Tahun} as varchar(4))+'-06-30') AS datetime)))
															GROUP BY DIMS.ITEM_CAT
																	 ,DIMS.BRANCHES
																	 ,DIMS.SALESMAN
																	 ,SIH.[Posting Date]
																	 ,SIH.[No_]
																	 ,SIH.[External Document No_]
																	 ,SIH.[Bill-to Customer No_]
																	 ,SIH.[Bill-to Name]
																	 ,SIH.[Prepayment Order No_]
														) UM
												LEFT JOIN	(
																SELECT	DIMS.ITEM_CAT
																		,DIMS.BRANCHES
																		,DIMS.SALESMAN
																		,SIH.[Order No_] AS NO_SO
																		,MAX(SIH.[Posting Date]) AS TGL_INV
																		,SUM(GLE.[Amount]) AS AMOUNT
																FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
																LEFT JOIN	(
																				SELECT	DIM.DIM_ID
																						,MAX(DIM.BRANCHES) AS BRANCHES
																						,MAX(DIM.ITEM_CAT) AS ITEM_CAT
																						,MAX(DIM.SALESMAN) AS SALESMAN
																				FROM	(
																							SELECT [Dimension Set ID] AS DIM_ID
																								  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																								  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																								  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																							FROM [AUTOJAYA].[dbo].[SOLUSI$Dimension Set Entry]
																						) DIM
																				GROUP BY DIM.DIM_ID
																			) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
																LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
																WHERE GLE.[G_L Account No_] = '400.110.03'
																	  AND GLE.[Document No_] NOT LIKE 'UM%'
																	  AND (GLE.[Posting Date] >= (CAST((CAST($P{Tahun} as varchar(4))+'-07-01') AS datetime)) AND GLE.[Posting Date] <= (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime)))
																GROUP BY DIMS.ITEM_CAT
																		,DIMS.BRANCHES
																		,DIMS.SALESMAN
																		,SIH.[Order No_]
															) INV ON INV.NO_SO = UM.NO_SO AND INV.BRANCHES = UM.BRANCHES AND INV.ITEM_CAT = UM.ITEM_CAT AND INV.SALESMAN = UM.SALESMAN
											) OUM
									WHERE OUM.AMOUNT > 0
								) ASPY
						GROUP BY ASPY.BRANCHES, ASPY.ITEM_CAT, ASPY.SALESMAN
						UNION ALL
						SELECT	'(-/+) Others Management Adjustment - ALL' AS NOTE
								,DIMS.BRANCHES
								,DIMS.ITEM_CAT
								,DIMS.SALESMAN
								, SUM(CASE WHEN DATEPART(quarter, GLE.[Posting Date]) IN (1,2) THEN GLE.[Amount] ELSE 0 END) * -1 AS AMOUNT_S1
								, SUM(CASE WHEN DATEPART(quarter, GLE.[Posting Date]) IN (3,4) THEN GLE.[Amount] ELSE 0 END) * -1 AS AMOUNT_S2
						FROM [AUTOJAYA].[dbo].[SP-ADJ$G_L Entry] GLE
						LEFT JOIN	(
										SELECT	DIM.DIM_ID
												,MAX(DIM.BRANCHES) AS BRANCHES
												,MAX(DIM.ITEM_CAT) AS ITEM_CAT
												,MAX(DIM.SALESMAN) AS SALESMAN
										FROM	(
													SELECT [Dimension Set ID] AS DIM_ID
														  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
														  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
														  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
													FROM [AUTOJAYA].[dbo].[SP-ADJ$Dimension Set Entry]
												) DIM
										GROUP BY DIM.DIM_ID
									) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
						WHERE	(GLE.[G_L Account No_] BETWEEN '400.110.00'  AND '420.110.01') AND
								GLE.[G_L Account No_] <> '400.110.04' AND
								DIMS.ITEM_CAT <> '' AND
								(GLE.[Posting Date] >= (CAST((CAST($P{Tahun} as varchar(4))+'-01-01') AS datetime)) AND GLE.[Posting Date] <= (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime)))
						GROUP BY DIMS.BRANCHES, DIMS.ITEM_CAT, DIMS.SALESMAN
						UNION ALL
						SELECT	'(-/+) Others Management Adjustment - SALES LAINNYA' AS NOTE
								,'10' BRANCHES
								,'HW01' AS ITEM_CAT
								,'OFC' AS SALESMAN
								, SUM(CASE WHEN DATEPART(quarter, GLE.[Posting Date]) IN (1,2) THEN GLE.[Amount] ELSE 0 END) * -1 AS AMOUNT_S1
								, SUM(CASE WHEN DATEPART(quarter, GLE.[Posting Date]) IN (3,4) THEN GLE.[Amount] ELSE 0 END) * -1 AS AMOUNT_S2
						FROM [AUTOJAYA].[dbo].[SP-ADJ$G_L Entry] GLE
						LEFT JOIN	(
										SELECT	DIM.DIM_ID
												,MAX(DIM.BRANCHES) AS BRANCHES
												,MAX(DIM.ITEM_CAT) AS ITEM_CAT
												,MAX(DIM.SALESMAN) AS SALESMAN
										FROM	(
													SELECT [Dimension Set ID] AS DIM_ID
														  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
														  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
														  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
													FROM [AUTOJAYA].[dbo].[SP-ADJ$Dimension Set Entry]
												) DIM
										GROUP BY DIM.DIM_ID
									) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
						WHERE	GLE.[G_L Account No_] = '400.110.04' AND
								(GLE.[Posting Date] >= (CAST((CAST($P{Tahun} as varchar(4))+'-01-01') AS datetime)) AND GLE.[Posting Date] <= (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime)))
						UNION ALL
						SELECT	'SALES CORRECTION - FA/INTERCOY' AS NOTE
								, SLC.BRANCHES
								, SLC.ITEM_CAT
								, SLC.SALESMAN
								, SUM(SLC.AMOUNT_S1) AS AMOUNT_S1
								, SUM(SLC.AMOUNT_S2) AS AMOUNT_S2
						FROM	(
									SELECT	CASE WHEN GLE.[Source No_] <> 'SOPE001' THEN '2. Sales INTERCOY' ELSE '1. Sales FA' END AS SALES_TITLE
											,CASE WHEN GLE.[Source No_] <> 'SOPE001' THEN '(-) Sales INTERCOY' ELSE '(-) Sales FA' END AS SALES_TITLE2
											,CASE WHEN GLE.[Source No_] <> 'SOPE001' THEN 'SLS-0302' ELSE 'SLS-0301' END AS SORT_SLS
											, DIMS.BRANCHES
											, DIMS.ITEM_CAT
											, DIMS.SALESMAN
											, CASE WHEN DATEPART(quarter, GLE.[Posting Date]) IN (1,2) THEN GLE.[Amount] ELSE 0 END AS AMOUNT_S1
											, CASE WHEN DATEPART(quarter, GLE.[Posting Date]) IN (3,4) THEN GLE.[Amount] ELSE 0 END AS AMOUNT_S2
									FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
									LEFT JOIN	(
													SELECT	DIM.DIM_ID
															,MAX(DIM.BRANCHES) AS BRANCHES
															,MAX(DIM.ITEM_CAT) AS ITEM_CAT
															,MAX(DIM.SALESMAN) AS SALESMAN
													FROM	(
																SELECT [Dimension Set ID] AS DIM_ID
																	  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																	  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																	  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																FROM [AUTOJAYA].[dbo].[SOLUSI$Dimension Set Entry]
															) DIM
													GROUP BY DIM.DIM_ID
												) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
									WHERE GLE.[G_L Account No_] IN ('400.110.01', '410.110.01', '420.110.01')
											AND (GLE.[Posting Date] >= (CAST((CAST($P{Tahun} as varchar(4))+'-01-01') AS datetime)) AND GLE.[Posting Date] <= (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime)))
								) SLC
						GROUP BY SLC.BRANCHES, SLC.ITEM_CAT, SLC.SALESMAN
						UNION ALL
						SELECT	'SALES CORRECTION - FA/INTERCOY ADJ' AS NOTE
								, SLC.BRANCHES
								, SLC.ITEM_CAT
								, SLC.SALESMAN
								, SUM(SLC.AMOUNT_S1) AS AMOUNT_S1
								, SUM(SLC.AMOUNT_S2) AS AMOUNT_S2
						FROM	(
									SELECT	'3. Others Sales Adjustment' AS SALES_TITLE
											,'(-/+) Others Management Adjustment' AS SALES_TITLE2
											,'SLS-0303' AS SORT_SLS
											, DIMS.BRANCHES
											, DIMS.ITEM_CAT
											, DIMS.SALESMAN
											, CASE WHEN DATEPART(quarter, GLE.[Posting Date]) IN (1,2) THEN GLE.[Amount] ELSE 0 END AS AMOUNT_S1
											, CASE WHEN DATEPART(quarter, GLE.[Posting Date]) IN (3,4) THEN GLE.[Amount] ELSE 0 END AS AMOUNT_S2
									FROM [AUTOJAYA].[dbo].[SP-ADJ$G_L Entry] GLE
									LEFT JOIN	(
													SELECT	DIM.DIM_ID
															,MAX(DIM.BRANCHES) AS BRANCHES
															,MAX(DIM.ITEM_CAT) AS ITEM_CAT
															,MAX(DIM.SALESMAN) AS SALESMAN
													FROM	(
																SELECT [Dimension Set ID] AS DIM_ID
																	  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																	  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																	  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																FROM [AUTOJAYA].[dbo].[SP-ADJ$Dimension Set Entry]
															) DIM
													GROUP BY DIM.DIM_ID
												) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
									WHERE GLE.[G_L Account No_] IN ('400.110.01', '410.110.01', '420.110.01')
											AND GLE.[Posting Date] >= (CAST((CAST($P{Tahun} as varchar(4))+'-01-01') AS datetime)) AND GLE.[Posting Date] <=  (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime))
								) SLC
						GROUP BY SLC.BRANCHES, SLC.ITEM_CAT, SLC.SALESMAN
					) X
		) XX
UNION ALL
SELECT	1 AS MAIN_GRP
		,1 AS GROUP_NO
		,('SALES REVENUE ') AS GROUP_DESC
		,2 AS SUBGROUP_NO
		,'Down Payment' AS SUBGROUP_DESC
		,(ROUND((SUM(XX2.AMOUNT_S1)/1000000),2) + ROUND((SUM(XX2.AMOUNT_S2)/1000000),2)) AS AMOUNT
		,ROUND((SUM(XX2.AMOUNT_S1)/1000000),2) AS AMOUNT_S1
		,ROUND((SUM(XX2.AMOUNT_S2)/1000000),2) AS AMOUNT_S2
		,'' AS SALES_CODE
		,'' AS BRANCHES
		,'' AS SPV_BY
FROM	(
			SELECT	1 AS GROUP_NO
					,'Uang Muka (as per Today)' AS GROUP_DESC
					, OSO.BRANCHES
					,	CASE WHEN OSO.SALESMAN IN ('OFC', 'OFF3') THEN
							CASE WHEN OSO.BRANCHES = '19' THEN 'OFD'
								 WHEN OSO.BRANCHES = '17' THEN 'OFG'
								 WHEN OSO.BRANCHES = '16' THEN 'OFK'
								 WHEN OSO.BRANCHES = '15' THEN 'OFS'
								 ELSE OSO.SALESMAN END
						ELSE
							OSO.SALESMAN
						END AS SALESMAN
					,	CASE WHEN $P{Tahun} <> DATEPART(year, GETDATE()) THEN
							0
						ELSE
							(CASE WHEN DATEPART(quarter, GETDATE()) IN (1,2) THEN SUM(OSO.AMOUNT) ELSE 0 END)
						END AS AMOUNT_S1
					,	CASE WHEN $P{Tahun} <> DATEPART(year, GETDATE()) THEN
							0
						ELSE
							(CASE WHEN DATEPART(quarter, GETDATE()) IN (3,4) THEN SUM(OSO.AMOUNT) ELSE 0 END)
						END AS AMOUNT_S2
			FROM	(
						SELECT	'OS1' AS GROUP_ITEM_CAT
								,'Uang Muka' AS ITEM_CAT
								,UMX.BRANCHES
								,UMX.SALESMAN
								,(SUM(UMX.AMOUNT)*-1) AS AMOUNT
						FROM	(
									SELECT	DIMS.BRANCHES
											,DIMS.SALESMAN
											,(SUM(GLE.[Amount]) * -1 )AS AMOUNT
									FROM [AUTOJAYA].[dbo].[AJ-ADJ$G_L Entry] GLE
									LEFT JOIN	(
													SELECT	DIM.DIM_ID
															,MAX(DIM.BRANCHES) AS BRANCHES
															,MAX(DIM.ITEM_CAT) AS ITEM_CAT
															,MAX(DIM.SALESMAN) AS SALESMAN
													FROM	(
																SELECT [Dimension Set ID] AS DIM_ID
																	  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																	  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																	  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																FROM [AUTOJAYA].[dbo].[AJ-ADJ$Dimension Set Entry]
															) DIM
													GROUP BY DIM.DIM_ID
												) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
									WHERE	GLE.[G_L Account No_] = '400.110.00' AND
											GLE.[Source Code] <> 'CLSINCOME' AND
											GLE.[Document No_] NOT LIKE 'OBAL-CLOSE%' AND
											GLE.[Document No_] NOT LIKE 'JV-SNUM%' AND
											GLE.[Posting Date] <=  (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime))
									GROUP BY DIMS.BRANCHES, DIMS.SALESMAN
									UNION ALL
									SELECT	DIMS.BRANCHES
											,DIMS.SALESMAN
											,(SUM(GLE.[Amount]) * -1) AS AMOUNT
									FROM [AUTOJAYA].[dbo].[SP-ADJ$G_L Entry] GLE
									LEFT JOIN	(
													SELECT	DIM.DIM_ID
															,MAX(DIM.BRANCHES) AS BRANCHES
															,MAX(DIM.ITEM_CAT) AS ITEM_CAT
															,MAX(DIM.SALESMAN) AS SALESMAN
													FROM	(
																SELECT [Dimension Set ID] AS DIM_ID
																	  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																	  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																	  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																FROM [AUTOJAYA].[dbo].[SP-ADJ$Dimension Set Entry]
															) DIM
													GROUP BY DIM.DIM_ID
												) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
									WHERE	GLE.[G_L Account No_] = '400.110.00' AND
											GLE.[Source Code] <> 'CLSINCOME' AND
											GLE.[Document No_] NOT LIKE 'OBAL-CLOSE%' AND
											GLE.[Document No_] NOT LIKE 'JV-SNUM%' AND
											GLE.[Posting Date] <=  (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime))
									GROUP BY DIMS.BRANCHES,DIMS.SALESMAN
								) UMX
						GROUP BY UMX.BRANCHES,UMX.SALESMAN
						UNION ALL
						SELECT	'OS1' AS GROUP_ITEM_CAT
								,'Uang Muka' AS ITEM_CAT
								, XXX.BRANCHES
								, XXX.SALES_CODE AS SALESMAN
								, XXX.AMOUNT_UM_IDR AS AMOUNT
						FROM	(
									SELECT	'AUTOJAYA' AS COMPANY
											, XY.BRANCHES
											, XY.SALES_CODE
											, XY.CUST_CODE
											, XY.ORDER_DATE
											, XY.STATUS_SO
											, XY.NO_PO_CUST
											, XY.REV_YEAR
											, CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
												(XY.AMOUNT_IDR - XY.UM_AMOUNT_IDR)
												ELSE
												(XY.AMOUNT_IDR - ((XY.UM_AMOUNT_IDR*XY.AMOUNT_IDR)/(XY.AMOUNT_IDR_TTL)))
												END AS AMOUNT_IDR
											, CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
												(XY.UM_AMOUNT_IDR)
												ELSE
												(((XY.UM_AMOUNT_IDR*XY.AMOUNT_IDR)/(XY.AMOUNT_IDR_TTL)))
												END AS AMOUNT_UM_IDR
											, CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
												(XY.AMOUNT - XY.UM_AMOUNT)
												ELSE
												(XY.AMOUNT - ((XY.UM_AMOUNT*XY.AMOUNT) /(XY.AMOUNT_TTL)))
												END AS AMOUNT
									FROM	(
												SELECT SH.[No_] AS NO_SO
														, SUBSTRING( SH.[No_], 1, 4) AS TIPE
														, CASE WHEN SH.[Shortcut Dimension 1 Code] = '' THEN '10' ELSE ISNULL(SH.[Shortcut Dimension 1 Code],'10') END AS BRANCHES
														, CASE WHEN SH.[Salesperson Code] = '' THEN '.' ELSE SH.[Salesperson Code] END AS SALES_CODE
														, SH.[Bill-to Customer No_] AS CUST_CODE
														, SH.[Order Date] AS ORDER_DATE
														, CASE	WHEN SH.[Status] = 0 THEN 'OPEN'
																WHEN SH.[Status] = 1 THEN 'RELEASED'
																WHEN SH.[Status] = 2 THEN 'PENDING APPROVAL'
																WHEN SH.[Status] = 3 THEN 'RELEASED'
																ELSE '' END AS STATUS_SO
														, SH.[External Document No_] AS NO_PO_CUST
														, ISNULL(CASE WHEN SH.[Currency Code] <> '' THEN ROUND(SL.AMOUNT / SH.[Currency Factor],0) ELSE SL.AMOUNT END,0) AS AMOUNT_IDR
														, ISNULL(SL.AMOUNT,0) AS AMOUNT
														, ISNULL(CASE WHEN SH.[Currency Code] <> '' THEN ROUND(SL2.AMOUNT_TTL / SH.[Currency Factor],0) ELSE SL2.AMOUNT_TTL END,0) AS AMOUNT_IDR_TTL
														, ISNULL(SL2.AMOUNT_TTL,0) AS AMOUNT_TTL
														, ISNULL(UM.UM_AMOUNT_IDR,0) AS UM_AMOUNT_IDR
														, ISNULL(UM.UM_AMOUNT,0) AS UM_AMOUNT
														, SH.[Package Tracking No_] AS REV_YEAR
												FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Header] SH
												LEFT JOIN  (	SELECT X.[Document No_]
																	,SUM(X.QTY) AS QTY
																	,SUM(X.QTY_INV)AS QTY_INV
																	,SUM(X.AMOUNT) AS AMOUNT
																FROM (
																		SELECT [Document No_]
																				, [Quantity] AS QTY
																				, [Quantity Invoiced] AS QTY_INV
																				, CASE WHEN [Quantity Invoiced] <> 0 AND [Quantity] <> [Quantity Invoiced] THEN
																					([Amount] / [Quantity]) * ([Quantity] - [Quantity Invoiced])
																				  ELSE
																					[Amount]
																				  END AS AMOUNT
																		FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Line]
																		WHERE [Document Type] = 1 AND
																		 [Quantity] <> [Quantity Invoiced]
																	) X
																GROUP BY X.[Document No_]
															)SL ON SL.[Document No_] = SH.[No_]
												LEFT JOIN  (
																SELECT [Document No_]
																	 , SUM([Amount]) AS AMOUNT_TTL
																		FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Line]
																		WHERE [Document Type] = 1
																GROUP BY [Document No_]
															)SL2 ON SL2.[Document No_] = SH.[No_]
												LEFT JOIN	(
																SELECT Y.NO_SO
																		,SUM(Y.UM_AMOUNT) AS UM_AMOUNT
																		,SUM(Y.UM_AMOUNT_IDR) AS UM_AMOUNT_IDR
																FROM (
																		SELECT [Prepayment Order No_] AS NO_SO
																			  ,SUM(UMD.[Amount]) AS UM_AMOUNT
																			  ,CASE WHEN UMH.[Currency Code] <> '' THEN ROUND(SUM(UMD.[Amount]) / UMH.[Currency Factor],0) ELSE SUM(UMD.[Amount]) END AS UM_AMOUNT_IDR

																		FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] UMH
																		INNER JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Line] UMD ON UMH.[No_] = UMD.[Document No_]
																		GROUP BY UMH.[Prepayment Order No_], UMH.[Currency Code], UMH.[Currency Factor]
																		UNION ALL
																		SELECT [Prepayment Order No_] AS NO_SO
																			  ,SUM(UMD.[Amount]) * -1 AS UM_AMOUNT
																			  ,CASE WHEN UMH.[Currency Code] <> '' THEN ROUND(SUM(UMD.[Amount]) / UMH.[Currency Factor],0) ELSE SUM(UMD.[Amount]) * -1 END AS UM_AMOUNT_IDR

																		FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Cr_Memo Header] UMH
																		INNER JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Cr_Memo Line] UMD ON UMH.[No_] = UMD.[Document No_]
																		GROUP BY UMH.[Prepayment Order No_], UMH.[Currency Code], UMH.[Currency Factor]
																	) Y
																GROUP BY Y.NO_SO
															) UM ON UM.NO_SO = SH.[No_]
												WHERE SH.[Document Type] = 1
											) XY
									WHERE	(	(XY.TIPE <> 'SOAR') OR
												(SUBSTRING(CONVERT(varchar, XY.ORDER_DATE, 105), 7,4) <= SUBSTRING(CONVERT(varchar, (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime)), 105), 7,4) AND XY.TIPE = 'SOAR'))  AND
												(XY.REV_YEAR = '' OR XY.REV_YEAR = SUBSTRING(CONVERT(varchar, (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime)), 105), 7,4)) AND
												(XY.STATUS_SO = 'RELEASED')
									UNION ALL
									SELECT	'SOLUSI' AS COMPANY
											, XY.BRANCHES
											, XY.SALES_CODE
											, XY.CUST_CODE
											, XY.ORDER_DATE
											, XY.STATUS_SO
											, XY.NO_PO_CUST
											, XY.REV_YEAR
											, CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
												(XY.AMOUNT_IDR - XY.UM_AMOUNT_IDR)
												ELSE
												(XY.AMOUNT_IDR - ((XY.UM_AMOUNT_IDR*XY.AMOUNT_IDR)/(XY.AMOUNT_IDR_TTL)))
												END AS AMOUNT_IDR
											, CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
												(XY.UM_AMOUNT_IDR)
												ELSE
												(((XY.UM_AMOUNT_IDR*XY.AMOUNT_IDR)/(XY.AMOUNT_IDR_TTL)))
												END AS AMOUNT_UM_IDR
											, CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
												(XY.AMOUNT - XY.UM_AMOUNT)
												ELSE
												(XY.AMOUNT - ((XY.UM_AMOUNT*XY.AMOUNT) /(XY.AMOUNT_TTL)))
												END AS AMOUNT
									FROM	(
												SELECT SH.[No_] AS NO_SO
														, SUBSTRING( SH.[No_], 1, 4) AS TIPE
														, CASE WHEN SH.[Shortcut Dimension 1 Code] = '' THEN '10' ELSE ISNULL(SH.[Shortcut Dimension 1 Code],'10') END AS BRANCHES
														, CASE WHEN SH.[Salesperson Code] = '' THEN '.' ELSE SH.[Salesperson Code] END AS SALES_CODE
														, SH.[Bill-to Customer No_] AS CUST_CODE
														, SH.[Order Date] AS ORDER_DATE
														, CASE	WHEN SH.[Status] = 0 THEN 'OPEN'
																WHEN SH.[Status] = 1 THEN 'RELEASED'
																WHEN SH.[Status] = 2 THEN 'PENDING APPROVAL'
																WHEN SH.[Status] = 3 THEN 'RELEASED'
																ELSE '' END AS STATUS_SO
														, SH.[External Document No_] AS NO_PO_CUST
														, ISNULL(CASE WHEN SH.[Currency Code] <> '' THEN ROUND(SL.AMOUNT / SH.[Currency Factor],0) ELSE SL.AMOUNT END,0) AS AMOUNT_IDR
														, ISNULL(SL.AMOUNT,0) AS AMOUNT
														, ISNULL(CASE WHEN SH.[Currency Code] <> '' THEN ROUND(SL2.AMOUNT_TTL / SH.[Currency Factor],0) ELSE SL2.AMOUNT_TTL END,0) AS AMOUNT_IDR_TTL
														, ISNULL(SL2.AMOUNT_TTL,0) AS AMOUNT_TTL
														, ISNULL(UM.UM_AMOUNT_IDR,0) AS UM_AMOUNT_IDR
														, ISNULL(UM.UM_AMOUNT,0) AS UM_AMOUNT
														, SH.[Package Tracking No_] AS REV_YEAR
												FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Header] SH
												INNER JOIN  (	SELECT X.[Document No_]
																	,SUM(X.QTY) AS QTY
																	,SUM(X.QTY_INV)AS QTY_INV
																	,SUM(X.AMOUNT) AS AMOUNT
																FROM (
																		SELECT [Document No_]
																				, [Quantity] AS QTY
																				, [Quantity Invoiced] AS QTY_INV
																				, CASE WHEN [Quantity Invoiced] <> 0 AND [Quantity] <> [Quantity Invoiced] THEN
																					([Amount] / [Quantity]) * ([Quantity] - [Quantity Invoiced])
																				  ELSE
																					[Amount]
																				  END AS AMOUNT
																		FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Line]
																		WHERE [Document Type] = 1 AND
																		 [Quantity] <> [Quantity Invoiced]
																	) X
																GROUP BY X.[Document No_]
															)SL ON SL.[Document No_] = SH.[No_]
												LEFT JOIN  (
																SELECT [Document No_]
																	 , SUM([Amount]) AS AMOUNT_TTL
																		FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Line]
																		WHERE [Document Type] = 1
																GROUP BY [Document No_]
															)SL2 ON SL2.[Document No_] = SH.[No_]
												LEFT JOIN	(
																SELECT Y.NO_SO
																		,SUM(Y.UM_AMOUNT) AS UM_AMOUNT
																		,SUM(Y.UM_AMOUNT_IDR) AS UM_AMOUNT_IDR
																FROM (
																		SELECT [Prepayment Order No_] AS NO_SO
																			  ,SUM(UMD.[Amount]) AS UM_AMOUNT
																			  ,CASE WHEN UMH.[Currency Code] <> '' THEN ROUND(SUM(UMD.[Amount]) / UMH.[Currency Factor],0) ELSE SUM(UMD.[Amount]) END AS UM_AMOUNT_IDR

																		FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] UMH
																		INNER JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Line] UMD ON UMH.[No_] = UMD.[Document No_]
																		GROUP BY UMH.[Prepayment Order No_], UMH.[Currency Code], UMH.[Currency Factor]
																		UNION ALL
																		SELECT [Prepayment Order No_] AS NO_SO
																			  ,SUM(UMD.[Amount]) * -1 AS UM_AMOUNT
																			  ,CASE WHEN UMH.[Currency Code] <> '' THEN ROUND(SUM(UMD.[Amount]) / UMH.[Currency Factor],0) ELSE SUM(UMD.[Amount]) * -1 END AS UM_AMOUNT_IDR

																		FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Cr_Memo Header] UMH
																		INNER JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Cr_Memo Line] UMD ON UMH.[No_] = UMD.[Document No_]
																		GROUP BY UMH.[Prepayment Order No_], UMH.[Currency Code], UMH.[Currency Factor]
																	) Y
																GROUP BY Y.NO_SO
															) UM ON UM.NO_SO = SH.[No_]
												WHERE SH.[Document Type] = 1
											) XY
									WHERE	(	(XY.TIPE <> 'SOSR') OR
												(SUBSTRING(CONVERT(varchar, XY.ORDER_DATE, 105), 7,4) <= SUBSTRING(CONVERT(varchar, (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime)), 105), 7,4) AND XY.TIPE = 'SOSR'))  AND
												(XY.REV_YEAR = '' OR XY.REV_YEAR = SUBSTRING(CONVERT(varchar, (CAST((CAST($P{Tahun} as varchar(4))+'-12-31') AS datetime)), 105), 7,4)) AND
												(XY.STATUS_SO = 'RELEASED')
								) XXX
						WHERE	XXX.NO_PO_CUST NOT LIKE '%OTP%' AND XXX.NO_PO_CUST NOT LIKE 'BOOKING%'
								AND XXX.CUST_CODE NOT IN ('AUJA001' , 'AUJA002', 'SOPE001')
					) OSO
			GROUP BY OSO.BRANCHES, OSO.SALESMAN
		)XX2
UNION ALL
SELECT	1 AS MAIN_GRP
		,1 AS GROUP_NO
		,('SALES REVENUE ') AS GROUP_DESC
		,3 AS SUBGROUP_NO
		,'Outstanding SO' AS SUBGROUP_DESC
		,(ROUND((SUM(OSO.AMOUNT_S1)/1000000),2)+ROUND((SUM(OSO.AMOUNT_S2)/1000000),2)) AS AMOUNT
		, ROUND((SUM(OSO.AMOUNT_S1)/1000000),2) AS AMOUNT_S1
		, ROUND((SUM(OSO.AMOUNT_S2)/1000000),2) AS AMOUNT_S2
		,'' AS SALES_CODE
		,'' AS BRANCHES
		,'' AS SPV_BY
FROM	(
			SELECT	XXX.BRANCHES
					, XXX.SALESMAN
					,	CASE WHEN $P{Tahun} < DATEPART(year, GETDATE()) THEN
							0
						ELSE
							CASE WHEN $P{Tahun} = DATEPART(year, GETDATE()) THEN
								CASE WHEN  XXX.SEMESTER = 'S1' THEN XXX.AMOUNT_IDR ELSE 0 END
							ELSE
								CASE WHEN  XXX.SEMESTER = 'S1' THEN XXX.AMOUNT_IDR ELSE 0 END
							END
						END AMOUNT_S1
					,	CASE WHEN $P{Tahun} < DATEPART(year, GETDATE()) THEN
							0
						ELSE
							CASE WHEN $P{Tahun} = DATEPART(year, GETDATE()) THEN
								CASE WHEN  XXX.SEMESTER = 'S2' THEN XXX.AMOUNT_IDR ELSE 0 END
							ELSE
								CASE WHEN  XXX.SEMESTER = 'S2' THEN XXX.AMOUNT_IDR ELSE 0 END
							END
						END AMOUNT_S2
			FROM	(
						SELECT	'AUTOJAYA' AS COMPANY
								, XY.NO_SO
								, XY.TIPE
								, XY.BRANCHES
								, XY.SALES_CODE AS SALESMAN
								, XY.CUST_CODE
								, XY.ORDER_DATE
								, XY.STATUS_SO
								, XY.NO_PO_CUST
								, XY.SO_YEAR
								, XY.SO_Q
								, XY.REV_YEAR
								, XY.REV_SEM
								, CASE WHEN XY.TIPE_2 = 'SOAR' THEN
									CASE WHEN XY.SO_Q IN (1,2) THEN 'S1' ELSE 'S2' END
								  ELSE
									CASE WHEN XY.REV_SEM = '' OR  XY.REV_SEM NOT IN ('S1', 'S2') THEN
										CASE WHEN $P{Tahun} <= DATEPART(year, GETDATE()) THEN
											CASE WHEN DATEPART(quarter, GETDATE()) IN (1,2) THEN 'S1' ELSE 'S2' END
										ELSE
											'S1'
										END
									ELSE
										XY.REV_SEM
									END
								  END AS SEMESTER
								, CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
									(XY.AMOUNT_IDR - XY.UM_AMOUNT_IDR)
									ELSE
										(XY.AMOUNT_IDR - ((XY.UM_AMOUNT_IDR*XY.AMOUNT_IDR)/(XY.AMOUNT_IDR_TTL)))
									END AS AMOUNT_IDR
								, CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
									(XY.AMOUNT - XY.UM_AMOUNT)
									ELSE
									(XY.AMOUNT - ((XY.UM_AMOUNT*XY.AMOUNT) /(XY.AMOUNT_TTL)))
									END AS AMOUNT
						FROM	(
									SELECT SH.[No_] AS NO_SO
											, CASE WHEN SUBSTRING( SH.[No_], 1, 4) = 'SOAS' THEN 'SC' ELSE
												CASE WHEN SUBSTRING( SH.[No_], 1, 2) IN ('8S','9S') THEN 'AI' ELSE
													CASE WHEN SUBSTRING( SH.[No_], 1, 2) IN ('7S') THEN 'LZ' ELSE 'TD' END
												END
											  END AS TIPE
											, SUBSTRING( SH.[No_], 1, 4) AS TIPE_2
											, CASE WHEN SH.[Location Code] = '' THEN 'HO-TD' ELSE SH.[Location Code] END AS LOC_CODE
											, CASE WHEN SH.[Shortcut Dimension 1 Code] = '' THEN '10' ELSE ISNULL(SH.[Shortcut Dimension 1 Code],'10') END AS BRANCHES
											, CASE WHEN SH.[Salesperson Code] = '' THEN '.' ELSE SH.[Salesperson Code] END AS SALES_CODE
											, SH.[Bill-to Customer No_] AS CUST_CODE
											, SH.[Order Date] AS ORDER_DATE
											, DATEPART(quarter, SH.[Order Date]) AS SO_Q
											, SUBSTRING(CONVERT(varchar, SH.[Order Date], 105), 7,4) AS SO_YEAR
											, CASE	WHEN SH.[Status] = 0 THEN 'OPEN'
													WHEN SH.[Status] = 1 THEN 'RELEASED'
													WHEN SH.[Status] = 2 THEN 'PENDING APPROVAL'
													WHEN SH.[Status] = 3 THEN 'RELEASED'
													ELSE '' END AS STATUS_SO
											, SH.[External Document No_] AS NO_PO_CUST
											, ISNULL(CASE WHEN SH.[Currency Code] <> '' THEN ROUND(SL.AMOUNT / SH.[Currency Factor],0) ELSE SL.AMOUNT END,0) AS AMOUNT_IDR
											, ISNULL(SL.AMOUNT,0) AS AMOUNT
											, ISNULL(CASE WHEN SH.[Currency Code] <> '' THEN ROUND(SL2.AMOUNT_TTL / SH.[Currency Factor],0) ELSE SL2.AMOUNT_TTL END,0) AS AMOUNT_IDR_TTL
											, ISNULL(SL2.AMOUNT_TTL,0) AS AMOUNT_TTL
											, ISNULL(UM.UM_AMOUNT_IDR,0) AS UM_AMOUNT_IDR
											, ISNULL(UM.UM_AMOUNT,0) AS UM_AMOUNT
											, SUBSTRING(SH.[Package Tracking No_],1,4) AS REV_YEAR
											, SUBSTRING(SH.[Package Tracking No_],5,2) AS REV_SEM
									FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Header] SH
									LEFT JOIN  (	SELECT X.[Document No_]
														,SUM(X.QTY) AS QTY
														,SUM(X.QTY_INV)AS QTY_INV
														,SUM(X.AMOUNT) AS AMOUNT
													FROM (
															SELECT [Document No_]
																	, [Quantity] AS QTY
																	, [Quantity Invoiced] AS QTY_INV
																	, CASE WHEN [Quantity Invoiced] <> 0 AND [Quantity] <> [Quantity Invoiced] THEN
																		([Amount] / [Quantity]) * ([Quantity] - [Quantity Invoiced])
																	  ELSE
																		[Amount]
																	  END AS AMOUNT
															FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Line]
															WHERE [Document Type] = 1 AND
															 [Quantity] <> [Quantity Invoiced]
														) X
													GROUP BY X.[Document No_]
												)SL ON SL.[Document No_] = SH.[No_]
									LEFT JOIN  (
													SELECT [Document No_]
														 , SUM([Amount]) AS AMOUNT_TTL
													FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Line]
													WHERE [Document Type] = 1
													GROUP BY [Document No_]
												)SL2 ON SL2.[Document No_] = SH.[No_]
									LEFT JOIN	(
													SELECT Y.NO_SO
															,SUM(Y.UM_AMOUNT) AS UM_AMOUNT
															,SUM(Y.UM_AMOUNT_IDR) AS UM_AMOUNT_IDR
													FROM (
															SELECT [Prepayment Order No_] AS NO_SO
																  ,SUM(UMD.[Amount]) AS UM_AMOUNT
																  ,CASE WHEN UMH.[Currency Code] <> '' THEN ROUND(SUM(UMD.[Amount]) / UMH.[Currency Factor],0) ELSE SUM(UMD.[Amount]) END AS UM_AMOUNT_IDR

															FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] UMH
															INNER JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Line] UMD ON UMH.[No_] = UMD.[Document No_]
															GROUP BY UMH.[Prepayment Order No_], UMH.[Currency Code], UMH.[Currency Factor]
															UNION ALL
															SELECT [Prepayment Order No_] AS NO_SO
																  ,SUM(UMD.[Amount]) * -1 AS UM_AMOUNT
																  ,CASE WHEN UMH.[Currency Code] <> '' THEN ROUND(SUM(UMD.[Amount]) / UMH.[Currency Factor],0) ELSE SUM(UMD.[Amount]) * -1 END AS UM_AMOUNT_IDR

															FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Cr_Memo Header] UMH
															INNER JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Cr_Memo Line] UMD ON UMH.[No_] = UMD.[Document No_]
															GROUP BY UMH.[Prepayment Order No_], UMH.[Currency Code], UMH.[Currency Factor]
														) Y
													GROUP BY Y.NO_SO
												) UM ON UM.NO_SO = SH.[No_]
									WHERE SH.[Document Type] = 1
								) XY
						WHERE
								(	(
										($P{Tahun} <= SUBSTRING(CONVERT(varchar, getdate(), 105), 7,4)) AND
										(XY.SO_YEAR <= SUBSTRING(CONVERT(varchar, getdate(), 105), 7,4)) AND
										(XY.REV_YEAR = '' OR (XY.REV_YEAR >= $P{Tahun} AND XY.REV_YEAR <= $P{Tahun}))
									) OR
									(
										($P{Tahun} > SUBSTRING(CONVERT(varchar, getdate(), 105), 7,4)) AND
										(
											(
												XY.TIPE_2 <> 'SOAR' AND
												(
													($P{Tahun} <= SUBSTRING(CONVERT(varchar, getdate(), 105), 7,4)) AND
													(XY.REV_YEAR = '' OR (XY.REV_YEAR >= $P{Tahun} AND XY.REV_YEAR <= $P{Tahun}))
												) OR
												(
													($P{Tahun} > SUBSTRING(CONVERT(varchar, getdate(), 105), 7,4)) AND
													((XY.REV_YEAR >= $P{Tahun} AND XY.REV_YEAR <= $P{Tahun}))
												)
											) OR
											(
												XY.TIPE_2 = 'SOAR' AND
												(XY.SO_YEAR >= $P{Tahun} AND XY.SO_YEAR <= $P{Tahun}) AND
												(XY.REV_YEAR = '' OR (XY.REV_YEAR >= $P{Tahun} AND XY.REV_YEAR <= $P{Tahun}))
											)
										)
									)
								)  AND
								XY.STATUS_SO = 'RELEASED'
						UNION ALL
						SELECT	'SOLUSI' AS COMPANY
								, XY.NO_SO
								, XY.TIPE
								, XY.BRANCHES
								, XY.SALES_CODE AS SALESMAN
								, XY.CUST_CODE
								, XY.ORDER_DATE
								, XY.STATUS_SO
								, XY.NO_PO_CUST
								, XY.SO_YEAR
								, XY.SO_Q
								, XY.REV_YEAR
								, XY.REV_SEM
								, CASE WHEN XY.TIPE_2 = 'SOSR' THEN
									CASE WHEN XY.SO_Q IN (1,2) THEN 'S1' ELSE 'S2' END
								  ELSE
									CASE WHEN XY.REV_SEM = '' OR  XY.REV_SEM NOT IN ('S1', 'S2') THEN
										CASE WHEN $P{Tahun} <= DATEPART(year, GETDATE()) THEN
											CASE WHEN DATEPART(quarter, GETDATE()) IN (1,2) THEN 'S1' ELSE 'S2' END
										ELSE
											'S1'
										END
									ELSE
										XY.REV_SEM
									END
								  END AS SEMESTER
								, CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
									(XY.AMOUNT_IDR - XY.UM_AMOUNT_IDR)
									ELSE
										(XY.AMOUNT_IDR - ((XY.UM_AMOUNT_IDR*XY.AMOUNT_IDR)/(XY.AMOUNT_IDR_TTL)))
									END AS AMOUNT_IDR
								, CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
									(XY.AMOUNT - XY.UM_AMOUNT)
									ELSE
									(XY.AMOUNT - ((XY.UM_AMOUNT*XY.AMOUNT) /(XY.AMOUNT_TTL)))
									END AS AMOUNT
						FROM	(
									SELECT SH.[No_] AS NO_SO
											, CASE WHEN SUBSTRING( SH.[No_], 1, 4) = 'SOAS' THEN 'SC' ELSE
												CASE WHEN SUBSTRING( SH.[No_], 1, 2) IN ('8S','9S') THEN 'AI' ELSE
													CASE WHEN SUBSTRING( SH.[No_], 1, 2) IN ('7S') THEN 'LZ' ELSE 'TD' END
												END
											  END AS TIPE
											, SUBSTRING( SH.[No_], 1, 4) AS TIPE_2
											, CASE WHEN SH.[Location Code] = '' THEN 'HO-TD' ELSE SH.[Location Code] END AS LOC_CODE
											, CASE WHEN SH.[Shortcut Dimension 1 Code] = '' THEN '10' ELSE ISNULL(SH.[Shortcut Dimension 1 Code],'10') END AS BRANCHES
											, CASE WHEN SH.[Salesperson Code] = '' THEN '.' ELSE SH.[Salesperson Code] END AS SALES_CODE
											, SH.[Bill-to Customer No_] AS CUST_CODE
											, SH.[Order Date] AS ORDER_DATE
											, DATEPART(quarter, SH.[Order Date]) AS SO_Q
											, SUBSTRING(CONVERT(varchar, SH.[Order Date], 105), 7,4) AS SO_YEAR
											, CASE	WHEN SH.[Status] = 0 THEN 'OPEN'
													WHEN SH.[Status] = 1 THEN 'RELEASED'
													WHEN SH.[Status] = 2 THEN 'PENDING APPROVAL'
													WHEN SH.[Status] = 3 THEN 'RELEASED'
													ELSE '' END AS STATUS_SO
											, SH.[External Document No_] AS NO_PO_CUST
											, ISNULL(CASE WHEN SH.[Currency Code] <> '' THEN ROUND(SL.AMOUNT / SH.[Currency Factor],0) ELSE SL.AMOUNT END,0) AS AMOUNT_IDR
											, ISNULL(SL.AMOUNT,0) AS AMOUNT
											, ISNULL(CASE WHEN SH.[Currency Code] <> '' THEN ROUND(SL2.AMOUNT_TTL / SH.[Currency Factor],0) ELSE SL2.AMOUNT_TTL END,0) AS AMOUNT_IDR_TTL
											, ISNULL(SL2.AMOUNT_TTL,0) AS AMOUNT_TTL
											, ISNULL(UM.UM_AMOUNT_IDR,0) AS UM_AMOUNT_IDR
											, ISNULL(UM.UM_AMOUNT,0) AS UM_AMOUNT
											, SUBSTRING(SH.[Package Tracking No_],1,4)AS REV_YEAR
											, SUBSTRING(SH.[Package Tracking No_],5,2) AS REV_SEM
									FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Header] SH
									INNER JOIN  (	SELECT X.[Document No_]
														,SUM(X.QTY) AS QTY
														,SUM(X.QTY_INV)AS QTY_INV
														,SUM(X.AMOUNT) AS AMOUNT
													FROM (
															SELECT [Document No_]
																	, [Quantity] AS QTY
																	, [Quantity Invoiced] AS QTY_INV
																	, CASE WHEN [Quantity Invoiced] <> 0 AND [Quantity] <> [Quantity Invoiced] THEN
																		([Amount] / [Quantity]) * ([Quantity] - [Quantity Invoiced])
																	  ELSE
																		[Amount]
																	  END AS AMOUNT
															FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Line]
															WHERE [Document Type] = 1 AND
															 [Quantity] <> [Quantity Invoiced]
														) X
													GROUP BY X.[Document No_]
												)SL ON SL.[Document No_] = SH.[No_]
									LEFT JOIN  (
													SELECT [Document No_]
														 , SUM([Amount]) AS AMOUNT_TTL
													FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Line]
													WHERE [Document Type] = 1
													GROUP BY [Document No_]
												)SL2 ON SL2.[Document No_] = SH.[No_]
									LEFT JOIN	(
													SELECT Y.NO_SO
															,SUM(Y.UM_AMOUNT) AS UM_AMOUNT
															,SUM(Y.UM_AMOUNT_IDR) AS UM_AMOUNT_IDR
													FROM (
															SELECT [Prepayment Order No_] AS NO_SO
																  ,SUM(UMD.[Amount]) AS UM_AMOUNT
																  ,CASE WHEN UMH.[Currency Code] <> '' THEN ROUND(SUM(UMD.[Amount]) / UMH.[Currency Factor],0) ELSE SUM(UMD.[Amount]) END AS UM_AMOUNT_IDR

															FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] UMH
															INNER JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Line] UMD ON UMH.[No_] = UMD.[Document No_]
															GROUP BY UMH.[Prepayment Order No_], UMH.[Currency Code], UMH.[Currency Factor]
															UNION ALL
															SELECT [Prepayment Order No_] AS NO_SO
																  ,SUM(UMD.[Amount]) * -1 AS UM_AMOUNT
																  ,CASE WHEN UMH.[Currency Code] <> '' THEN ROUND(SUM(UMD.[Amount]) / UMH.[Currency Factor],0) ELSE SUM(UMD.[Amount]) * -1 END AS UM_AMOUNT_IDR

															FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Cr_Memo Header] UMH
															INNER JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Cr_Memo Line] UMD ON UMH.[No_] = UMD.[Document No_]
															GROUP BY UMH.[Prepayment Order No_], UMH.[Currency Code], UMH.[Currency Factor]
														) Y
													GROUP BY Y.NO_SO
												) UM ON UM.NO_SO = SH.[No_]
									LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Responsibility Center] CAB ON CAB.[Code] = SH.[Shortcut Dimension 1 Code]
									LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Salesperson_Purchaser] SLS ON SLS.[Code] = SH.[Salesperson Code]
									WHERE SH.[Document Type] = 1
								) XY
						WHERE
								(	(
										($P{Tahun} <= SUBSTRING(CONVERT(varchar, getdate(), 105), 7,4)) AND
										(XY.SO_YEAR <= SUBSTRING(CONVERT(varchar, getdate(), 105), 7,4)) AND
										(XY.REV_YEAR = '' OR (XY.REV_YEAR >= $P{Tahun} AND XY.REV_YEAR <= $P{Tahun}))
									) OR
									(
										($P{Tahun} > SUBSTRING(CONVERT(varchar, getdate(), 105), 7,4)) AND
										(
											(
												XY.TIPE_2 <> 'SOSR' AND
												(
													($P{Tahun} <= SUBSTRING(CONVERT(varchar, getdate(), 105), 7,4)) AND
													(XY.REV_YEAR = '' OR (XY.REV_YEAR >= $P{Tahun} AND XY.REV_YEAR <= $P{Tahun}))
												) OR
												(
													($P{Tahun} > SUBSTRING(CONVERT(varchar, getdate(), 105), 7,4)) AND
													((XY.REV_YEAR >= $P{Tahun} AND XY.REV_YEAR <= $P{Tahun}))
												)
											) OR
											(
												XY.TIPE_2 = 'SOSR' AND
												(XY.SO_YEAR >= $P{Tahun} AND XY.SO_YEAR <= $P{Tahun}) AND
												(XY.REV_YEAR = '' OR (XY.REV_YEAR >= $P{Tahun} AND XY.REV_YEAR <= $P{Tahun}))
											)
										)
									)
								)  AND
								XY.STATUS_SO = 'RELEASED'
					) XXX
			WHERE	XXX.NO_PO_CUST NOT LIKE '%OTP%' AND
					XXX.NO_PO_CUST NOT LIKE 'BOOKING%'AND
					XXX.CUST_CODE NOT IN ('AUJA001' , 'AUJA002', 'SOPE001') AND
					XXX.NO_SO NOT IN ('SOST150107', 'SOST150657', 'HW15 C 000000274')
		) OSO
UNION ALL
SELECT	2 AS MAIN_GRP
		,XI.GROUP_NO
		,XI.GROUP_DESC
		,ROW_NUMBER() OVER (PARTITION BY XI.GROUP_NO ORDER BY XI.GROUP_NO, XI.BRANCHES, XI.SALES_CODE, XI.SUBGROUP_DESC) AS SUBGROUP_NO
		,XI.SUBGROUP_DESC
		,SUM(XI.AMOUNT) AS AMOUNT
		,SUM(XI.AMOUNT_S1) AS AMOUNT_S1
		,SUM(XI.AMOUNT_S2) AS AMOUNT_S2
		,XI.SALES_CODE
		,XI.BRANCHES
		,XI.SPV_BY
FROM	(
			SELECT		SLS.[Global Dimension 1 Code] AS BRANCHES
					,	CASE WHEN X.SIZE_PROJECT = 'P' THEN
							X.SALES_CODE
						ELSE
							CASE WHEN X.SIZE_PROJECT = 'B' THEN
								X.SALES_CODE
							ELSE
								CASE WHEN $P{AmtBig} <= 0 THEN '' ELSE
									CASE WHEN SUM(X.AMOUNT) >= $P{AmtBig} THEN X.SALES_CODE ELSE '' END
								END
							END
						END AS SALES_CODE
					,	CASE WHEN X.SIZE_PROJECT = 'P' THEN
							2
						ELSE
							CASE WHEN X.SIZE_PROJECT = 'B' THEN
								3
							ELSE
								CASE WHEN $P{AmtBig} <= 0 THEN 4 ELSE
									CASE WHEN SUM(X.AMOUNT) >= $P{AmtBig} THEN 3 ELSE 4 END
								END
							END
						END AS GROUP_NO
					,	CASE WHEN X.SIZE_PROJECT = 'P' THEN
							'PROJECT PILOTING'
						ELSE
							CASE WHEN X.SIZE_PROJECT = 'B' THEN
								'POTENSIAL BIG PROJECT'
							ELSE
								CASE WHEN $P{AmtBig} <= 0 THEN 'OTHERS PIPELINE' ELSE
									CASE WHEN SUM(X.AMOUNT) >= $P{AmtBig} THEN 'POTENSIAL BIG PROJECT' ELSE 'OTHERS PIPELINE' END
								END
							END
						END  AS GROUP_DESC
					,	CASE WHEN X.SIZE_PROJECT = 'P' THEN
							X.CUSTOMER
						ELSE
							CASE WHEN X.SIZE_PROJECT = 'B' THEN
								X.CUSTOMER
							ELSE
								CASE WHEN $P{AmtBig} <= 0 THEN CAB.[Name] ELSE
									CASE WHEN SUM(X.AMOUNT) >= $P{AmtBig} THEN X.CUSTOMER ELSE CAB.[Name] END
								END
							END
						END AS SUBGROUP_DESC
					,	CASE WHEN X.SIZE_PROJECT = 'P' THEN
							X.SPV_BY
						ELSE
							CASE WHEN X.SIZE_PROJECT = 'B' THEN
								X.SPV_BY
							ELSE
								CASE WHEN $P{AmtBig} <= 0 THEN '' ELSE
									CASE WHEN SUM(X.AMOUNT) >= $P{AmtBig} THEN X.SPV_BY ELSE '' END
								END
							END
						END AS SPV_BY
					,X.SIZE_PROJECT
					,SUM(X.AMOUNT) AS AMOUNT
					,SUM(X.AMOUNT_S1) AS AMOUNT_S1
					,SUM(X.AMOUNT_S2) AS AMOUNT_S2
			FROM	(
						SELECT	'AJ' AS COMPANY
								,MAD.SALES_CODE
								,MAD.CABANG
								,MAD.CUSTOMER
								,MAD.SIZE_PROJECT
								,MAD.POTENSIAL_PROJECT
								,MAD.SPV_BY
								,MAD.ITEM
								,MAD.ITEM_CAT
								,MAD.HW_PS
								,ROUND(((MAD.UNIT_PRICE * MAD.QTY_OUT)/1000000),2) AS AMOUNT
								,CASE WHEN MAD.EST_SEM = 'S1' THEN ROUND(((MAD.UNIT_PRICE * MAD.QTY_OUT)/1000000),2) ELSE 0 END AMOUNT_S1
								,CASE WHEN MAD.EST_SEM = 'S2' THEN ROUND(((MAD.UNIT_PRICE * MAD.QTY_OUT)/1000000),2) ELSE 0 END AMOUNT_S2
								,MAD.DIM_PRINCIPAL
								,MAD.EST_YEAR
								,MAD.EST_SEM
						FROM	(
									SELECT	SOH.[Salesperson Code] AS SALES_CODE
											,SOH.[Responsibility Center] AS CABANG
											,SOH.[Sell-to Customer Name] AS CUSTOMER
											, SUBSTRING(SOH.[Posting Description], 1,1) AS SIZE_PROJECT
											, CASE WHEN SUBSTRING(SOH.[Posting Description], 2,1) NOT IN ('1','0') THEN '0' ELSE SUBSTRING(SOH.[Posting Description], 2,1) END AS POTENSIAL_PROJECT
											,SOH.[Sell-to County] AS SPV_BY
											,SOL.[No_] AS ITEM
											,SOL.[Description] AS ITEM_DESC
											,SOL.[Shortcut Dimension 2 Code] AS ITEM_CAT
											,SUBSTRING(SOL.[Shortcut Dimension 2 Code] , 1,2) AS HW_PS
											,SOL.[Quantity] AS QTY_OUT
											,SOL.[Unit Price] AS UNIT_PRICE
											,DIMD.DIM_PRINCIPAL
											,CASE WHEN SOL.[Shipment Date] <=  GETDATE() THEN
												DATEPART(year, GETDATE()) ELSE DATEPART(year, SOL.[Shipment Date])
											 END AS EST_YEAR
											,CASE WHEN
												(	CASE WHEN SOL.[Shipment Date] <=  GETDATE() THEN
														DATEPART(quarter, GETDATE()) ELSE DATEPART(quarter, SOL.[Shipment Date])
													END
												)  IN (1,2) THEN 'S1' ELSE 'S2' END AS EST_SEM
									FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Header] SOH
									INNER JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Line] SOL ON SOL.[Document Type] = SOH.[Document Type] AND SOL.[Document No_] = SOH.[No_]
									LEFT JOIN	(
													SELECT X.[Dimension Set ID]
														  ,MAX(CASE WHEN X.[Dimension Code] = 'PRINCIPAL' THEN X.[Dimension Value Code] ELSE NULL END) AS DIM_PRINCIPAL
													FROM [AUTOJAYA].[dbo].[AUTOJAYA$Dimension Set Entry] X
													GROUP BY [Dimension Set ID]
												) DIMD ON DIMD.[Dimension Set ID] = SOL.[Dimension Set ID]
									WHERE SOH.[No_ Series] = 'SBOM'
								) MAD
						UNION ALL
						SELECT	'SP' AS COMPANY
								,MAD.SALES_CODE
								,MAD.CABANG
								,MAD.CUSTOMER
								,MAD.SIZE_PROJECT
								,MAD.POTENSIAL_PROJECT
								,MAD.SPV_BY
								,MAD.ITEM
								,MAD.ITEM_CAT
								,MAD.HW_PS
								,ROUND(((MAD.UNIT_PRICE * MAD.QTY_OUT)/1000000),2) AS AMOUNT
								,CASE WHEN MAD.EST_SEM = 'S1' THEN ROUND(((MAD.UNIT_PRICE * MAD.QTY_OUT)/1000000),2) ELSE 0 END AMOUNT_S1
								,CASE WHEN MAD.EST_SEM = 'S2' THEN ROUND(((MAD.UNIT_PRICE * MAD.QTY_OUT)/1000000),2) ELSE 0 END AMOUNT_S2
								,MAD.DIM_PRINCIPAL
								,MAD.EST_YEAR
								,MAD.EST_SEM
						FROM	(
									SELECT	SOH.[Salesperson Code] AS SALES_CODE
											,SOH.[Responsibility Center] AS CABANG
											,SOH.[Sell-to Customer Name] AS CUSTOMER
											, SUBSTRING(SOH.[Posting Description], 1,1) AS SIZE_PROJECT
											, CASE WHEN SUBSTRING(SOH.[Posting Description], 2,1) NOT IN ('1','0') THEN '0' ELSE SUBSTRING(SOH.[Posting Description], 2,1) END AS POTENSIAL_PROJECT
											,SOH.[Sell-to County] AS SPV_BY
											,SOL.[No_] AS ITEM
											,SOL.[Description] AS ITEM_DESC
											,SOL.[Shortcut Dimension 2 Code] AS ITEM_CAT
											,SUBSTRING(SOL.[Shortcut Dimension 2 Code] , 1,2) AS HW_PS
											,SOL.[Quantity] AS QTY_OUT
											,SOL.[Unit Price] AS UNIT_PRICE
											,DIMD.DIM_PRINCIPAL
											,CASE WHEN SOL.[Shipment Date] <=  GETDATE() THEN
												DATEPART(year, GETDATE()) ELSE DATEPART(year, SOL.[Shipment Date])
											 END AS EST_YEAR
											,CASE WHEN
												(	CASE WHEN SOL.[Shipment Date] <=  GETDATE() THEN
														DATEPART(quarter, GETDATE()) ELSE DATEPART(quarter, SOL.[Shipment Date])
													END
												)  IN (1,2) THEN 'S1' ELSE 'S2' END AS EST_SEM
									FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Header] SOH
									INNER JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Line] SOL ON SOL.[Document Type] = SOH.[Document Type] AND SOL.[Document No_] = SOH.[No_]
									LEFT JOIN	(
													SELECT X.[Dimension Set ID]
														  ,MAX(CASE WHEN X.[Dimension Code] = 'PRINCIPAL' THEN X.[Dimension Value Code] ELSE NULL END) AS DIM_PRINCIPAL
													FROM [AUTOJAYA].[dbo].[SOLUSI$Dimension Set Entry] X
													GROUP BY [Dimension Set ID]
												) DIMD ON DIMD.[Dimension Set ID] = SOL.[Dimension Set ID]
									WHERE SOH.[No_ Series] = 'SBOM'
								) MAD
					) X
			LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Salesperson_Purchaser] SLS ON SLS.[Code] = X.SALES_CODE
			LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Responsibility Center] CAB ON CAB.[Code] = SLS.[Global Dimension 1 Code]
			WHERE	X.EST_YEAR = $P{Tahun}
					AND SLS.[Global Dimension 1 Code] IS NOT NULL
			GROUP BY CAB.[Name]
					,X.SALES_CODE
					,X.CUSTOMER
					,X.SIZE_PROJECT
					,X.SPV_BY
					,SLS.[Global Dimension 1 Code]
		) XI
WHERE (XI.SPV_BY LIKE '%'+$P{SpvBy}+'%' OR $P{SpvBy} = 'ALL') 
GROUP BY XI.GROUP_NO
		,XI.GROUP_DESC
		,XI.SUBGROUP_DESC
		,XI.SALES_CODE
		,XI.BRANCHES
		,XI.SPV_BY]]>
	</queryString>
	<field name="MAIN_GRP" class="java.lang.Integer"/>
	<field name="GROUP_NO" class="java.lang.Integer"/>
	<field name="GROUP_DESC" class="java.lang.String"/>
	<field name="SUBGROUP_NO" class="java.lang.Long"/>
	<field name="SUBGROUP_DESC" class="java.lang.String"/>
	<field name="AMOUNT" class="java.math.BigDecimal"/>
	<field name="AMOUNT_S1" class="java.math.BigDecimal"/>
	<field name="AMOUNT_S2" class="java.math.BigDecimal"/>
	<field name="SALES_CODE" class="java.lang.String"/>
	<field name="BRANCHES" class="java.lang.String"/>
	<field name="SPV_BY" class="java.lang.String"/>
	<sortField name="MAIN_GRP"/>
	<sortField name="GROUP_NO"/>
	<sortField name="BRANCHES"/>
	<sortField name="SUBGROUP_NO"/>
	<variable name="AMOUNT_S1_1" class="java.math.BigDecimal" resetType="Group" resetGroup="Grp" calculation="Sum">
		<variableExpression><![CDATA[$F{AMOUNT_S1}]]></variableExpression>
	</variable>
	<variable name="AMOUNT_S2_1" class="java.math.BigDecimal" resetType="Group" resetGroup="Grp" calculation="Sum">
		<variableExpression><![CDATA[$F{AMOUNT_S2}]]></variableExpression>
	</variable>
	<variable name="AMOUNT_S1_2" class="java.math.BigDecimal" resetType="Group" resetGroup="MainGrp" calculation="Sum">
		<variableExpression><![CDATA[$F{AMOUNT_S1}]]></variableExpression>
	</variable>
	<variable name="AMOUNT_S2_2" class="java.math.BigDecimal" resetType="Group" resetGroup="MainGrp" calculation="Sum">
		<variableExpression><![CDATA[$F{AMOUNT_S2}]]></variableExpression>
	</variable>
	<variable name="AMOUNT_1" class="java.math.BigDecimal" resetType="Group" resetGroup="Grp" calculation="Sum">
		<variableExpression><![CDATA[$F{AMOUNT}]]></variableExpression>
	</variable>
	<variable name="AMOUNT_2" class="java.math.BigDecimal" resetType="Group" resetGroup="MainGrp" calculation="Sum">
		<variableExpression><![CDATA[$F{AMOUNT}]]></variableExpression>
	</variable>
	<group name="MainGrp">
		<groupExpression><![CDATA[$F{MAIN_GRP}]]></groupExpression>
		<groupFooter>
			<band height="28">
				<printWhenExpression><![CDATA[$F{MAIN_GRP}.equals( 1 ) == true]]></printWhenExpression>
				<staticText>
					<reportElement x="0" y="0" width="28" height="14" uuid="e6f36e95-8dde-4aac-98cf-9c523ee4ebe5"/>
					<textElement textAlignment="Center">
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="28" y="0" width="250" height="14" uuid="b08db0a1-0dab-466c-9044-ee13b905cc5d"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[TOTAL SALES REVENUE]]></text>
				</staticText>
				<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
					<reportElement x="428" y="0" width="75" height="14" isPrintWhenDetailOverflows="true" uuid="4e79e2c7-33cd-4c94-8b29-788a7e33151f"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{AMOUNT_S1_2}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
					<reportElement x="503" y="0" width="75" height="14" isPrintWhenDetailOverflows="true" uuid="a4d3c99f-75dc-4aac-85e7-f9923ac3cd29"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{AMOUNT_S2_2}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
					<reportElement x="578" y="0" width="75" height="14" isPrintWhenDetailOverflows="true" uuid="0ec90f45-b6fd-41dc-b093-86a7f4a4346d"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{AMOUNT_2}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="278" y="0" width="50" height="14" uuid="5f3ec487-e5c3-4423-8389-295a264633ba"/>
					<textElement textAlignment="Center">
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="328" y="0" width="100" height="14" uuid="3ff022bc-6112-4af2-8e57-89691b01373a"/>
					<textElement textAlignment="Center">
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="0" y="14" width="28" height="14" uuid="5d521968-90f8-43f9-9fac-654769ceaa12"/>
					<textElement textAlignment="Center">
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
			</band>
			<band height="14">
				<printWhenExpression><![CDATA[$F{MAIN_GRP}.equals( 2 ) == true]]></printWhenExpression>
				<staticText>
					<reportElement x="28" y="0" width="250" height="14" uuid="0d8e5441-8b22-48fc-adde-cacb50052bd3"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[GRAND TOTAL PIPELINE]]></text>
				</staticText>
				<staticText>
					<reportElement x="0" y="0" width="28" height="14" uuid="96e08f89-10dc-4331-b5b5-dfeb5302afd0"/>
					<textElement textAlignment="Center">
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="278" y="0" width="50" height="14" uuid="4d3e9e1f-b77c-4ded-887b-5c146afabcd8"/>
					<textElement textAlignment="Center">
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="328" y="0" width="100" height="14" uuid="5ff6ebb4-5862-4e58-aeec-035542424ee6"/>
					<textElement textAlignment="Center">
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
					<reportElement x="428" y="0" width="75" height="14" isPrintWhenDetailOverflows="true" uuid="b5321851-4e12-43ba-9e5b-06f1e82f026f"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{AMOUNT_S1_2}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
					<reportElement x="503" y="0" width="75" height="14" isPrintWhenDetailOverflows="true" uuid="7b67c4c9-a082-44fa-b2af-257d5f70922f"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{AMOUNT_S2_2}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
					<reportElement x="578" y="0" width="75" height="14" isPrintWhenDetailOverflows="true" uuid="0133601d-fb82-417d-bd97-56dd039ff6bc"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{AMOUNT_2}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<group name="Grp">
		<groupExpression><![CDATA[$F{GROUP_NO}]]></groupExpression>
		<groupHeader>
			<band height="14">
				<printWhenExpression><![CDATA[$F{MAIN_GRP}.equals( 1 ) == true ||
($F{MAIN_GRP}.equals( 2 ) == true && $F{GROUP_NO}.equals( 4 ) == true)]]></printWhenExpression>
				<textField>
					<reportElement x="28" y="0" width="250" height="14" uuid="63e7c0e7-6026-4740-bcde-9520563c2d9d"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{GROUP_DESC}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="0" y="0" width="28" height="14" uuid="36406f89-57e3-42be-aa69-358eae833b86"/>
					<textElement textAlignment="Center">
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="428" y="0" width="75" height="14" uuid="1a5732c2-0368-40db-9087-118b9b3de003"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[SEMESTER I]]></text>
				</staticText>
				<staticText>
					<reportElement x="503" y="0" width="75" height="14" uuid="441fce67-c427-4579-8ddb-eb894ba72f04"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[SEMESTER II]]></text>
				</staticText>
				<staticText>
					<reportElement x="578" y="0" width="75" height="14" uuid="ef7a9de3-3574-4737-9c73-03752c72ad75"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[TOTAL]]></text>
				</staticText>
				<staticText>
					<reportElement x="328" y="0" width="100" height="14" uuid="eeb4e14f-e2d0-4a7e-9338-9a91a6e9e24b"/>
					<textElement textAlignment="Center">
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="278" y="0" width="50" height="14" uuid="3231874c-294b-4444-b828-4a12fb0d8e62"/>
					<textElement textAlignment="Center">
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
			</band>
			<band height="14">
				<printWhenExpression><![CDATA[$F{GROUP_NO}.equals( 2 ) == true ||
$F{GROUP_NO}.equals( 3 ) == true]]></printWhenExpression>
				<staticText>
					<reportElement x="328" y="0" width="100" height="14" uuid="862db48b-97c0-41e0-88fe-eef0320b908c"/>
					<textElement textAlignment="Center">
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[SPV by]]></text>
				</staticText>
				<textField>
					<reportElement x="28" y="0" width="250" height="14" uuid="9001d8c8-956d-41b7-95f3-aaf2bda9cd46"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{GROUP_DESC}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="428" y="0" width="75" height="14" uuid="14c9835a-1f8a-40ab-a89f-9b9a72eb0578"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[SEMESTER I]]></text>
				</staticText>
				<staticText>
					<reportElement x="503" y="0" width="75" height="14" uuid="e0736970-31be-44cc-b49d-acce5eebafab"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[SEMESTER II]]></text>
				</staticText>
				<staticText>
					<reportElement x="278" y="0" width="50" height="14" uuid="eb03ae24-8467-4b20-8132-8ff160c41e6a"/>
					<textElement textAlignment="Center">
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[SALES]]></text>
				</staticText>
				<staticText>
					<reportElement x="0" y="0" width="28" height="14" uuid="3093fa5e-b507-4df8-9d1b-b24b048883cc"/>
					<textElement textAlignment="Center">
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="578" y="0" width="75" height="14" uuid="a5784f38-eac7-4d65-917e-fa5ff7029e4a"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[TOTAL]]></text>
				</staticText>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="28">
				<printWhenExpression><![CDATA[$F{MAIN_GRP}.equals( 2 ) == true]]></printWhenExpression>
				<staticText>
					<reportElement x="0" y="0" width="28" height="14" uuid="ea95602d-0ec4-460a-aa4b-edb4852de674"/>
					<textElement textAlignment="Center">
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<textField>
					<reportElement x="28" y="0" width="250" height="14" uuid="e1205247-1c83-45a9-8460-8d832950eae1"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA["TOTAL " + $F{GROUP_DESC}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
					<reportElement x="428" y="0" width="75" height="14" isPrintWhenDetailOverflows="true" uuid="5a8caf99-902e-422c-a1e1-3a5811090190"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{AMOUNT_S1_1}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
					<reportElement x="503" y="0" width="75" height="14" isPrintWhenDetailOverflows="true" uuid="2e8df1f1-39f3-4334-bddc-780be072af9f"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{AMOUNT_S2_1}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="0" y="14" width="28" height="14" uuid="0853852c-52c2-4a7c-af71-55176f2b7af3"/>
					<textElement textAlignment="Center">
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="328" y="0" width="100" height="14" uuid="d32a4ce6-b5f7-46ec-9aac-9bccdd045868"/>
					<textElement textAlignment="Center">
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="278" y="0" width="50" height="14" uuid="56be9098-3187-45c0-8e53-2c748764a4c5"/>
					<textElement textAlignment="Center">
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
					<reportElement x="578" y="0" width="75" height="14" isPrintWhenDetailOverflows="true" uuid="9ed903e8-de12-4855-8f3e-fe41b2d86dc3"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{AMOUNT_1}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<group name="Branches">
		<groupExpression><![CDATA[$F{BRANCHES}]]></groupExpression>
		<groupFooter>
			<band height="14">
				<printWhenExpression><![CDATA[$F{GROUP_NO}.equals( 4 ) == false && $F{BRANCHES}.equals( "" ) == false]]></printWhenExpression>
				<staticText>
					<reportElement x="0" y="0" width="28" height="14" uuid="0d849e6f-bf81-4456-96a2-7e5d501723df"/>
					<textElement textAlignment="Center">
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
			</band>
		</groupFooter>
	</group>
	<title>
		<band height="126">
			<staticText>
				<reportElement x="0" y="0" width="28" height="14" uuid="f97f8d1a-45da-4395-b971-281ecf908f9a"/>
				<textElement textAlignment="Center">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="28" y="0" width="250" height="14" uuid="acd4205f-277b-4ec2-ada9-5a79458adb73"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[(04047) FORECAST SALES ACS]]></text>
			</staticText>
			<staticText>
				<reportElement x="28" y="14" width="250" height="14" uuid="d4400665-9c25-4138-b12f-910908625b6a"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="14" width="28" height="14" uuid="e89ce257-f955-45e4-a80e-6cab058ed45a"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="28" y="70" width="250" height="14" uuid="5d516873-20c7-48a6-86a6-3aeae26f97ad"/>
				<textElement textAlignment="Right">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Printed on]]></text>
			</staticText>
			<textField pattern="dd-MM-yyyy HH:mm:ss">
				<reportElement x="328" y="70" width="100" height="14" uuid="4dc4a503-b27e-439e-b1ae-c79bf378ce8f"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="28" y="28" width="250" height="14" uuid="2c8a0df7-dc37-4e35-92c1-f757b469bf68"/>
				<textElement textAlignment="Right">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Tahun]]></text>
			</staticText>
			<textField>
				<reportElement x="328" y="28" width="100" height="14" uuid="66282874-183e-42fd-a70b-3c72c237d244"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{Tahun}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="0" y="28" width="28" height="14" uuid="97ac2135-90cd-4d07-988b-cf05ebc816fd"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="70" width="28" height="14" uuid="d8424e3d-e41d-4879-afb1-5590285beec3"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="84" width="28" height="14" uuid="99acf5d9-154d-43b3-8c58-04c332d47b62"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="28" y="84" width="250" height="14" uuid="0d5436e1-8fc9-4c73-85d8-7dcea2fd906f"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<textField isStretchWithOverflow="true" pattern="#,###" isBlankWhenNull="true">
				<reportElement x="328" y="42" width="100" height="14" uuid="03e085c1-30f4-4d0f-8626-310d3a5549a3"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{AmtBig}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="28" y="42" width="250" height="14" uuid="4f0f945d-24f9-42b9-864c-ae39d1c62d54"/>
				<textElement textAlignment="Right">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Batas Amt Big Project]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="42" width="28" height="14" uuid="125c7e9f-206f-47d2-8ce4-0c50c6d1f766"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="278" y="28" width="50" height="14" uuid="0ba2f455-4b5b-4f59-a787-123a95f37e9d"/>
				<textElement textAlignment="Center">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[:]]></text>
			</staticText>
			<staticText>
				<reportElement x="278" y="42" width="50" height="14" uuid="2cca7bfc-e8b9-4962-980e-2ea6e7bb09d9"/>
				<textElement textAlignment="Center">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[:]]></text>
			</staticText>
			<staticText>
				<reportElement x="278" y="70" width="50" height="14" uuid="7c802184-3b50-4a5a-83c3-e5ac6f2ae2b2"/>
				<textElement textAlignment="Center">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[:]]></text>
			</staticText>
			<staticText>
				<reportElement x="28" y="98" width="250" height="14" uuid="0ec2ae66-cf8b-4e0b-b9f6-9bb1cde0f587"/>
				<textElement>
					<font size="8" isBold="true" isItalic="true"/>
				</textElement>
				<text><![CDATA[Note : Amount in million (1,000,000)]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="98" width="28" height="14" uuid="3e6ce657-c47f-4502-9b1a-498c8a2ac65f"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="28" y="112" width="250" height="14" uuid="04d7d2e6-cd46-4bb3-8e59-268c55d36a8a"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="112" width="28" height="14" uuid="bf26f443-3394-464d-be8a-a2f0850c6aed"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="28" y="56" width="250" height="14" uuid="1a5be816-064d-4158-ab7e-5d214586a5db"/>
				<textElement textAlignment="Right">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[SPV by]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="56" width="28" height="14" uuid="2fb64e27-d88f-445a-a81e-ef6a5c445c5c"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="278" y="56" width="50" height="14" uuid="0d73f5c9-d4e3-4c6d-bb16-c03025226f85"/>
				<textElement textAlignment="Center">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[:]]></text>
			</staticText>
			<textField>
				<reportElement x="328" y="56" width="100" height="14" uuid="3b5519ab-14fc-4886-a92b-81113fb0b932"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{SpvBy}]]></textFieldExpression>
			</textField>
		</band>
	</title>
	<detail>
		<band height="14">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement x="28" y="0" width="250" height="14" isPrintWhenDetailOverflows="true" uuid="01a6b914-f1c3-43d6-a09c-be7e73761fed"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{SUBGROUP_DESC}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="#,###" isBlankWhenNull="true">
				<reportElement x="0" y="0" width="28" height="14" isPrintWhenDetailOverflows="true" uuid="0a97dc19-8cca-4fe1-b49b-232b644f7f83"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{SUBGROUP_NO}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement x="428" y="0" width="75" height="14" isPrintWhenDetailOverflows="true" uuid="44efd10a-f95c-46b2-9883-89398cf23f3d"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{AMOUNT_S1}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement x="503" y="0" width="75" height="14" isPrintWhenDetailOverflows="true" uuid="b5ce705a-9674-4462-a9c8-2e425fcc7059"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{AMOUNT_S2}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="278" y="0" width="50" height="14" uuid="80290d0e-6031-46d2-960e-71a2a36806b4"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{SALES_CODE}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement x="328" y="0" width="100" height="14" isPrintWhenDetailOverflows="true" uuid="1ce80833-f84b-4c66-9095-b49513fe1742"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{SPV_BY}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement x="578" y="0" width="75" height="14" isPrintWhenDetailOverflows="true" uuid="cb14dca1-7497-45ed-9665-a28bdc7a4535"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{AMOUNT}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<noData>
		<band height="140">
			<staticText>
				<reportElement x="28" y="126" width="250" height="14" uuid="e762fe98-ae4e-46c4-a6dc-d3d20f52f9ce"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[TIDAK ADA DATA YANG MEMENUHI KRITERIA]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="126" width="28" height="14" uuid="0d0e937a-cc13-4fa7-b654-31f654651860"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="28" y="112" width="250" height="14" uuid="0c357bca-58e8-46bb-badd-995bcbad76b4"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="28" y="56" width="250" height="14" uuid="ec4adbaf-4f6b-4c4e-9249-38a03105878d"/>
				<textElement textAlignment="Right">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[SPV by]]></text>
			</staticText>
			<textField isStretchWithOverflow="true" pattern="#,###" isBlankWhenNull="true">
				<reportElement x="328" y="42" width="100" height="14" uuid="9f35fdca-16f3-42e6-8de2-73e6f722eb09"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{AmtBig}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="0" y="70" width="28" height="14" uuid="f1df12e0-c616-444b-8bff-d5ed9c6be06a"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="84" width="28" height="14" uuid="82ab007b-544f-4db3-9d10-a3d3ccac5266"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="28" width="28" height="14" uuid="1851bf3b-22f5-490d-a556-96f58d009376"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<textField>
				<reportElement x="328" y="56" width="100" height="14" uuid="1b69e890-1531-41d6-a8a7-77fa0d617548"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{SpvBy}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="28" y="0" width="250" height="14" uuid="e87a293f-bfc0-4919-9e35-ebfa0894698c"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[(04047) FORECAST SALES ACS]]></text>
			</staticText>
			<staticText>
				<reportElement x="278" y="42" width="50" height="14" uuid="1157a07d-1f7f-4d4a-a1f7-8fada13b4a52"/>
				<textElement textAlignment="Center">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[:]]></text>
			</staticText>
			<staticText>
				<reportElement x="278" y="56" width="50" height="14" uuid="ce6e6324-2788-4570-8b35-ac42d1442f34"/>
				<textElement textAlignment="Center">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[:]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="14" width="28" height="14" uuid="fbd3e440-6989-40f4-8afb-08f7328fe293"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="28" y="14" width="250" height="14" uuid="228fd7c1-6d7b-4ddf-97b0-220a7c189d87"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="28" y="98" width="250" height="14" uuid="21ffe86b-ad3b-4c59-94ec-91fa7193bc06"/>
				<textElement>
					<font size="8" isBold="true" isItalic="true"/>
				</textElement>
				<text><![CDATA[Note : Amount in million (1,000,000)]]></text>
			</staticText>
			<staticText>
				<reportElement x="278" y="70" width="50" height="14" uuid="b98860ab-44c2-4427-9c16-029586e37a49"/>
				<textElement textAlignment="Center">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[:]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="0" width="28" height="14" uuid="8d158afc-d8dd-4689-a0f8-9b43ff47feda"/>
				<textElement textAlignment="Center">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="112" width="28" height="14" uuid="89a2dcc8-8f9b-4e03-84d5-da9e12a08f64"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="28" y="42" width="250" height="14" uuid="67610e43-67b9-4c64-8bf5-f2acd149542f"/>
				<textElement textAlignment="Right">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Batas Amt Big Project]]></text>
			</staticText>
			<staticText>
				<reportElement x="28" y="84" width="250" height="14" uuid="734a1032-379d-4160-977f-1953228fcfc2"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="28" y="70" width="250" height="14" uuid="7c187b12-948e-4028-b1f8-d40ea17424a7"/>
				<textElement textAlignment="Right">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Printed on]]></text>
			</staticText>
			<staticText>
				<reportElement x="28" y="28" width="250" height="14" uuid="4a2768a0-6293-46a9-843d-17747a147798"/>
				<textElement textAlignment="Right">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Tahun]]></text>
			</staticText>
			<textField pattern="dd-MM-yyyy HH:mm:ss">
				<reportElement x="328" y="70" width="100" height="14" uuid="d6dd5085-15df-4d48-9ab9-48a81f8595b6"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="0" y="56" width="28" height="14" uuid="b15ee891-42ed-4131-90d5-e16b574b0723"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="278" y="28" width="50" height="14" uuid="33eadada-97af-4034-aea7-04fd982aa53d"/>
				<textElement textAlignment="Center">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[:]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="42" width="28" height="14" uuid="53aaf1cc-f3eb-41a5-a638-50e1559914b2"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<textField>
				<reportElement x="328" y="28" width="100" height="14" uuid="3a03bd3e-2514-4ee3-b9e0-8c87e38c8891"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{Tahun}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="0" y="98" width="28" height="14" uuid="6abc96ea-037d-43dc-94f4-2fe66b4e3c66"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
		</band>
	</noData>
</jasperReport>
