<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="04019_LapSalesRevenueV3" language="groovy" pageWidth="1200" pageHeight="595" orientation="Landscape" columnWidth="1160" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="d67d58b6-db98-43fc-b2fe-6c1d43bc5f9a">
	<property name="ireport.zoom" value="1.2100000000000184"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="TglInvFrom" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="TglInvTo" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="Company" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT	1 AS GR_CRNXY
		,SRV.GROUP_NO
		,SRV.GROUP_DESC
		,SRV.GROUP_ITEM_CAT
		,SRV.ITEM_CAT
		,ROUND((SRV.AMT_HO),0) AS AMT_HO
		,ROUND((SRV.AMT_SBY),0) AS AMT_SBY
		,ROUND((SRV.AMT_DPS),0) AS AMT_DPS
		,ROUND((SRV.AMT_CKR),0) AS AMT_CKR
		,ROUND((SRV.AMT_SMR),0) AS AMT_SMR
		,	(ROUND((SRV.AMT_HO),0) + ROUND((SRV.AMT_SBY),0) + ROUND((SRV.AMT_DPS),0)
			+ROUND((SRV.AMT_CKR),0) +ROUND((SRV.AMT_SMR),0) )AS TOTAL
		, ROUND((ISNULL(TRG.AMT_TARGET,0)),0) AS AMT_TARGET
		,TRG.LBL_TARGET
FROM	(
			SELECT	1 AS GROUP_NO
					,'Sales Revenue' AS GROUP_DESC
					,XX.GROUP_ITEM_CAT
					,XX.ITEM_CAT
					,(SUM(XX.AMT_HO)) AS AMT_HO
					,(SUM(XX.AMT_SBY)) AS AMT_SBY
					,(SUM(XX.AMT_DPS)) AS AMT_DPS
					,(SUM(XX.AMT_CKR)) AS AMT_CKR
					,(SUM(XX.AMT_SMR)) AS AMT_SMR
			FROM	(
						SELECT	CASE WHEN X.ITEM_CAT = 'HW01' THEN 'HW' ELSE 'PS' END AS GROUP_ITEM_CAT
								,CASE	WHEN X.ITEM_CAT = 'HW01' THEN 'HW01 - Hardware'
										WHEN X.ITEM_CAT = 'PS01' THEN 'PS01 - 3rd Party Software'
										WHEN X.ITEM_CAT = 'PS02' THEN 'PS02 - Own Software'
										WHEN X.ITEM_CAT = 'PS03' THEN 'PS03 - Technology Service'
										WHEN X.ITEM_CAT = 'PS04' THEN 'PS04 - Hardware Service'
										WHEN X.ITEM_CAT = 'PS05' THEN 'PS05 - Manage Service'
									END AS ITEM_CAT
								,CASE WHEN X.BRANCHES = '10' THEN X.AMOUNT ELSE 0 END AS AMT_HO
								,CASE WHEN X.BRANCHES = '15' THEN X.AMOUNT ELSE 0 END AS AMT_SBY
								,CASE WHEN X.BRANCHES = '19' THEN X.AMOUNT ELSE 0 END AS AMT_DPS
								,CASE WHEN X.BRANCHES = '16' THEN X.AMOUNT ELSE 0 END AS AMT_CKR
								,CASE WHEN X.BRANCHES = '17' THEN X.AMOUNT ELSE 0 END AS AMT_SMR

						FROM (
						SELECT	'SALES ALL' AS NOTE
								,DIMS.BRANCHES
								,DIMS.ITEM_CAT
								,DIMS.SALESMAN
								,SUM(GLE.[Amount]) * -1 AS AMOUNT
						FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
						LEFT JOIN	(
										SELECT	DIM.DIM_ID
												,MAX(DIM.BRANCHES) AS BRANCHES
												,MAX(DIM.ITEM_CAT) AS ITEM_CAT
												,MAX(DIM.SALESMAN) AS SALESMAN
										FROM	(
													SELECT [Dimension Set ID] AS DIM_ID
														  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
														  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
														  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
													FROM [AUTOJAYA].[dbo].[AUTOJAYA$Dimension Set Entry]
												) DIM
										GROUP BY DIM.DIM_ID
									) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
						WHERE	(GLE.[G_L Account No_] BETWEEN '400.110.00'  AND '420.110.01') AND
								GLE.[G_L Account No_] <> '400.110.04' AND
								DIMS.ITEM_CAT <> '' AND
								(GLE.[Posting Date] >= $P{TglInvFrom} AND GLE.[Posting Date] <=  $P{TglInvTo})
						GROUP BY DIMS.BRANCHES, DIMS.ITEM_CAT, DIMS.SALESMAN
						UNION ALL
						SELECT	'Sales - LAINNYA' AS NOTE
								,'10' BRANCHES
								,'HW01' AS ITEM_CAT
								,'OFC' AS SALESMAN
								,SUM(GLE.[Amount]) * -1 AS AMOUNT
						FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
						LEFT JOIN	(
										SELECT	DIM.DIM_ID
												,MAX(DIM.BRANCHES) AS BRANCHES
												,MAX(DIM.ITEM_CAT) AS ITEM_CAT
												,MAX(DIM.SALESMAN) AS SALESMAN
										FROM	(
													SELECT [Dimension Set ID] AS DIM_ID
														  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
														  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
														  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
													FROM [AUTOJAYA].[dbo].[AUTOJAYA$Dimension Set Entry]
												) DIM
										GROUP BY DIM.DIM_ID
									) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
						WHERE	GLE.[G_L Account No_] = '400.110.04' AND
								(GLE.[Posting Date] >= $P{TglInvFrom} AND GLE.[Posting Date] <=  $P{TglInvTo})
						UNION ALL
						SELECT	'(-) Accured Sales Current Year' AS NOTE
								,ASCY.BRANCHES
								,ASCY.ITEM_CAT
								,ASCY.SALESMAN
								,SUM(ASCY.AMOUNT) * -1 AS AMOUNT
						FROM (
								SELECT	OUM.ITEM_CAT
										,OUM.BRANCHES
										,OUM.SALESMAN
										,OUM.AMOUNT
								FROM	(
											SELECT	UM.ITEM_CAT
													,UM.BRANCHES
													,UM.SALESMAN
													,	CASE WHEN ISNULL(INV.AMOUNT,0) = 0 THEN UM.AMOUNT ELSE
															CASE WHEN SUM(UM.AMOUNT)OVER(PARTITION BY UM.NO_SO, UM.BRANCHES, UM.ITEM_CAT, UM.SALESMAN  ORDER BY UM.TGL_UM) <= ISNULL(INV.AMOUNT,0) THEN 0 ELSE
																SUM(UM.AMOUNT)OVER(PARTITION BY UM.NO_SO, UM.BRANCHES, UM.ITEM_CAT, UM.SALESMAN  ORDER BY UM.TGL_UM) - ISNULL(INV.AMOUNT,0)
															END
														END AS AMOUNT
											FROM	(
														SELECT	DIMS.ITEM_CAT
																,DIMS.BRANCHES
																,DIMS.SALESMAN
																,SIH.[Posting Date] AS TGL_UM
																,SIH.[No_] AS NO_UM
																,SIH.[External Document No_] AS NO_PO_CUST
																,SIH.[Bill-to Customer No_] AS CUST_NO
																,SIH.[Bill-to Name] AS CUST_NAME
																,SIH.[Prepayment Order No_] AS NO_SO
																, (SUM(GLE.[Amount]) * -1) AS AMOUNT
														FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
														LEFT JOIN	(
																		SELECT	DIM.DIM_ID
																				,MAX(DIM.BRANCHES) AS BRANCHES
																				,MAX(DIM.ITEM_CAT) AS ITEM_CAT
																				,MAX(DIM.SALESMAN) AS SALESMAN
																		FROM	(
																					SELECT [Dimension Set ID] AS DIM_ID
																						  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																						  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																						  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																					FROM [AUTOJAYA].[dbo].[AUTOJAYA$Dimension Set Entry]
																				) DIM
																		GROUP BY DIM.DIM_ID
																	) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
														LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
														LEFT JOIN	(
																		SELECT CLE.[Entry No_]
																				, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE.[Document No_] ELSE CLE2.[Document No_] END AS NO_UM
																				, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE2.[Document No_] ELSE CLE.[Document No_] END AS NO_CM
																		FROM [AUTOJAYA].[dbo].[AUTOJAYA$Cust_ Ledger Entry] CLE
																		LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Cust_ Ledger Entry] CLE2 ON CLE2.[Entry No_] = CLE.[Closed by Entry No_]
																		WHERE CLE.[Document Type] IN (2,3)
																		AND ((CLE.[Document No_]  LIKE 'UM%' AND CLE2.[Document Type] = 3) OR
																			(CLE2.[Document No_]  LIKE 'UM%' AND CLE.[Document Type] = 3) )
																	) CM ON CM.NO_UM = GLE.[Document No_]
														LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Cr_Memo Header] CMH ON CMH.[No_] = CM.NO_CM
														WHERE GLE.[G_L Account No_] = '400.110.03'
															  AND GLE.[Document No_] LIKE 'UM%'
															  AND (CM.NO_CM IS NULL OR (CM.NO_CM IS NOT NULL AND CMH.[Posting Date] > $P{TglInvTo} ))
															  AND (SIH.[Posting Date] >= $P{TglInvFrom} AND SIH.[Posting Date]<= $P{TglInvTo})
														GROUP BY DIMS.ITEM_CAT
																 ,DIMS.BRANCHES
																 ,DIMS.SALESMAN
																 ,SIH.[Posting Date]
																 ,SIH.[No_]
																 ,SIH.[External Document No_]
																 ,SIH.[Bill-to Customer No_]
																 ,SIH.[Bill-to Name]
																 ,SIH.[Prepayment Order No_]
													) UM
											LEFT JOIN	(
															SELECT	DIMS.ITEM_CAT
																	,DIMS.BRANCHES
																	,DIMS.SALESMAN
																	,SIH.[Order No_] AS NO_SO
																	,MAX(SIH.[Posting Date]) AS TGL_INV
																	,SUM(GLE.[Amount]) AS AMOUNT
															FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
															LEFT JOIN	(
																			SELECT	DIM.DIM_ID
																					,MAX(DIM.BRANCHES) AS BRANCHES
																					,MAX(DIM.ITEM_CAT) AS ITEM_CAT
																					,MAX(DIM.SALESMAN) AS SALESMAN
																			FROM	(
																						SELECT [Dimension Set ID] AS DIM_ID
																							  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																							  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																							  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																						FROM [AUTOJAYA].[dbo].[AUTOJAYA$Dimension Set Entry]
																					) DIM
																			GROUP BY DIM.DIM_ID
																		) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
															LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
															WHERE GLE.[G_L Account No_] = '400.110.03'
																  AND GLE.[Document No_] NOT LIKE 'UM%'
																  AND GLE.[Posting Date] <=  $P{TglInvTo}
															GROUP BY DIMS.ITEM_CAT
																	,DIMS.BRANCHES
																	,DIMS.SALESMAN
																	,SIH.[Order No_]
														) INV ON INV.NO_SO = UM.NO_SO AND INV.BRANCHES = UM.BRANCHES AND INV.ITEM_CAT = UM.ITEM_CAT AND INV.SALESMAN = UM.SALESMAN
										) OUM
								WHERE OUM.AMOUNT > 0
							 ) ASCY
						GROUP BY ASCY.BRANCHES, ASCY.ITEM_CAT, ASCY.SALESMAN
						UNION ALL
						SELECT	'(+) Accured Sales Previous Year' AS NOTE
								,ASPY.BRANCHES
								,ASPY.ITEM_CAT
								,ASPY.SALESMAN
								,SUM(ASPY.AMOUNT)  AS AMOUNT
						FROM	(
									SELECT	OUM.ITEM_CAT
											,OUM.BRANCHES
											,OUM.SALESMAN
											,OUM.AMOUNT
									FROM	(
												SELECT	UM.ITEM_CAT
														,UM.BRANCHES
														,UM.SALESMAN
														, CASE WHEN ISNULL(INV.AMOUNT,0) =  0 THEN 0 ELSE
															CASE WHEN SUM(UM.AMOUNT)OVER(PARTITION BY UM.NO_SO, UM.BRANCHES, UM.ITEM_CAT, UM.SALESMAN  ORDER BY UM.TGL_UM) <= ISNULL(INV.AMOUNT,0) THEN
																UM.AMOUNT ELSE SUM(UM.AMOUNT)OVER(PARTITION BY UM.NO_SO, UM.BRANCHES, UM.ITEM_CAT, UM.SALESMAN  ORDER BY UM.TGL_UM) - ISNULL(INV.AMOUNT,0)
															END
														  END AS AMOUNT
												FROM	(
															SELECT	DIMS.ITEM_CAT
																	,DIMS.BRANCHES
																	,CASE WHEN SIH.[No_] = 'UMAT150027' THEN 'HRY' ELSE DIMS.SALESMAN END AS SALESMAN
																	,SIH.[Posting Date] AS TGL_UM
																	,SIH.[No_] AS NO_UM
																	,SIH.[External Document No_] AS NO_PO_CUST
																	,SIH.[Bill-to Customer No_] AS CUST_NO
																	,SIH.[Bill-to Name] AS CUST_NAME
																	,SIH.[Prepayment Order No_] AS NO_SO
																	, (SUM(GLE.[Amount]) * -1) AS AMOUNT
															FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
															LEFT JOIN	(
																			SELECT	DIM.DIM_ID
																					,MAX(DIM.BRANCHES) AS BRANCHES
																					,MAX(DIM.ITEM_CAT) AS ITEM_CAT
																					,MAX(DIM.SALESMAN) AS SALESMAN
																			FROM	(
																						SELECT [Dimension Set ID] AS DIM_ID
																							  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																							  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																							  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																						FROM [AUTOJAYA].[dbo].[AUTOJAYA$Dimension Set Entry]
																					) DIM
																			GROUP BY DIM.DIM_ID
																		) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
															LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
															LEFT JOIN	(
																			SELECT CLE.[Entry No_]
																					, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE.[Document No_] ELSE CLE2.[Document No_] END AS NO_UM
																					, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE2.[Document No_] ELSE CLE.[Document No_] END AS NO_CM
																			FROM [AUTOJAYA].[dbo].[AUTOJAYA$Cust_ Ledger Entry] CLE
																			LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Cust_ Ledger Entry] CLE2 ON CLE2.[Entry No_] = CLE.[Closed by Entry No_]
																			WHERE CLE.[Document Type] IN (2,3)
																			AND ((CLE.[Document No_]  LIKE 'UM%' AND CLE2.[Document Type] = 3) OR
																				(CLE2.[Document No_]  LIKE 'UM%' AND CLE.[Document Type] = 3) )
																		) CM ON CM.NO_UM = GLE.[Document No_]
															LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Cr_Memo Header] CMH ON CMH.[No_] = CM.NO_CM
															WHERE GLE.[G_L Account No_] = '400.110.03'
																  AND GLE.[Document No_] LIKE 'UM%'
																  AND CM.NO_CM IS NULL
																  AND (SIH.[Posting Date] < $P{TglInvFrom})
															GROUP BY DIMS.ITEM_CAT
																	 ,DIMS.BRANCHES
																	 ,DIMS.SALESMAN
																	 ,SIH.[Posting Date]
																	 ,SIH.[No_]
																	 ,SIH.[External Document No_]
																	 ,SIH.[Bill-to Customer No_]
																	 ,SIH.[Bill-to Name]
																	 ,SIH.[Prepayment Order No_]
														) UM
												LEFT JOIN	(
																SELECT	DIMS.ITEM_CAT
																		,DIMS.BRANCHES
																		,DIMS.SALESMAN
																		,SIH.[Order No_] AS NO_SO
																		,MAX(SIH.[Posting Date]) AS TGL_INV
																		,SUM(GLE.[Amount]) AS AMOUNT
																FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
																LEFT JOIN	(
																				SELECT	DIM.DIM_ID
																						,MAX(DIM.BRANCHES) AS BRANCHES
																						,MAX(DIM.ITEM_CAT) AS ITEM_CAT
																						,MAX(DIM.SALESMAN) AS SALESMAN
																				FROM	(
																							SELECT [Dimension Set ID] AS DIM_ID
																								  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																								  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																								  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																							FROM [AUTOJAYA].[dbo].[AUTOJAYA$Dimension Set Entry]
																						) DIM
																				GROUP BY DIM.DIM_ID
																			) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
																LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
																WHERE GLE.[G_L Account No_] = '400.110.03'
																	  AND GLE.[Document No_] NOT LIKE 'UM%'
																	  AND (GLE.[Posting Date] >= $P{TglInvFrom} AND GLE.[Posting Date] <= $P{TglInvTo})
																GROUP BY DIMS.ITEM_CAT
																		,DIMS.BRANCHES
																		,DIMS.SALESMAN
																		,SIH.[Order No_]
															) INV ON INV.NO_SO = UM.NO_SO AND INV.BRANCHES = UM.BRANCHES AND INV.ITEM_CAT = UM.ITEM_CAT AND INV.SALESMAN = UM.SALESMAN
											) OUM
									WHERE OUM.AMOUNT > 0
								) ASPY
						GROUP BY ASPY.BRANCHES, ASPY.ITEM_CAT, ASPY.SALESMAN
						UNION ALL
						SELECT	'(-/+) Others Management Adjustment - ALL' AS NOTE
								,DIMS.BRANCHES
								,DIMS.ITEM_CAT
								,DIMS.SALESMAN
								,SUM(GLE.[Amount]) * -1 AS AMOUNT
						FROM [AUTOJAYA].[dbo].[AJ-ADJ$G_L Entry] GLE
						LEFT JOIN	(
										SELECT	DIM.DIM_ID
												,MAX(DIM.BRANCHES) AS BRANCHES
												,MAX(DIM.ITEM_CAT) AS ITEM_CAT
												,MAX(DIM.SALESMAN) AS SALESMAN
										FROM	(
													SELECT [Dimension Set ID] AS DIM_ID
														  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
														  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
														  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
													FROM [AUTOJAYA].[dbo].[AJ-ADJ$Dimension Set Entry]
												) DIM
										GROUP BY DIM.DIM_ID
									) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
						WHERE	(GLE.[G_L Account No_] BETWEEN '400.110.00'  AND '420.110.01') AND
								GLE.[G_L Account No_] <> '400.110.04' AND
								DIMS.ITEM_CAT <> '' AND
								(GLE.[Posting Date] >= $P{TglInvFrom} AND GLE.[Posting Date] <=  $P{TglInvTo})
						GROUP BY DIMS.BRANCHES, DIMS.ITEM_CAT, DIMS.SALESMAN
						UNION ALL
						SELECT	'(-/+) Others Management Adjustment - SALES LAINNYA' AS NOTE
								,'10' BRANCHES
								,'HW01' AS ITEM_CAT
								,'OFC' AS SALESMAN
								,SUM(GLE.[Amount]) * -1 AS AMOUNT
						FROM [AUTOJAYA].[dbo].[AJ-ADJ$G_L Entry] GLE
						LEFT JOIN	(
										SELECT	DIM.DIM_ID
												,MAX(DIM.BRANCHES) AS BRANCHES
												,MAX(DIM.ITEM_CAT) AS ITEM_CAT
												,MAX(DIM.SALESMAN) AS SALESMAN
										FROM	(
													SELECT [Dimension Set ID] AS DIM_ID
														  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
														  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
														  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
													FROM [AUTOJAYA].[dbo].[AJ-ADJ$Dimension Set Entry]
												) DIM
										GROUP BY DIM.DIM_ID
									) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
						WHERE	GLE.[G_L Account No_] = '400.110.04' AND
								(GLE.[Posting Date] >= $P{TglInvFrom} AND GLE.[Posting Date] <=  $P{TglInvTo})
						GROUP BY DIMS.BRANCHES, DIMS.ITEM_CAT, DIMS.SALESMAN
						UNION ALL
						SELECT	'SALES CORRECTION - FA/INTERCOY' AS NOTE
								, SLC.BRANCHES
								, SLC.ITEM_CAT
								, SLC.SALESMAN
								, SUM(SLC.[Amount]) AS AMOUNT
						FROM	(
									SELECT	DIMS.BRANCHES
											,DIMS.ITEM_CAT
											,DIMS.SALESMAN
											,CASE WHEN GLE.[Source No_] = 'SOPE001' THEN '2. Sales INTERCOY' ELSE '1. Sales FA' END AS SALES_TITLE
											,CASE WHEN GLE.[Source No_] = 'SOPE001' THEN '(-) Sales INTERCOY' ELSE '(-) Sales FA' END AS SALES_TITLE2
											,CASE WHEN GLE.[Source No_] = 'SOPE001' THEN 'SLS-0302' ELSE 'SLS-0301' END AS SORT_SLS
											, GLE.[Amount]
									FROM [AUTOJAYA].[dbo].[AUTOJAYA$G_L Entry] GLE
									LEFT JOIN	(
													SELECT	DIM.DIM_ID
															,MAX(DIM.BRANCHES) AS BRANCHES
															,MAX(DIM.ITEM_CAT) AS ITEM_CAT
															,MAX(DIM.SALESMAN) AS SALESMAN
													FROM	(
																SELECT [Dimension Set ID] AS DIM_ID
																	  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																	  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																	  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																FROM [AUTOJAYA].[dbo].[AUTOJAYA$Dimension Set Entry]
															) DIM
													GROUP BY DIM.DIM_ID
												) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
									WHERE GLE.[G_L Account No_] IN ('400.110.01', '410.110.01', '420.110.01')
											AND GLE.[Posting Date] >= $P{TglInvFrom} AND GLE.[Posting Date] <=  $P{TglInvTo}
								) SLC
						GROUP BY SLC.BRANCHES, SLC.ITEM_CAT, SLC.SALESMAN
						UNION ALL
						SELECT	'SALES CORRECTION - FA/INTERCOY ADJ' AS NOTE
								, SLC.BRANCHES
								, SLC.ITEM_CAT
								, SLC.SALESMAN
								, SUM(SLC.[Amount]) AS AMOUNT
						FROM	(
									SELECT	'3. Others Sales Adjustment' AS SALES_TITLE
											,'(-/+) Others Management Adjustment' AS SALES_TITLE2
											,'SLS-0303' AS SORT_SLS
											, DIMS.BRANCHES
											, DIMS.ITEM_CAT
											, DIMS.SALESMAN
											, GLE.[Amount]
									FROM [AUTOJAYA].[dbo].[AJ-ADJ$G_L Entry] GLE
									LEFT JOIN	(
													SELECT	DIM.DIM_ID
															,MAX(DIM.BRANCHES) AS BRANCHES
															,MAX(DIM.ITEM_CAT) AS ITEM_CAT
															,MAX(DIM.SALESMAN) AS SALESMAN
													FROM	(
																SELECT [Dimension Set ID] AS DIM_ID
																	  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																	  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																	  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																FROM [AUTOJAYA].[dbo].[AJ-ADJ$Dimension Set Entry]
															) DIM
													GROUP BY DIM.DIM_ID
												) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
									WHERE GLE.[G_L Account No_] IN ('400.110.01', '410.110.01', '420.110.01')
											AND GLE.[Posting Date] >= $P{TglInvFrom} AND GLE.[Posting Date] <=  $P{TglInvTo}
								) SLC
						GROUP BY SLC.BRANCHES, SLC.ITEM_CAT, SLC.SALESMAN
						UNION ALL
						SELECT	'SALES ALL' AS NOTE
								, DIMS.BRANCHES
								, DIMS.ITEM_CAT
								, DIMS.SALESMAN
								, SUM(GLE.[Amount]) * -1 AS AMOUNT
						FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
						LEFT JOIN	(
										SELECT	DIM.DIM_ID
												,MAX(DIM.BRANCHES) AS BRANCHES
												,MAX(DIM.ITEM_CAT) AS ITEM_CAT
												,MAX(DIM.SALESMAN) AS SALESMAN
										FROM	(
													SELECT [Dimension Set ID] AS DIM_ID
														  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
														  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
														  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
													FROM [AUTOJAYA].[dbo].[SOLUSI$Dimension Set Entry]
												) DIM
										GROUP BY DIM.DIM_ID
									) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
						WHERE	(GLE.[G_L Account No_] BETWEEN '400.110.00'  AND '420.110.01') AND
								GLE.[G_L Account No_] <> '400.110.04' AND
								DIMS.ITEM_CAT <> ''AND
								(GLE.[Posting Date] >= $P{TglInvFrom} AND GLE.[Posting Date] <=  $P{TglInvTo})
						GROUP BY DIMS.BRANCHES, DIMS.ITEM_CAT, DIMS.SALESMAN
						UNION ALL
						SELECT	'Sales - LAINNYA' AS NOTE
								,'10' BRANCHES
								,'HW01' AS ITEM_CAT
								,'OFC' AS SALESMAN
								, SUM(GLE.[Amount]) * -1 AS AMOUNT
						FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
						LEFT JOIN	(
										SELECT	DIM.DIM_ID
												,MAX(DIM.BRANCHES) AS BRANCHES
												,MAX(DIM.ITEM_CAT) AS ITEM_CAT
												,MAX(DIM.SALESMAN) AS SALESMAN
										FROM	(
													SELECT [Dimension Set ID] AS DIM_ID
														  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
														  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
														  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
													FROM [AUTOJAYA].[dbo].[SOLUSI$Dimension Set Entry]
												) DIM
										GROUP BY DIM.DIM_ID
									) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
						WHERE	GLE.[G_L Account No_] = '400.110.04' AND
								(GLE.[Posting Date] >= $P{TglInvFrom} AND GLE.[Posting Date] <=  $P{TglInvTo})
						UNION ALL
						SELECT	'(-) Accured Sales Current Year' AS NOTE
								,ASCY.BRANCHES
								,ASCY.ITEM_CAT
								,ASCY.SALESMAN
								,SUM(ASCY.AMOUNT) * -1 AS AMOUNT
						FROM (
								SELECT	OUM.ITEM_CAT
										,OUM.BRANCHES
										,OUM.SALESMAN
										,OUM.AMOUNT
								FROM	(
											SELECT	UM.ITEM_CAT
													,UM.BRANCHES
													,UM.SALESMAN
													,CASE WHEN ISNULL(INV.AMOUNT,0) = 0 THEN UM.AMOUNT ELSE
														CASE WHEN SUM(UM.AMOUNT)OVER(PARTITION BY UM.NO_SO, UM.BRANCHES, UM.ITEM_CAT, UM.SALESMAN  ORDER BY UM.TGL_UM) <= ISNULL(INV.AMOUNT,0) THEN 0 ELSE
														SUM(UM.AMOUNT)OVER(PARTITION BY UM.NO_SO, UM.BRANCHES, UM.ITEM_CAT, UM.SALESMAN  ORDER BY UM.TGL_UM) - ISNULL(INV.AMOUNT,0)
													END
													END	 AS AMOUNT
											FROM	(
														SELECT	DIMS.ITEM_CAT
																,DIMS.BRANCHES
																,DIMS.SALESMAN
																,SIH.[Posting Date] AS TGL_UM
																,SIH.[No_] AS NO_UM
																,SIH.[External Document No_] AS NO_PO_CUST
																,SIH.[Bill-to Customer No_] AS CUST_NO
																,SIH.[Bill-to Name] AS CUST_NAME
																,SIH.[Prepayment Order No_] AS NO_SO
																, (SUM(GLE.[Amount]) * -1) AS AMOUNT
														FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
														LEFT JOIN	(
																		SELECT	DIM.DIM_ID
																				,MAX(DIM.BRANCHES) AS BRANCHES
																				,MAX(DIM.ITEM_CAT) AS ITEM_CAT
																				,MAX(DIM.SALESMAN) AS SALESMAN
																		FROM	(
																					SELECT [Dimension Set ID] AS DIM_ID
																						  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																						  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																						  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																					FROM [AUTOJAYA].[dbo].[SOLUSI$Dimension Set Entry]
																				) DIM
																		GROUP BY DIM.DIM_ID
																	) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
														LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
														LEFT JOIN	(
																		SELECT CLE.[Entry No_]
																				, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE.[Document No_] ELSE CLE2.[Document No_] END AS NO_UM
																				, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE2.[Document No_] ELSE CLE.[Document No_] END AS NO_CM
																		FROM [AUTOJAYA].[dbo].[SOLUSI$Cust_ Ledger Entry] CLE
																		LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Cust_ Ledger Entry] CLE2 ON CLE2.[Entry No_] = CLE.[Closed by Entry No_]
																		WHERE CLE.[Document Type] IN (2,3)
																		AND ((CLE.[Document No_]  LIKE 'UM%' AND CLE2.[Document Type] = 3) OR
																			(CLE2.[Document No_]  LIKE 'UM%' AND CLE.[Document Type] = 3) )
																	) CM ON CM.NO_UM = GLE.[Document No_]
														LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Cr_Memo Header] CMH ON CMH.[No_] = CM.NO_CM
														WHERE GLE.[G_L Account No_] = '400.110.03'
															  AND GLE.[Document No_] LIKE 'UM%'
															  AND (CM.NO_CM IS NULL OR (CM.NO_CM IS NOT NULL AND CMH.[Posting Date] > $P{TglInvTo} ))
															  AND (SIH.[Posting Date] >= $P{TglInvFrom} AND SIH.[Posting Date]<= $P{TglInvTo})
														GROUP BY DIMS.ITEM_CAT
																 ,DIMS.BRANCHES
																 ,DIMS.SALESMAN
																 ,SIH.[Posting Date]
																 ,SIH.[No_]
																 ,SIH.[External Document No_]
																 ,SIH.[Bill-to Customer No_]
																 ,SIH.[Bill-to Name]
																 ,SIH.[Prepayment Order No_]
													) UM
											LEFT JOIN	(
															SELECT	DIMS.ITEM_CAT
																	,DIMS.BRANCHES
																	,DIMS.SALESMAN
																	,SIH.[Order No_] AS NO_SO
																	,MAX(SIH.[Posting Date]) AS TGL_INV
																	,SUM(GLE.[Amount]) AS AMOUNT
															FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
															LEFT JOIN	(
																			SELECT	DIM.DIM_ID
																					,MAX(DIM.BRANCHES) AS BRANCHES
																					,MAX(DIM.ITEM_CAT) AS ITEM_CAT
																					,MAX(DIM.SALESMAN) AS SALESMAN
																			FROM	(
																						SELECT [Dimension Set ID] AS DIM_ID
																							  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																							  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																							  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																						FROM [AUTOJAYA].[dbo].[SOLUSI$Dimension Set Entry]
																					) DIM
																			GROUP BY DIM.DIM_ID
																		) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
															LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
															WHERE GLE.[G_L Account No_] = '400.110.03'
																  AND GLE.[Document No_] NOT LIKE 'UM%'
																  AND GLE.[Posting Date] <=  $P{TglInvTo}
															GROUP BY DIMS.ITEM_CAT
																	,DIMS.BRANCHES
																	,DIMS.SALESMAN
																	,SIH.[Order No_]
														) INV ON INV.NO_SO = UM.NO_SO AND INV.BRANCHES = UM.BRANCHES AND INV.ITEM_CAT = UM.ITEM_CAT AND INV.SALESMAN = UM.SALESMAN
										) OUM
								WHERE OUM.AMOUNT > 0
							 ) ASCY
						GROUP BY ASCY.BRANCHES, ASCY.ITEM_CAT, ASCY.SALESMAN
						UNION ALL
						SELECT	'(+) Accured Sales Previous Year' AS NOTE
								,ASPY.BRANCHES
								,ASPY.ITEM_CAT
								,ASPY.SALESMAN
								, SUM(ASPY.AMOUNT) AS AMOUNT
						FROM	(
									SELECT	OUM.ITEM_CAT
											,OUM.BRANCHES
											,OUM.SALESMAN
											,OUM.AMOUNT
									FROM	(
												SELECT	UM.ITEM_CAT
														, UM.BRANCHES
														, UM.SALESMAN
														, CASE WHEN ISNULL(INV.AMOUNT,0) =  0 THEN 0 ELSE
															CASE WHEN SUM(UM.AMOUNT)OVER(PARTITION BY UM.NO_SO, UM.BRANCHES, UM.ITEM_CAT, UM.SALESMAN  ORDER BY UM.TGL_UM) <= ISNULL(INV.AMOUNT,0) THEN
																UM.AMOUNT ELSE SUM(UM.AMOUNT)OVER(PARTITION BY UM.NO_SO, UM.BRANCHES, UM.ITEM_CAT, UM.SALESMAN ORDER BY UM.TGL_UM) - ISNULL(INV.AMOUNT,0)
															END
														  END AS AMOUNT
												FROM	(
															SELECT	DIMS.ITEM_CAT
																	,DIMS.BRANCHES
																	,CASE WHEN SIH.[No_] = 'UMST150023' THEN 'ARH' ELSE DIMS.SALESMAN END AS SALESMAN
																	,SIH.[Posting Date] AS TGL_UM
																	,SIH.[No_] AS NO_UM
																	,SIH.[External Document No_] AS NO_PO_CUST
																	,SIH.[Bill-to Customer No_] AS CUST_NO
																	,SIH.[Bill-to Name] AS CUST_NAME
																	,SIH.[Prepayment Order No_] AS NO_SO
																	, (SUM(GLE.[Amount]) * -1) AS AMOUNT
															FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
															LEFT JOIN	(
																			SELECT	DIM.DIM_ID
																					,MAX(DIM.BRANCHES) AS BRANCHES
																					,MAX(DIM.ITEM_CAT) AS ITEM_CAT
																					,MAX(DIM.SALESMAN) AS SALESMAN
																			FROM	(
																						SELECT [Dimension Set ID] AS DIM_ID
																							  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																							  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																							  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																						FROM [AUTOJAYA].[dbo].[SOLUSI$Dimension Set Entry]
																					) DIM
																			GROUP BY DIM.DIM_ID
																		) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
															LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
															LEFT JOIN	(
																			SELECT CLE.[Entry No_]
																					, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE.[Document No_] ELSE CLE2.[Document No_] END AS NO_UM
																					, CASE WHEN CLE.[Document No_] LIKE 'UM%' THEN CLE2.[Document No_] ELSE CLE.[Document No_] END AS NO_CM
																			FROM [AUTOJAYA].[dbo].[SOLUSI$Cust_ Ledger Entry] CLE
																			LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Cust_ Ledger Entry] CLE2 ON CLE2.[Entry No_] = CLE.[Closed by Entry No_]
																			WHERE CLE.[Document Type] IN (2,3)
																			AND ((CLE.[Document No_]  LIKE 'UM%' AND CLE2.[Document Type] = 3) OR
																				(CLE2.[Document No_]  LIKE 'UM%' AND CLE.[Document Type] = 3) )
																		) CM ON CM.NO_UM = GLE.[Document No_]
															LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Cr_Memo Header] CMH ON CMH.[No_] = CM.NO_CM
															WHERE GLE.[G_L Account No_] = '400.110.03'
																  AND GLE.[Document No_] LIKE 'UM%'
																  AND CM.NO_CM IS NULL
																  AND (SIH.[Posting Date] < $P{TglInvFrom})
															GROUP BY DIMS.ITEM_CAT
																	 ,DIMS.BRANCHES
																	 ,DIMS.SALESMAN
																	 ,SIH.[Posting Date]
																	 ,SIH.[No_]
																	 ,SIH.[External Document No_]
																	 ,SIH.[Bill-to Customer No_]
																	 ,SIH.[Bill-to Name]
																	 ,SIH.[Prepayment Order No_]
														) UM
												LEFT JOIN	(
																SELECT	DIMS.ITEM_CAT
																		,DIMS.BRANCHES
																		,DIMS.SALESMAN
																		,SIH.[Order No_] AS NO_SO
																		,MAX(SIH.[Posting Date]) AS TGL_INV
																		,SUM(GLE.[Amount]) AS AMOUNT
																FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
																LEFT JOIN	(
																				SELECT	DIM.DIM_ID
																						,MAX(DIM.BRANCHES) AS BRANCHES
																						,MAX(DIM.ITEM_CAT) AS ITEM_CAT
																						,MAX(DIM.SALESMAN) AS SALESMAN
																				FROM	(
																							SELECT [Dimension Set ID] AS DIM_ID
																								  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																								  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																								  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																							FROM [AUTOJAYA].[dbo].[SOLUSI$Dimension Set Entry]
																						) DIM
																				GROUP BY DIM.DIM_ID
																			) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
																LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] SIH ON SIH.[No_] = GLE.[Document No_]
																WHERE GLE.[G_L Account No_] = '400.110.03'
																	  AND GLE.[Document No_] NOT LIKE 'UM%'
																	  AND (GLE.[Posting Date] >= $P{TglInvFrom} AND GLE.[Posting Date] <= $P{TglInvTo})
																GROUP BY DIMS.ITEM_CAT
																		,DIMS.BRANCHES
																		,DIMS.SALESMAN
																		,SIH.[Order No_]
															) INV ON INV.NO_SO = UM.NO_SO AND INV.BRANCHES = UM.BRANCHES AND INV.ITEM_CAT = UM.ITEM_CAT AND INV.SALESMAN = UM.SALESMAN
											) OUM
									WHERE OUM.AMOUNT > 0
								) ASPY
						GROUP BY ASPY.BRANCHES, ASPY.ITEM_CAT, ASPY.SALESMAN
						UNION ALL
						SELECT	'(-/+) Others Management Adjustment - ALL' AS NOTE
								,DIMS.BRANCHES
								,DIMS.ITEM_CAT
								,DIMS.SALESMAN
								, SUM(GLE.[Amount]) * -1 AS AMOUNT
						FROM [AUTOJAYA].[dbo].[SP-ADJ$G_L Entry] GLE
						LEFT JOIN	(
										SELECT	DIM.DIM_ID
												,MAX(DIM.BRANCHES) AS BRANCHES
												,MAX(DIM.ITEM_CAT) AS ITEM_CAT
												,MAX(DIM.SALESMAN) AS SALESMAN
										FROM	(
													SELECT [Dimension Set ID] AS DIM_ID
														  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
														  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
														  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
													FROM [AUTOJAYA].[dbo].[SP-ADJ$Dimension Set Entry]
												) DIM
										GROUP BY DIM.DIM_ID
									) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
						WHERE	(GLE.[G_L Account No_] BETWEEN '400.110.00'  AND '420.110.01') AND
								GLE.[G_L Account No_] <> '400.110.04' AND
								DIMS.ITEM_CAT <> '' AND
								(GLE.[Posting Date] >= $P{TglInvFrom} AND GLE.[Posting Date] <= $P{TglInvTo})
						GROUP BY DIMS.BRANCHES, DIMS.ITEM_CAT, DIMS.SALESMAN
						UNION ALL
						SELECT	'(-/+) Others Management Adjustment - SALES LAINNYA' AS NOTE
								,'10' BRANCHES
								,'HW01' AS ITEM_CAT
								,'OFC' AS SALESMAN
								, SUM(GLE.[Amount]) * -1 AS AMOUNT
						FROM [AUTOJAYA].[dbo].[SP-ADJ$G_L Entry] GLE
						LEFT JOIN	(
										SELECT	DIM.DIM_ID
												,MAX(DIM.BRANCHES) AS BRANCHES
												,MAX(DIM.ITEM_CAT) AS ITEM_CAT
												,MAX(DIM.SALESMAN) AS SALESMAN
										FROM	(
													SELECT [Dimension Set ID] AS DIM_ID
														  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
														  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
														  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
													FROM [AUTOJAYA].[dbo].[SP-ADJ$Dimension Set Entry]
												) DIM
										GROUP BY DIM.DIM_ID
									) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
						WHERE	GLE.[G_L Account No_] = '400.110.04' AND
								(GLE.[Posting Date] >= $P{TglInvFrom} AND GLE.[Posting Date] <= $P{TglInvTo})
						UNION ALL
						SELECT	'SALES CORRECTION - FA/INTERCOY' AS NOTE
								, SLC.BRANCHES
								, SLC.ITEM_CAT
								, SLC.SALESMAN
								, SUM(SLC.[Amount]) AS AMOUNT
						FROM	(
									SELECT	CASE WHEN GLE.[Source No_] <> 'SOPE001' THEN '2. Sales INTERCOY' ELSE '1. Sales FA' END AS SALES_TITLE
											,CASE WHEN GLE.[Source No_] <> 'SOPE001' THEN '(-) Sales INTERCOY' ELSE '(-) Sales FA' END AS SALES_TITLE2
											,CASE WHEN GLE.[Source No_] <> 'SOPE001' THEN 'SLS-0302' ELSE 'SLS-0301' END AS SORT_SLS
											, DIMS.BRANCHES
											, DIMS.ITEM_CAT
											, DIMS.SALESMAN
											, GLE.[Amount]
									FROM [AUTOJAYA].[dbo].[SOLUSI$G_L Entry] GLE
									LEFT JOIN	(
													SELECT	DIM.DIM_ID
															,MAX(DIM.BRANCHES) AS BRANCHES
															,MAX(DIM.ITEM_CAT) AS ITEM_CAT
															,MAX(DIM.SALESMAN) AS SALESMAN
													FROM	(
																SELECT [Dimension Set ID] AS DIM_ID
																	  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																	  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																	  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																FROM [AUTOJAYA].[dbo].[SOLUSI$Dimension Set Entry]
															) DIM
													GROUP BY DIM.DIM_ID
												) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
									WHERE GLE.[G_L Account No_] IN ('400.110.01', '410.110.01', '420.110.01')
											AND (GLE.[Posting Date] >= $P{TglInvFrom} AND GLE.[Posting Date] <= $P{TglInvTo})
								) SLC
						GROUP BY SLC.BRANCHES, SLC.ITEM_CAT, SLC.SALESMAN
						UNION ALL
						SELECT	'SALES CORRECTION - FA/INTERCOY ADJ' AS NOTE
								, SLC.BRANCHES
								, SLC.ITEM_CAT
								, SLC.SALESMAN
								, SUM(SLC.[Amount]) AS AMOUNT
						FROM	(
									SELECT	'3. Others Sales Adjustment' AS SALES_TITLE
											,'(-/+) Others Management Adjustment' AS SALES_TITLE2
											,'SLS-0303' AS SORT_SLS
											, DIMS.BRANCHES
											, DIMS.ITEM_CAT
											, DIMS.SALESMAN
											, GLE.[Amount]
									FROM [AUTOJAYA].[dbo].[SP-ADJ$G_L Entry] GLE
									LEFT JOIN	(
													SELECT	DIM.DIM_ID
															,MAX(DIM.BRANCHES) AS BRANCHES
															,MAX(DIM.ITEM_CAT) AS ITEM_CAT
															,MAX(DIM.SALESMAN) AS SALESMAN
													FROM	(
																SELECT [Dimension Set ID] AS DIM_ID
																	  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																	  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																	  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																FROM [AUTOJAYA].[dbo].[SP-ADJ$Dimension Set Entry]
															) DIM
													GROUP BY DIM.DIM_ID
												) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
									WHERE GLE.[G_L Account No_] IN ('400.110.01', '410.110.01', '420.110.01')
											AND GLE.[Posting Date] >= $P{TglInvFrom} AND GLE.[Posting Date] <=  $P{TglInvTo}
								) SLC
						GROUP BY SLC.BRANCHES, SLC.ITEM_CAT, SLC.SALESMAN
						) X
					) XX
			GROUP BY XX.GROUP_ITEM_CAT, XX.ITEM_CAT
			UNION ALL
			SELECT	2 AS GROUP_NO
					,'Uang Muka (as per Today)' AS GROUP_DESC
					, OSO.GROUP_ITEM_CAT
					, OSO.ITEM_CAT
					,(SUM(OSO.AMT_HO)) AS AMT_HO
					,(SUM(OSO.AMT_SBY)) AS AMT_SBY
					,(SUM(OSO.AMT_DPS)) AS AMT_DPS
					,(SUM(OSO.AMT_CKR)) AS AMT_CKR
					,(SUM(OSO.AMT_SMR)) AS AMT_SMR
			FROM	(
						SELECT	'OS1' AS GROUP_ITEM_CAT
								,'Uang Muka' AS ITEM_CAT
								,(SUM(UMX.AMT_HO)*-1) AS AMT_HO
								,(SUM(UMX.AMT_SBY)*-1) AS AMT_SBY
								,(SUM(UMX.AMT_DPS)*-1) AS AMT_DPS
								,(SUM(UMX.AMT_CKR)*-1) AS AMT_CKR
								,(SUM(UMX.AMT_SMR)*-1) AS AMT_SMR
						FROM	(
									SELECT	DIMS.ITEM_CAT
											,CASE WHEN DIMS.BRANCHES = '10' THEN SUM(GLE.[Amount]) * -1 ELSE 0 END AS AMT_HO
											,CASE WHEN DIMS.BRANCHES = '15' THEN SUM(GLE.[Amount]) * -1 ELSE 0 END AS AMT_SBY
											,CASE WHEN DIMS.BRANCHES = '19' THEN SUM(GLE.[Amount]) * -1 ELSE 0 END AS AMT_DPS
											,CASE WHEN DIMS.BRANCHES = '16' THEN SUM(GLE.[Amount]) * -1 ELSE 0 END AS AMT_CKR
											,CASE WHEN DIMS.BRANCHES = '17' THEN SUM(GLE.[Amount]) * -1 ELSE 0 END AS AMT_SMR
									FROM [AUTOJAYA].[dbo].[AJ-ADJ$G_L Entry] GLE
									LEFT JOIN	(
													SELECT	DIM.DIM_ID
															,MAX(DIM.BRANCHES) AS BRANCHES
															,MAX(DIM.ITEM_CAT) AS ITEM_CAT
															,MAX(DIM.SALESMAN) AS SALESMAN
													FROM	(
																SELECT [Dimension Set ID] AS DIM_ID
																	  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																	  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																	  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																FROM [AUTOJAYA].[dbo].[AJ-ADJ$Dimension Set Entry]
															) DIM
													GROUP BY DIM.DIM_ID
												) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
									WHERE	GLE.[G_L Account No_] = '400.110.00' AND
											GLE.[Source Code] <> 'CLSINCOME' AND
											GLE.[Document No_] NOT LIKE 'OBAL-CLOSE%' AND
											GLE.[Document No_] NOT LIKE 'JV-SNUM%' AND
											GLE.[Posting Date] <=  $P{TglInvTo}
									GROUP BY DIMS.BRANCHES, DIMS.ITEM_CAT
									UNION ALL
									SELECT	DIMS.ITEM_CAT
											,CASE WHEN DIMS.BRANCHES = '10' THEN SUM(GLE.[Amount]) * -1 ELSE 0 END AS AMT_HO
											,CASE WHEN DIMS.BRANCHES = '15' THEN SUM(GLE.[Amount]) * -1 ELSE 0 END AS AMT_SBY
											,CASE WHEN DIMS.BRANCHES = '19' THEN SUM(GLE.[Amount]) * -1 ELSE 0 END AS AMT_DPS
											,CASE WHEN DIMS.BRANCHES = '16' THEN SUM(GLE.[Amount]) * -1 ELSE 0 END AS AMT_CKR
											,CASE WHEN DIMS.BRANCHES = '17' THEN SUM(GLE.[Amount]) * -1 ELSE 0 END AS AMT_SMR
									FROM [AUTOJAYA].[dbo].[SP-ADJ$G_L Entry] GLE
									LEFT JOIN	(
													SELECT	DIM.DIM_ID
															,MAX(DIM.BRANCHES) AS BRANCHES
															,MAX(DIM.ITEM_CAT) AS ITEM_CAT
															,MAX(DIM.SALESMAN) AS SALESMAN
													FROM	(
																SELECT [Dimension Set ID] AS DIM_ID
																	  ,CASE WHEN [Dimension Code] = 'BRANCHES' THEN [Dimension Value Code] ELSE NULL END AS BRANCHES
																	  ,CASE WHEN [Dimension Code] = 'ITEM CATEGORY' THEN [Dimension Value Code] ELSE NULL END AS ITEM_CAT
																	  ,CASE WHEN [Dimension Code] = 'SALESMAN' THEN [Dimension Value Code] ELSE NULL END AS SALESMAN
																FROM [AUTOJAYA].[dbo].[SP-ADJ$Dimension Set Entry]
															) DIM
													GROUP BY DIM.DIM_ID
												) DIMS ON DIMS.DIM_ID = GLE.[Dimension Set ID]
									WHERE	GLE.[G_L Account No_] = '400.110.00' AND
											GLE.[Source Code] <> 'CLSINCOME'AND
											GLE.[Document No_] NOT LIKE 'OBAL-CLOSE%' AND
											GLE.[Document No_] NOT LIKE 'JV-SNUM%' AND
											GLE.[Posting Date] <=  $P{TglInvTo}
									GROUP BY DIMS.BRANCHES, DIMS.ITEM_CAT
								) UMX
						UNION ALL
						SELECT	'OS1' AS GROUP_ITEM_CAT
								,'Uang Muka' AS ITEM_CAT
								, CASE WHEN XXX.CABANG = 'JAKARTA' THEN XXX.AMOUNT_UM_IDR ELSE 0 END AS AMT_HO
								, CASE WHEN XXX.CABANG = 'SURABAYA' THEN XXX.AMOUNT_UM_IDR ELSE 0 END AS AMT_SBY
								, CASE WHEN XXX.CABANG = 'BALI' THEN XXX.AMOUNT_UM_IDR ELSE 0 END AS AMT_DPS
								, CASE WHEN XXX.CABANG = 'CIKARANG' THEN XXX.AMOUNT_UM_IDR ELSE 0 END AS AMT_CKR
								, CASE WHEN XXX.CABANG = 'SEMARANG' THEN XXX.AMOUNT_UM_IDR ELSE 0 END AS AMT_SMR
						FROM	(
									SELECT	'AUTOJAYA' AS COMPANY
											, XY.CABANG
											, XY.CUST_CODE
											, XY.ORDER_DATE
											, XY.STATUS_SO
											, XY.NO_PO_CUST
											, XY.REV_YEAR
											, CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
												(XY.AMOUNT_IDR - XY.UM_AMOUNT_IDR)
												ELSE
												(XY.AMOUNT_IDR - ((XY.UM_AMOUNT_IDR*XY.AMOUNT_IDR)/(XY.AMOUNT_IDR_TTL)))
												END AS AMOUNT_IDR
											, CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
												(XY.UM_AMOUNT_IDR)
												ELSE
												(((XY.UM_AMOUNT_IDR*XY.AMOUNT_IDR)/(XY.AMOUNT_IDR_TTL)))
												END AS AMOUNT_UM_IDR
											, CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
												(XY.AMOUNT - XY.UM_AMOUNT)
												ELSE
												(XY.AMOUNT - ((XY.UM_AMOUNT*XY.AMOUNT) /(XY.AMOUNT_TTL)))
												END AS AMOUNT
									FROM	(
												SELECT SH.[No_] AS NO_SO
														, SUBSTRING( SH.[No_], 1, 4) AS TIPE
														, ISNULL(CAB.[Name], 'JAKARTA') AS CABANG
														, SH.[Bill-to Customer No_] AS CUST_CODE
														, SH.[Order Date] AS ORDER_DATE
														, CASE	WHEN SH.[Status] = 0 THEN 'OPEN'
																WHEN SH.[Status] = 1 THEN 'RELEASED'
																WHEN SH.[Status] = 2 THEN 'PENDING APPROVAL'
																WHEN SH.[Status] = 3 THEN 'RELEASED'
																ELSE '' END AS STATUS_SO
														, SH.[External Document No_] AS NO_PO_CUST
														, ISNULL(CASE WHEN SH.[Currency Code] <> '' THEN ROUND(SL.AMOUNT / SH.[Currency Factor],0) ELSE SL.AMOUNT END,0) AS AMOUNT_IDR
														, ISNULL(SL.AMOUNT,0) AS AMOUNT
														, ISNULL(CASE WHEN SH.[Currency Code] <> '' THEN ROUND(SL2.AMOUNT_TTL / SH.[Currency Factor],0) ELSE SL2.AMOUNT_TTL END,0) AS AMOUNT_IDR_TTL
														, ISNULL(SL2.AMOUNT_TTL,0) AS AMOUNT_TTL
														, ISNULL(UM.UM_AMOUNT_IDR,0) AS UM_AMOUNT_IDR
														, ISNULL(UM.UM_AMOUNT,0) AS UM_AMOUNT
														, SUBSTRING(SH.[Package Tracking No_],1,4) AS REV_YEAR
												FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Header] SH
												LEFT JOIN  (	SELECT X.[Document No_]
																	,SUM(X.QTY) AS QTY
																	,SUM(X.QTY_INV)AS QTY_INV
																	,SUM(X.AMOUNT) AS AMOUNT
																FROM (
																		SELECT [Document No_]
																				, [Quantity] AS QTY
																				, [Quantity Invoiced] AS QTY_INV
																				, CASE WHEN [Quantity Invoiced] <> 0 AND [Quantity] <> [Quantity Invoiced] THEN
																					([Amount] / [Quantity]) * ([Quantity] - [Quantity Invoiced])
																				  ELSE
																					[Amount]
																				  END AS AMOUNT
																		FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Line]
																		WHERE [Document Type] = 1 AND
																		 [Quantity] <> [Quantity Invoiced]
																	) X
																GROUP BY X.[Document No_]
															)SL ON SL.[Document No_] = SH.[No_]
												LEFT JOIN  (
																SELECT [Document No_]
																	 , SUM([Amount]) AS AMOUNT_TTL
																		FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Line]
																		WHERE [Document Type] = 1
																GROUP BY [Document No_]
															)SL2 ON SL2.[Document No_] = SH.[No_]
												LEFT JOIN	(
																SELECT Y.NO_SO
																		,SUM(Y.UM_AMOUNT) AS UM_AMOUNT
																		,SUM(Y.UM_AMOUNT_IDR) AS UM_AMOUNT_IDR
																FROM (
																		SELECT [Prepayment Order No_] AS NO_SO
																			  ,SUM(UMD.[Amount]) AS UM_AMOUNT
																			  ,CASE WHEN UMH.[Currency Code] <> '' THEN ROUND(SUM(UMD.[Amount]) / UMH.[Currency Factor],0) ELSE SUM(UMD.[Amount]) END AS UM_AMOUNT_IDR

																		FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] UMH
																		INNER JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Line] UMD ON UMH.[No_] = UMD.[Document No_]
																		GROUP BY UMH.[Prepayment Order No_], UMH.[Currency Code], UMH.[Currency Factor]
																		UNION ALL
																		SELECT [Prepayment Order No_] AS NO_SO
																			  ,SUM(UMD.[Amount]) * -1 AS UM_AMOUNT
																			  ,CASE WHEN UMH.[Currency Code] <> '' THEN ROUND(SUM(UMD.[Amount]) / UMH.[Currency Factor],0) ELSE SUM(UMD.[Amount]) * -1 END AS UM_AMOUNT_IDR

																		FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Cr_Memo Header] UMH
																		INNER JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Cr_Memo Line] UMD ON UMH.[No_] = UMD.[Document No_]
																		GROUP BY UMH.[Prepayment Order No_], UMH.[Currency Code], UMH.[Currency Factor]
																	) Y
																GROUP BY Y.NO_SO
															) UM ON UM.NO_SO = SH.[No_]
												LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Responsibility Center] CAB ON CAB.[Code] = SH.[Shortcut Dimension 1 Code]
												WHERE SH.[Document Type] = 1
											) XY
									WHERE	(	(XY.TIPE <> 'SOAR') OR
												(SUBSTRING(CONVERT(varchar, XY.ORDER_DATE, 105), 7,4) <= SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) AND XY.TIPE = 'SOAR'))  AND
												((XY.REV_YEAR = '' OR XY.REV_YEAR = SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4)) AND
												XY.STATUS_SO = 'RELEASED')
									UNION ALL
									SELECT	'SOLUSI' AS COMPANY
											, XY.CABANG
											, XY.CUST_CODE
											, XY.ORDER_DATE
											, XY.STATUS_SO
											, XY.NO_PO_CUST
											, XY.REV_YEAR
											, CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
												(XY.AMOUNT_IDR - XY.UM_AMOUNT_IDR)
												ELSE
												(XY.AMOUNT_IDR - ((XY.UM_AMOUNT_IDR*XY.AMOUNT_IDR)/(XY.AMOUNT_IDR_TTL)))
												END AS AMOUNT_IDR
											, CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
												(XY.UM_AMOUNT_IDR)
												ELSE
												(((XY.UM_AMOUNT_IDR*XY.AMOUNT_IDR)/(XY.AMOUNT_IDR_TTL)))
												END AS AMOUNT_UM_IDR
											, CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
												(XY.AMOUNT - XY.UM_AMOUNT)
												ELSE
												(XY.AMOUNT - ((XY.UM_AMOUNT*XY.AMOUNT) /(XY.AMOUNT_TTL)))
												END AS AMOUNT
									FROM	(
												SELECT SH.[No_] AS NO_SO
														, SUBSTRING( SH.[No_], 1, 4) AS TIPE
														, ISNULL(CAB.[Name], 'JAKARTA') AS CABANG
														, SH.[Bill-to Customer No_] AS CUST_CODE
														, SH.[Order Date] AS ORDER_DATE
														, CASE	WHEN SH.[Status] = 0 THEN 'OPEN'
																WHEN SH.[Status] = 1 THEN 'RELEASED'
																WHEN SH.[Status] = 2 THEN 'PENDING APPROVAL'
																WHEN SH.[Status] = 3 THEN 'RELEASED'
																ELSE '' END AS STATUS_SO
														, SH.[External Document No_] AS NO_PO_CUST
														, ISNULL(CASE WHEN SH.[Currency Code] <> '' THEN ROUND(SL.AMOUNT / SH.[Currency Factor],0) ELSE SL.AMOUNT END,0) AS AMOUNT_IDR
														, ISNULL(SL.AMOUNT,0) AS AMOUNT
														, ISNULL(CASE WHEN SH.[Currency Code] <> '' THEN ROUND(SL2.AMOUNT_TTL / SH.[Currency Factor],0) ELSE SL2.AMOUNT_TTL END,0) AS AMOUNT_IDR_TTL
														, ISNULL(SL2.AMOUNT_TTL,0) AS AMOUNT_TTL
														, ISNULL(UM.UM_AMOUNT_IDR,0) AS UM_AMOUNT_IDR
														, ISNULL(UM.UM_AMOUNT,0) AS UM_AMOUNT
														, SUBSTRING(SH.[Package Tracking No_],1,4) AS REV_YEAR
												FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Header] SH
												INNER JOIN  (	SELECT X.[Document No_]
																	,SUM(X.QTY) AS QTY
																	,SUM(X.QTY_INV)AS QTY_INV
																	,SUM(X.AMOUNT) AS AMOUNT
																FROM (
																		SELECT [Document No_]
																				, [Quantity] AS QTY
																				, [Quantity Invoiced] AS QTY_INV
																				, CASE WHEN [Quantity Invoiced] <> 0 AND [Quantity] <> [Quantity Invoiced] THEN
																					([Amount] / [Quantity]) * ([Quantity] - [Quantity Invoiced])
																				  ELSE
																					[Amount]
																				  END AS AMOUNT
																		FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Line]
																		WHERE [Document Type] = 1 AND
																		 [Quantity] <> [Quantity Invoiced]
																	) X
																GROUP BY X.[Document No_]
															)SL ON SL.[Document No_] = SH.[No_]
												LEFT JOIN  (
																SELECT [Document No_]
																	 , SUM([Amount]) AS AMOUNT_TTL
																		FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Line]
																		WHERE [Document Type] = 1
																GROUP BY [Document No_]
															)SL2 ON SL2.[Document No_] = SH.[No_]
												LEFT JOIN	(
																SELECT Y.NO_SO
																		,SUM(Y.UM_AMOUNT) AS UM_AMOUNT
																		,SUM(Y.UM_AMOUNT_IDR) AS UM_AMOUNT_IDR
																FROM (
																		SELECT [Prepayment Order No_] AS NO_SO
																			  ,SUM(UMD.[Amount]) AS UM_AMOUNT
																			  ,CASE WHEN UMH.[Currency Code] <> '' THEN ROUND(SUM(UMD.[Amount]) / UMH.[Currency Factor],0) ELSE SUM(UMD.[Amount]) END AS UM_AMOUNT_IDR

																		FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] UMH
																		INNER JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Line] UMD ON UMH.[No_] = UMD.[Document No_]
																		GROUP BY UMH.[Prepayment Order No_], UMH.[Currency Code], UMH.[Currency Factor]
																		UNION ALL
																		SELECT [Prepayment Order No_] AS NO_SO
																			  ,SUM(UMD.[Amount]) * -1 AS UM_AMOUNT
																			  ,CASE WHEN UMH.[Currency Code] <> '' THEN ROUND(SUM(UMD.[Amount]) / UMH.[Currency Factor],0) ELSE SUM(UMD.[Amount]) * -1 END AS UM_AMOUNT_IDR

																		FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Cr_Memo Header] UMH
																		INNER JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Cr_Memo Line] UMD ON UMH.[No_] = UMD.[Document No_]
																		GROUP BY UMH.[Prepayment Order No_], UMH.[Currency Code], UMH.[Currency Factor]
																	) Y
																GROUP BY Y.NO_SO
															) UM ON UM.NO_SO = SH.[No_]
												LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Responsibility Center] CAB ON CAB.[Code] = SH.[Shortcut Dimension 1 Code]
												WHERE SH.[Document Type] = 1
											) XY
									WHERE	(	(XY.TIPE <> 'SOSR') OR
												(SUBSTRING(CONVERT(varchar, XY.ORDER_DATE, 105), 7,4) <= SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) AND XY.TIPE = 'SOSR'))  AND
												(XY.REV_YEAR = '' OR XY.REV_YEAR = SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4)) AND
												(XY.STATUS_SO = 'RELEASED')
								) XXX
						WHERE  (XXX.COMPANY = $P{Company} OR $P{Company} = 'ALL') AND
								XXX.NO_PO_CUST NOT LIKE '%OTP%' AND XXX.NO_PO_CUST NOT LIKE 'BOOKING%'
								AND XXX.CUST_CODE NOT IN ('AUJA001' , 'AUJA002', 'SOPE001')
				) OSO
			GROUP BY OSO.GROUP_ITEM_CAT, OSO.ITEM_CAT
			UNION ALL
			SELECT	3 AS GROUP_NO
					,	CASE WHEN (DATEPART(quarter, $P{TglInvTo}) IN (1,2)) THEN
							'Outstanding SO (as per Today) - Semester I'
						ELSE
							'Outstanding SO (as per Today) - ALL Semester'
						END AS GROUP_DESC
					, OSO.GROUP_ITEM_CAT
					, OSO.ITEM_CAT
					,(SUM(OSO.AMT_HO)) AS AMT_HO
					,(SUM(OSO.AMT_SBY)) AS AMT_SBY
					,(SUM(OSO.AMT_DPS)) AS AMT_DPS
					,(SUM(OSO.AMT_CKR)) AS AMT_CKR
					,(SUM(OSO.AMT_SMR)) AS AMT_SMR
			FROM	(
			SELECT	'OS2' AS GROUP_ITEM_CAT
					,'Outstanding SO' AS ITEM_CAT
					, CASE WHEN XXX.CABANG = 'JAKARTA' THEN XXX.AMOUNT_IDR ELSE 0 END AS AMT_HO
					, CASE WHEN XXX.CABANG = 'SURABAYA' THEN XXX.AMOUNT_IDR ELSE 0 END AS AMT_SBY
					, CASE WHEN XXX.CABANG = 'BALI' THEN XXX.AMOUNT_IDR ELSE 0 END AS AMT_DPS
					, CASE WHEN XXX.CABANG = 'CIKARANG' THEN XXX.AMOUNT_IDR ELSE 0 END AS AMT_CKR
					, CASE WHEN XXX.CABANG = 'SEMARANG' THEN XXX.AMOUNT_IDR ELSE 0 END AS AMT_SMR
			FROM	(
			SELECT	'AUTOJAYA' AS COMPANY
					, XY.CABANG
					, XY.CUST_CODE
					, XY.ORDER_DATE
					, XY.STATUS_SO
					, XY.NO_PO_CUST
					, XY.REV_YEAR
					,	CASE WHEN	((DATEPART(quarter, $P{TglInvTo}) IN (1,2) AND XY.SEMESTER = 'S1') OR
									 (DATEPART(quarter, $P{TglInvTo}) IN (3,4))) THEN
							CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
								(XY.AMOUNT_IDR - XY.UM_AMOUNT_IDR)
							ELSE
								(XY.AMOUNT_IDR - ((XY.UM_AMOUNT_IDR*XY.AMOUNT_IDR)/(XY.AMOUNT_IDR_TTL)))
							END
						ELSE
							0
						END AS AMOUNT_IDR
					, CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
						(XY.AMOUNT - XY.UM_AMOUNT)
						ELSE
						(XY.AMOUNT - ((XY.UM_AMOUNT*XY.AMOUNT)/(XY.AMOUNT_TTL)))
						END AS AMOUNT
			FROM	(
						SELECT SH.[No_] AS NO_SO
								, SUBSTRING( SH.[No_], 1, 4) AS TIPE
								, ISNULL(CAB.[Name], 'JAKARTA') AS CABANG
								, SH.[Bill-to Customer No_] AS CUST_CODE
								, SH.[Order Date] AS ORDER_DATE
								, CASE	WHEN SH.[Status] = 0 THEN 'OPEN'
										WHEN SH.[Status] = 1 THEN 'RELEASED'
										WHEN SH.[Status] = 2 THEN 'PENDING APPROVAL'
										WHEN SH.[Status] = 3 THEN 'RELEASED'
										ELSE '' END AS STATUS_SO
								, SH.[External Document No_] AS NO_PO_CUST
								, ISNULL(CASE WHEN SH.[Currency Code] <> '' THEN ROUND(SL.AMOUNT / SH.[Currency Factor],0) ELSE SL.AMOUNT END,0) AS AMOUNT_IDR
								, ISNULL(SL.AMOUNT,0) AS AMOUNT
								, ISNULL(CASE WHEN SH.[Currency Code] <> '' THEN ROUND(SL2.AMOUNT_TTL / SH.[Currency Factor],0) ELSE SL2.AMOUNT_TTL END,0) AS AMOUNT_IDR_TTL
								, ISNULL(SL2.AMOUNT_TTL,0) AS AMOUNT_TTL
								, ISNULL(UM.UM_AMOUNT_IDR,0) AS UM_AMOUNT_IDR
								, ISNULL(UM.UM_AMOUNT,0) AS UM_AMOUNT
								, SUBSTRING(SH.[Package Tracking No_],1,4) AS REV_YEAR
								, CASE WHEN SUBSTRING( SH.[No_], 1, 4) = 'SOAR' THEN
									CASE WHEN DATEPART(quarter, SH.[Order Date]) IN (1,2) THEN 'S1' ELSE 'S2' END
								  ELSE
									CASE WHEN SUBSTRING(SH.[Package Tracking No_],5,2) = '' OR  SUBSTRING(SH.[Package Tracking No_],5,2) NOT IN ('S1', 'S2') THEN
										CASE WHEN DATEPART(year, $P{TglInvTo}) <= DATEPART(year, GETDATE()) THEN
											CASE WHEN DATEPART(quarter, GETDATE()) IN (1,2) THEN 'S1' ELSE 'S2' END
										ELSE
											'S1'
										END
									ELSE
										SUBSTRING(SH.[Package Tracking No_],5,2)
									END
								  END AS SEMESTER
						FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Header] SH
						LEFT JOIN  (	SELECT X.[Document No_]
											,SUM(X.QTY) AS QTY
											,SUM(X.QTY_INV)AS QTY_INV
											,SUM(X.AMOUNT) AS AMOUNT
										FROM (
												SELECT [Document No_]
														, [Quantity] AS QTY
														, [Quantity Invoiced] AS QTY_INV
														, CASE WHEN [Quantity Invoiced] <> 0 AND [Quantity] <> [Quantity Invoiced] THEN
															([Amount] / [Quantity]) * ([Quantity] - [Quantity Invoiced])
														  ELSE
															[Amount]
														  END AS AMOUNT
												FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Line]
												WHERE [Document Type] = 1 AND
												 [Quantity] <> [Quantity Invoiced]
											) X
										GROUP BY X.[Document No_]
									)SL ON SL.[Document No_] = SH.[No_]
						LEFT JOIN  (
										SELECT [Document No_]
											 , SUM([Amount]) AS AMOUNT_TTL
												FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Line]
												WHERE [Document Type] = 1
										GROUP BY [Document No_]
									)SL2 ON SL2.[Document No_] = SH.[No_]
						LEFT JOIN	(
										SELECT Y.NO_SO
												,SUM(Y.UM_AMOUNT) AS UM_AMOUNT
												,SUM(Y.UM_AMOUNT_IDR) AS UM_AMOUNT_IDR
										FROM (
												SELECT [Prepayment Order No_] AS NO_SO
													  ,SUM(UMD.[Amount]) AS UM_AMOUNT
													  ,CASE WHEN UMH.[Currency Code] <> '' THEN ROUND(SUM(UMD.[Amount]) / UMH.[Currency Factor],0) ELSE SUM(UMD.[Amount]) END AS UM_AMOUNT_IDR

												FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] UMH
												INNER JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Line] UMD ON UMH.[No_] = UMD.[Document No_]
												GROUP BY UMH.[Prepayment Order No_], UMH.[Currency Code], UMH.[Currency Factor]
												UNION ALL
												SELECT [Prepayment Order No_] AS NO_SO
													  ,SUM(UMD.[Amount]) * -1 AS UM_AMOUNT
													  ,CASE WHEN UMH.[Currency Code] <> '' THEN ROUND(SUM(UMD.[Amount]) / UMH.[Currency Factor],0) ELSE SUM(UMD.[Amount]) * -1 END AS UM_AMOUNT_IDR

												FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Cr_Memo Header] UMH
												INNER JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Cr_Memo Line] UMD ON UMH.[No_] = UMD.[Document No_]
												GROUP BY UMH.[Prepayment Order No_], UMH.[Currency Code], UMH.[Currency Factor]
											) Y
										GROUP BY Y.NO_SO
									) UM ON UM.NO_SO = SH.[No_]
						LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Responsibility Center] CAB ON CAB.[Code] = SH.[Shortcut Dimension 1 Code]
						WHERE SH.[Document Type] = 1
					) XY
			WHERE (	(XY.TIPE <> 'SOAR') OR
					(SUBSTRING(CONVERT(varchar, XY.ORDER_DATE, 105), 7,4) <= SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) AND XY.TIPE = 'SOAR'))  AND
					(XY.REV_YEAR = '' OR XY.REV_YEAR = SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4)) AND
					(XY.STATUS_SO = 'RELEASED')
			UNION ALL
			SELECT	'SOLUSI' AS COMPANY
					, XY.CABANG
					, XY.CUST_CODE
					, XY.ORDER_DATE
					, XY.STATUS_SO
					, XY.NO_PO_CUST
					, XY.REV_YEAR
					,	CASE WHEN	((DATEPART(quarter, $P{TglInvTo}) IN (1,2) AND XY.SEMESTER = 'S1') OR
									 (DATEPART(quarter, $P{TglInvTo}) IN (3,4))) THEN
							CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
								(XY.AMOUNT_IDR - XY.UM_AMOUNT_IDR)
							ELSE
								(XY.AMOUNT_IDR - ((XY.UM_AMOUNT_IDR*XY.AMOUNT_IDR)/(XY.AMOUNT_IDR_TTL)))
							END
						ELSE
							0
						END AS AMOUNT_IDR
					, CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
						(XY.AMOUNT - XY.UM_AMOUNT)
						ELSE
						(XY.AMOUNT - ((XY.UM_AMOUNT*XY.AMOUNT)/(XY.AMOUNT_TTL)))
						END AS AMOUNT
			FROM	(
						SELECT SH.[No_] AS NO_SO
								, SUBSTRING( SH.[No_], 1, 4) AS TIPE
								, ISNULL(CAB.[Name], 'JAKARTA') AS CABANG
								, SH.[Bill-to Customer No_] AS CUST_CODE
								, SH.[Order Date] AS ORDER_DATE
								, CASE	WHEN SH.[Status] = 0 THEN 'OPEN'
										WHEN SH.[Status] = 1 THEN 'RELEASED'
										WHEN SH.[Status] = 2 THEN 'PENDING APPROVAL'
										WHEN SH.[Status] = 3 THEN 'RELEASED'
										ELSE '' END AS STATUS_SO
								, SH.[External Document No_] AS NO_PO_CUST
								, ISNULL(CASE WHEN SH.[Currency Code] <> '' THEN ROUND(SL.AMOUNT / SH.[Currency Factor],0) ELSE SL.AMOUNT END,0) AS AMOUNT_IDR
								, ISNULL(SL.AMOUNT,0) AS AMOUNT
								, ISNULL(CASE WHEN SH.[Currency Code] <> '' THEN ROUND(SL2.AMOUNT_TTL / SH.[Currency Factor],0) ELSE SL2.AMOUNT_TTL END,0) AS AMOUNT_IDR_TTL
								, ISNULL(SL2.AMOUNT_TTL,0) AS AMOUNT_TTL
								, ISNULL(UM.UM_AMOUNT_IDR,0) AS UM_AMOUNT_IDR
								, ISNULL(UM.UM_AMOUNT,0) AS UM_AMOUNT
								, SUBSTRING(SH.[Package Tracking No_],1,4) AS REV_YEAR
								, CASE WHEN SUBSTRING( SH.[No_], 1, 4) = 'SOSR' THEN
									CASE WHEN DATEPART(quarter, SH.[Order Date]) IN (1,2) THEN 'S1' ELSE 'S2' END
								  ELSE
									CASE WHEN SUBSTRING(SH.[Package Tracking No_],5,2) = '' OR  SUBSTRING(SH.[Package Tracking No_],5,2) NOT IN ('S1', 'S2') THEN
										CASE WHEN DATEPART(year, $P{TglInvTo}) <= DATEPART(year, GETDATE()) THEN
											CASE WHEN DATEPART(quarter, GETDATE()) IN (1,2) THEN 'S1' ELSE 'S2' END
										ELSE
											'S1'
										END
									ELSE
										SUBSTRING(SH.[Package Tracking No_],5,2)
									END
								  END AS SEMESTER
						FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Header] SH
						INNER JOIN  (	SELECT X.[Document No_]
											,SUM(X.QTY) AS QTY
											,SUM(X.QTY_INV)AS QTY_INV
											,SUM(X.AMOUNT) AS AMOUNT
										FROM (
												SELECT [Document No_]
														, [Quantity] AS QTY
														, [Quantity Invoiced] AS QTY_INV
														, CASE WHEN [Quantity Invoiced] <> 0 AND [Quantity] <> [Quantity Invoiced] THEN
															([Amount] / [Quantity]) * ([Quantity] - [Quantity Invoiced])
														  ELSE
															[Amount]
														  END AS AMOUNT
												FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Line]
												WHERE [Document Type] = 1 AND
												 [Quantity] <> [Quantity Invoiced]
											) X
										GROUP BY X.[Document No_]
									)SL ON SL.[Document No_] = SH.[No_]
						LEFT JOIN  (
										SELECT [Document No_]
											 , SUM([Amount]) AS AMOUNT_TTL
												FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Line]
												WHERE [Document Type] = 1
										GROUP BY [Document No_]
									)SL2 ON SL2.[Document No_] = SH.[No_]
						LEFT JOIN	(
										SELECT Y.NO_SO
												,SUM(Y.UM_AMOUNT) AS UM_AMOUNT
												,SUM(Y.UM_AMOUNT_IDR) AS UM_AMOUNT_IDR
										FROM (
												SELECT [Prepayment Order No_] AS NO_SO
													  ,SUM(UMD.[Amount]) AS UM_AMOUNT
													  ,CASE WHEN UMH.[Currency Code] <> '' THEN ROUND(SUM(UMD.[Amount]) / UMH.[Currency Factor],0) ELSE SUM(UMD.[Amount]) END AS UM_AMOUNT_IDR

												FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] UMH
												INNER JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Line] UMD ON UMH.[No_] = UMD.[Document No_]
												GROUP BY UMH.[Prepayment Order No_], UMH.[Currency Code], UMH.[Currency Factor]
												UNION ALL
												SELECT [Prepayment Order No_] AS NO_SO
													  ,SUM(UMD.[Amount]) * -1 AS UM_AMOUNT
													  ,CASE WHEN UMH.[Currency Code] <> '' THEN ROUND(SUM(UMD.[Amount]) / UMH.[Currency Factor],0) ELSE SUM(UMD.[Amount]) * -1 END AS UM_AMOUNT_IDR

												FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Cr_Memo Header] UMH
												INNER JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Cr_Memo Line] UMD ON UMH.[No_] = UMD.[Document No_]
												GROUP BY UMH.[Prepayment Order No_], UMH.[Currency Code], UMH.[Currency Factor]
											) Y
										GROUP BY Y.NO_SO
									) UM ON UM.NO_SO = SH.[No_]
						LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Responsibility Center] CAB ON CAB.[Code] = SH.[Shortcut Dimension 1 Code]
						WHERE SH.[Document Type] = 1
					) XY
			WHERE (	(XY.TIPE <> 'SOSR') OR
					(SUBSTRING(CONVERT(varchar, XY.ORDER_DATE, 105), 7,4) <= SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) AND XY.TIPE = 'SOSR'))  AND
					(XY.REV_YEAR = '' OR XY.REV_YEAR = SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4)) AND
					(XY.STATUS_SO = 'RELEASED')
			) XXX
			WHERE  (XXX.COMPANY = $P{Company} OR $P{Company} = 'ALL') AND
					XXX.NO_PO_CUST NOT LIKE '%OTP%' AND XXX.NO_PO_CUST NOT LIKE 'BOOKING%'
					AND XXX.CUST_CODE NOT IN ('AUJA001' , 'AUJA002', 'SOPE001')
			) OSO
			GROUP BY OSO.GROUP_ITEM_CAT, OSO.ITEM_CAT
		) SRV
LEFT JOIN	(
				SELECT	CASE WHEN DATEPART(quarter, $P{TglInvTo}) IN (1,2) THEN 'Target - Semester I' ELSE 'Target - ALL Semester' END AS LBL_TARGET
						,SUM(TGT.AMT_TARGET) AS AMT_TARGET
				FROM	(
							SELECT	CAST(CMP.[Description] AS DECIMAL(38,20)) AS AMT_TARGET
									,	CASE WHEN	SUBSTRING(CMP.[No_],1,4) = SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) THEN
											CASE WHEN (DATEPART(quarter, $P{TglInvTo}) IN (1,2)) THEN
												CASE WHEN SUBSTRING(CMP.[No_],9,2) = 'S1' THEN
													'Y'
												ELSE
													'N'
												END
											ELSE
												'Y'
											END
										ELSE
											'N'
										END AS TARGET_VALID
							FROM [AUTOJAYA].[dbo].[AUTOJAYA$Campaign]  CMP
							WHERE	CMP.[Description] <> ''
									AND CMP.[Salesperson Code] = ''
						) TGT
				WHERE TGT.TARGET_VALID = 'Y'
			) TRG ON 1 = 1
UNION ALL
SELECT	YXY.GR_CRNXY
		,YXY.GROUP_NO
		,YXY.GROUP_DESC
		,YXY.GROUP_ITEM_CAT
		,YXY.ITEM_CAT
		,YXY.AMT_HO
		,YXY.AMT_SBY
		,YXY.AMT_DPS
		,YXY.AMT_CKR
		,YXY.AMT_SMR
		,YXY.TOTAL
		,YXY.AMT_TARGET
		,YXY.LBL_TARGET
FROM	(
SELECT	2 AS GR_CRNXY
		, NULL AS GROUP_NO
		, 'Outstanding SO (Carried over to Semester II)' AS GROUP_DESC
		,YYY.GROUP_ITEM_CAT
		,YYY.ITEM_CAT
		,ROUND((SUM(YYY.AMT_HO )),0) AS AMT_HO
		,ROUND((SUM(YYY.AMT_SBY )),0) AS AMT_SBY
		,ROUND((SUM(YYY.AMT_DPS )),0) AS AMT_DPS
		,ROUND((SUM(YYY.AMT_CKR )),0) AS AMT_CKR
		,ROUND((SUM(YYY.AMT_SMR )),0) AS AMT_SMR
		,(ROUND((SUM(YYY.AMT_HO )),0)  +  ROUND((SUM(YYY.AMT_SBY )),0) + ROUND((SUM(YYY.AMT_DPS )),0) +
			ROUND((SUM(YYY.AMT_CKR )),0) + ROUND((SUM(YYY.AMT_SMR )),0)) AS TOTAL
		, 0 AS AMT_TARGET
		, '' AS LBL_TARGET
FROM	(
			SELECT	'OS2' AS GROUP_ITEM_CAT
					,'Outstanding SO' AS ITEM_CAT
					, CASE WHEN XXX.CABANG = 'JAKARTA' THEN XXX.AMOUNT_IDR ELSE 0 END AS AMT_HO
					, CASE WHEN XXX.CABANG = 'SURABAYA' THEN XXX.AMOUNT_IDR ELSE 0 END AS AMT_SBY
					, CASE WHEN XXX.CABANG = 'BALI' THEN XXX.AMOUNT_IDR ELSE 0 END AS AMT_DPS
					, CASE WHEN XXX.CABANG = 'CIKARANG' THEN XXX.AMOUNT_IDR ELSE 0 END AS AMT_CKR
					, CASE WHEN XXX.CABANG = 'SEMARANG' THEN XXX.AMOUNT_IDR ELSE 0 END AS AMT_SMR
			FROM	(
						SELECT	'AUTOJAYA' AS COMPANY
								, XY.CABANG
								, XY.CUST_CODE
								, XY.ORDER_DATE
								, XY.STATUS_SO
								, XY.NO_PO_CUST
								, XY.REV_YEAR
								,	CASE WHEN	(DATEPART(quarter, $P{TglInvTo}) IN (1,2) AND XY.SEMESTER = 'S2') THEN
										CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
											(XY.AMOUNT_IDR - XY.UM_AMOUNT_IDR)
										ELSE
											(XY.AMOUNT_IDR - ((XY.UM_AMOUNT_IDR*XY.AMOUNT_IDR)/(XY.AMOUNT_IDR_TTL)))
										END
									ELSE
										0
									END AS AMOUNT_IDR
								, CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
									(XY.AMOUNT - XY.UM_AMOUNT)
									ELSE
									(XY.AMOUNT - ((XY.UM_AMOUNT*XY.AMOUNT)/(XY.AMOUNT_TTL)))
									END AS AMOUNT
						FROM	(
									SELECT SH.[No_] AS NO_SO
											, SUBSTRING( SH.[No_], 1, 4) AS TIPE
											, ISNULL(CAB.[Name], 'JAKARTA') AS CABANG
											, SH.[Bill-to Customer No_] AS CUST_CODE
											, SH.[Order Date] AS ORDER_DATE
											, CASE	WHEN SH.[Status] = 0 THEN 'OPEN'
													WHEN SH.[Status] = 1 THEN 'RELEASED'
													WHEN SH.[Status] = 2 THEN 'PENDING APPROVAL'
													WHEN SH.[Status] = 3 THEN 'RELEASED'
													ELSE '' END AS STATUS_SO
											, SH.[External Document No_] AS NO_PO_CUST
											, ISNULL(CASE WHEN SH.[Currency Code] <> '' THEN ROUND(SL.AMOUNT / SH.[Currency Factor],0) ELSE SL.AMOUNT END,0) AS AMOUNT_IDR
											, ISNULL(SL.AMOUNT,0) AS AMOUNT
											, ISNULL(CASE WHEN SH.[Currency Code] <> '' THEN ROUND(SL2.AMOUNT_TTL / SH.[Currency Factor],0) ELSE SL2.AMOUNT_TTL END,0) AS AMOUNT_IDR_TTL
											, ISNULL(SL2.AMOUNT_TTL,0) AS AMOUNT_TTL
											, ISNULL(UM.UM_AMOUNT_IDR,0) AS UM_AMOUNT_IDR
											, ISNULL(UM.UM_AMOUNT,0) AS UM_AMOUNT
											, SUBSTRING(SH.[Package Tracking No_],1,4) AS REV_YEAR
											, CASE WHEN SUBSTRING( SH.[No_], 1, 4) = 'SOAR' THEN
												CASE WHEN DATEPART(quarter, SH.[Order Date]) IN (1,2) THEN 'S1' ELSE 'S2' END
											  ELSE
												CASE WHEN SUBSTRING(SH.[Package Tracking No_],5,2) = '' OR  SUBSTRING(SH.[Package Tracking No_],5,2) NOT IN ('S1', 'S2') THEN
													CASE WHEN DATEPART(year, $P{TglInvTo}) <= DATEPART(year, GETDATE()) THEN
														CASE WHEN DATEPART(quarter, GETDATE()) IN (1,2) THEN 'S1' ELSE 'S2' END
													ELSE
														'S1'
													END
												ELSE
													SUBSTRING(SH.[Package Tracking No_],5,2)
												END
											  END AS SEMESTER
									FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Header] SH
									LEFT JOIN  (	SELECT X.[Document No_]
														,SUM(X.QTY) AS QTY
														,SUM(X.QTY_INV)AS QTY_INV
														,SUM(X.AMOUNT) AS AMOUNT
													FROM (
															SELECT [Document No_]
																	, [Quantity] AS QTY
																	, [Quantity Invoiced] AS QTY_INV
																	, CASE WHEN [Quantity Invoiced] <> 0 AND [Quantity] <> [Quantity Invoiced] THEN
																		([Amount] / [Quantity]) * ([Quantity] - [Quantity Invoiced])
																	  ELSE
																		[Amount]
																	  END AS AMOUNT
															FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Line]
															WHERE [Document Type] = 1 AND
															 [Quantity] <> [Quantity Invoiced]
														) X
													GROUP BY X.[Document No_]
												)SL ON SL.[Document No_] = SH.[No_]
									LEFT JOIN  (
													SELECT [Document No_]
														 , SUM([Amount]) AS AMOUNT_TTL
															FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Line]
															WHERE [Document Type] = 1
													GROUP BY [Document No_]
												)SL2 ON SL2.[Document No_] = SH.[No_]
									LEFT JOIN	(
													SELECT Y.NO_SO
															,SUM(Y.UM_AMOUNT) AS UM_AMOUNT
															,SUM(Y.UM_AMOUNT_IDR) AS UM_AMOUNT_IDR
													FROM (
															SELECT [Prepayment Order No_] AS NO_SO
																  ,SUM(UMD.[Amount]) AS UM_AMOUNT
																  ,CASE WHEN UMH.[Currency Code] <> '' THEN ROUND(SUM(UMD.[Amount]) / UMH.[Currency Factor],0) ELSE SUM(UMD.[Amount]) END AS UM_AMOUNT_IDR

															FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] UMH
															INNER JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Line] UMD ON UMH.[No_] = UMD.[Document No_]
															GROUP BY UMH.[Prepayment Order No_], UMH.[Currency Code], UMH.[Currency Factor]
															UNION ALL
															SELECT [Prepayment Order No_] AS NO_SO
																  ,SUM(UMD.[Amount]) * -1 AS UM_AMOUNT
																  ,CASE WHEN UMH.[Currency Code] <> '' THEN ROUND(SUM(UMD.[Amount]) / UMH.[Currency Factor],0) ELSE SUM(UMD.[Amount]) * -1 END AS UM_AMOUNT_IDR

															FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Cr_Memo Header] UMH
															INNER JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Cr_Memo Line] UMD ON UMH.[No_] = UMD.[Document No_]
															GROUP BY UMH.[Prepayment Order No_], UMH.[Currency Code], UMH.[Currency Factor]
														) Y
													GROUP BY Y.NO_SO
												) UM ON UM.NO_SO = SH.[No_]
									LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Responsibility Center] CAB ON CAB.[Code] = SH.[Shortcut Dimension 1 Code]
									WHERE SH.[Document Type] = 1
								) XY
						WHERE (	(XY.TIPE <> 'SOAR') OR
								(SUBSTRING(CONVERT(varchar, XY.ORDER_DATE, 105), 7,4) <= SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) AND XY.TIPE = 'SOAR'))  AND
								(XY.REV_YEAR = '' OR XY.REV_YEAR = SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4)) AND
								(XY.STATUS_SO = 'RELEASED')
						UNION ALL
						SELECT	'SOLUSI' AS COMPANY
								, XY.CABANG
								, XY.CUST_CODE
								, XY.ORDER_DATE
								, XY.STATUS_SO
								, XY.NO_PO_CUST
								, XY.REV_YEAR
								,	CASE WHEN	DATEPART(quarter, $P{TglInvTo}) IN (1,2) AND XY.SEMESTER = 'S2' THEN
										CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
											(XY.AMOUNT_IDR - XY.UM_AMOUNT_IDR)
										ELSE
											(XY.AMOUNT_IDR - ((XY.UM_AMOUNT_IDR*XY.AMOUNT_IDR)/(XY.AMOUNT_IDR_TTL)))
										END
									ELSE
										0
									END AS AMOUNT_IDR
								, CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
									(XY.AMOUNT - XY.UM_AMOUNT)
									ELSE
									(XY.AMOUNT - ((XY.UM_AMOUNT*XY.AMOUNT)/(XY.AMOUNT_TTL)))
									END AS AMOUNT
						FROM	(
									SELECT SH.[No_] AS NO_SO
											, SUBSTRING( SH.[No_], 1, 4) AS TIPE
											, ISNULL(CAB.[Name], 'JAKARTA') AS CABANG
											, SH.[Bill-to Customer No_] AS CUST_CODE
											, SH.[Order Date] AS ORDER_DATE
											, CASE	WHEN SH.[Status] = 0 THEN 'OPEN'
													WHEN SH.[Status] = 1 THEN 'RELEASED'
													WHEN SH.[Status] = 2 THEN 'PENDING APPROVAL'
													WHEN SH.[Status] = 3 THEN 'RELEASED'
													ELSE '' END AS STATUS_SO
											, SH.[External Document No_] AS NO_PO_CUST
											, ISNULL(CASE WHEN SH.[Currency Code] <> '' THEN ROUND(SL.AMOUNT / SH.[Currency Factor],0) ELSE SL.AMOUNT END,0) AS AMOUNT_IDR
											, ISNULL(SL.AMOUNT,0) AS AMOUNT
											, ISNULL(CASE WHEN SH.[Currency Code] <> '' THEN ROUND(SL2.AMOUNT_TTL / SH.[Currency Factor],0) ELSE SL2.AMOUNT_TTL END,0) AS AMOUNT_IDR_TTL
											, ISNULL(SL2.AMOUNT_TTL,0) AS AMOUNT_TTL
											, ISNULL(UM.UM_AMOUNT_IDR,0) AS UM_AMOUNT_IDR
											, ISNULL(UM.UM_AMOUNT,0) AS UM_AMOUNT
											, SUBSTRING(SH.[Package Tracking No_],1,4) AS REV_YEAR
											, CASE WHEN SUBSTRING( SH.[No_], 1, 4) = 'SOSR' THEN
												CASE WHEN DATEPART(quarter, SH.[Order Date]) IN (1,2) THEN 'S1' ELSE 'S2' END
											  ELSE
												CASE WHEN SUBSTRING(SH.[Package Tracking No_],5,2) = '' OR  SUBSTRING(SH.[Package Tracking No_],5,2) NOT IN ('S1', 'S2') THEN
													CASE WHEN DATEPART(year, $P{TglInvTo}) <= DATEPART(year, GETDATE()) THEN
														CASE WHEN DATEPART(quarter, GETDATE()) IN (1,2) THEN 'S1' ELSE 'S2' END
													ELSE
														'S1'
													END
												ELSE
													SUBSTRING(SH.[Package Tracking No_],5,2)
												END
											  END AS SEMESTER
									FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Header] SH
									INNER JOIN  (	SELECT X.[Document No_]
														,SUM(X.QTY) AS QTY
														,SUM(X.QTY_INV)AS QTY_INV
														,SUM(X.AMOUNT) AS AMOUNT
													FROM (
															SELECT [Document No_]
																	, [Quantity] AS QTY
																	, [Quantity Invoiced] AS QTY_INV
																	, CASE WHEN [Quantity Invoiced] <> 0 AND [Quantity] <> [Quantity Invoiced] THEN
																		([Amount] / [Quantity]) * ([Quantity] - [Quantity Invoiced])
																	  ELSE
																		[Amount]
																	  END AS AMOUNT
															FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Line]
															WHERE [Document Type] = 1 AND
															 [Quantity] <> [Quantity Invoiced]
														) X
													GROUP BY X.[Document No_]
												)SL ON SL.[Document No_] = SH.[No_]
									LEFT JOIN  (
													SELECT [Document No_]
														 , SUM([Amount]) AS AMOUNT_TTL
															FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Line]
															WHERE [Document Type] = 1
													GROUP BY [Document No_]
												)SL2 ON SL2.[Document No_] = SH.[No_]
									LEFT JOIN	(
													SELECT Y.NO_SO
															,SUM(Y.UM_AMOUNT) AS UM_AMOUNT
															,SUM(Y.UM_AMOUNT_IDR) AS UM_AMOUNT_IDR
													FROM (
															SELECT [Prepayment Order No_] AS NO_SO
																  ,SUM(UMD.[Amount]) AS UM_AMOUNT
																  ,CASE WHEN UMH.[Currency Code] <> '' THEN ROUND(SUM(UMD.[Amount]) / UMH.[Currency Factor],0) ELSE SUM(UMD.[Amount]) END AS UM_AMOUNT_IDR

															FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] UMH
															INNER JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Line] UMD ON UMH.[No_] = UMD.[Document No_]
															GROUP BY UMH.[Prepayment Order No_], UMH.[Currency Code], UMH.[Currency Factor]
															UNION ALL
															SELECT [Prepayment Order No_] AS NO_SO
																  ,SUM(UMD.[Amount]) * -1 AS UM_AMOUNT
																  ,CASE WHEN UMH.[Currency Code] <> '' THEN ROUND(SUM(UMD.[Amount]) / UMH.[Currency Factor],0) ELSE SUM(UMD.[Amount]) * -1 END AS UM_AMOUNT_IDR

															FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Cr_Memo Header] UMH
															INNER JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Cr_Memo Line] UMD ON UMH.[No_] = UMD.[Document No_]
															GROUP BY UMH.[Prepayment Order No_], UMH.[Currency Code], UMH.[Currency Factor]
														) Y
													GROUP BY Y.NO_SO
												) UM ON UM.NO_SO = SH.[No_]
									LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Responsibility Center] CAB ON CAB.[Code] = SH.[Shortcut Dimension 1 Code]
									WHERE SH.[Document Type] = 1
								) XY
						WHERE (	(XY.TIPE <> 'SOSR') OR
								(SUBSTRING(CONVERT(varchar, XY.ORDER_DATE, 105), 7,4) <= SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) AND XY.TIPE = 'SOSR'))  AND
								(XY.REV_YEAR = '' OR XY.REV_YEAR = SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4)) AND
								(XY.STATUS_SO = 'RELEASED')
					) XXX
			WHERE  (XXX.COMPANY = $P{Company} OR $P{Company} = 'ALL') AND
					XXX.NO_PO_CUST NOT LIKE '%OTP%' AND XXX.NO_PO_CUST NOT LIKE 'BOOKING%'
					AND XXX.CUST_CODE NOT IN ('AUJA001' , 'AUJA002', 'SOPE001')
		) YYY
GROUP BY YYY.GROUP_ITEM_CAT, YYY.ITEM_CAT
		) YXY
WHERE YXY.TOTAL <> 0
UNION ALL
SELECT	3 AS GR_CRNXY
		,XIX.GROUP_NO
		,XIX.GROUP_DESC
		,XIX.GROUP_ITEM_CAT
		,XIX.ITEM_CAT
		,ROUND((SUM(XIX.AMT_HO )),0) AS AMT_HO
		,ROUND((SUM(XIX.AMT_SBY )),0) AS AMT_SBY
		,ROUND((SUM(XIX.AMT_DPS )),0) AS AMT_DPS
		,ROUND((SUM(XIX.AMT_CKR )),0) AS AMT_CKR
		,ROUND((SUM(XIX.AMT_SMR )),0) AS AMT_SMR
		,(ROUND((SUM(XIX.AMT_HO )),0)  +  ROUND((SUM(XIX.AMT_SBY )),0) + ROUND((SUM(XIX.AMT_DPS )),0) +
			ROUND((SUM(XIX.AMT_CKR )),0) + ROUND((SUM(XIX.AMT_SMR )),0)) AS TOTAL
		, 0 AS AMT_TARGET
		, '' AS LBL_TARGET
FROM	(
			SELECT	null AS GROUP_NO
					,'Outstanding SO (Carried over to Next Year)' AS GROUP_DESC
					,'OS2' AS GROUP_ITEM_CAT
					,'Outstanding SO' AS ITEM_CAT
					, CASE WHEN XXX.CABANG = 'JAKARTA' THEN XXX.AMOUNT_IDR ELSE 0 END AS AMT_HO
					, CASE WHEN XXX.CABANG = 'SURABAYA' THEN XXX.AMOUNT_IDR ELSE 0 END AS AMT_SBY
					, CASE WHEN XXX.CABANG = 'BALI' THEN XXX.AMOUNT_IDR ELSE 0 END AS AMT_DPS
					, CASE WHEN XXX.CABANG = 'CIKARANG' THEN XXX.AMOUNT_IDR ELSE 0 END AS AMT_CKR
					, CASE WHEN XXX.CABANG = 'SEMARANG' THEN XXX.AMOUNT_IDR ELSE 0 END AS AMT_SMR
			FROM	(
			SELECT	'AUTOJAYA' AS COMPANY
					, XY.NO_SO
					, XY.TIPE
					, XY.CABANG
					, XY.LOC_CODE
					, XY.SALES_CODE
					, XY.SALES_NAME
					, XY.CUST_CODE
					, XY.CUST_NAME
					, XY.ORDER_DATE
					, XY.STATUS_SO
					, XY.TERM_OF_PAY
					, XY.NO_PO_CUST
					, XY.CURR_CODE
					, XY.CURR_FAKTOR
					, XY.SO_YEAR
					, XY.REV_YEAR
					, CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
						(XY.AMOUNT_IDR - XY.UM_AMOUNT_IDR)
						ELSE
							(XY.AMOUNT_IDR - ((XY.UM_AMOUNT_IDR*XY.AMOUNT_IDR)/(XY.AMOUNT_IDR_TTL)))
						END AS AMOUNT_IDR
					, CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
						(XY.AMOUNT - XY.UM_AMOUNT)
						ELSE
						(XY.AMOUNT - ((XY.UM_AMOUNT*XY.AMOUNT) /(XY.AMOUNT_TTL)))
						END AS AMOUNT
			FROM	(
						SELECT SH.[No_] AS NO_SO
								, CASE WHEN SUBSTRING( SH.[No_], 1, 4) = 'SOAS' THEN 'SC' ELSE
									CASE WHEN SUBSTRING( SH.[No_], 1, 2) IN ('8S','9S') THEN 'AI' ELSE 'TD' END
								  END AS TIPE
								, SUBSTRING( SH.[No_], 1, 4) AS TIPE_2
								, CASE WHEN SH.[Location Code] = '' THEN 'HO-TD' ELSE SH.[Location Code] END AS LOC_CODE
								, ISNULL(CAB.[Name], 'JAKARTA') AS CABANG
								, CASE WHEN SH.[Salesperson Code] = '' THEN '.' ELSE SH.[Salesperson Code] END AS SALES_CODE
								, SLS.[Name] AS SALES_NAME
								, SH.[Bill-to Customer No_] AS CUST_CODE
								, SH.[Bill-to Name] AS CUST_NAME
								, SH.[Order Date] AS ORDER_DATE
								, SUBSTRING(CONVERT(varchar, SH.[Order Date], 105), 7,4) AS SO_YEAR
								, CASE	WHEN SH.[Status] = 0 THEN 'OPEN'
										WHEN SH.[Status] = 1 THEN 'RELEASED'
										WHEN SH.[Status] = 2 THEN 'PENDING APPROVAL'
										WHEN SH.[Status] = 3 THEN 'RELEASED'
										ELSE '' END AS STATUS_SO
								, SH.[Payment Terms Code] AS TERM_OF_PAY
								, SH.[External Document No_] AS NO_PO_CUST
								, SH.[Currency Code] AS CURR_CODE
								, SH.[Currency Factor] AS CURR_FAKTOR
								, ISNULL(CASE WHEN SH.[Currency Code] <> '' THEN ROUND(SL.AMOUNT / SH.[Currency Factor],0) ELSE SL.AMOUNT END,0) AS AMOUNT_IDR
								, ISNULL(SL.AMOUNT,0) AS AMOUNT
								, ISNULL(CASE WHEN SH.[Currency Code] <> '' THEN ROUND(SL2.AMOUNT_TTL / SH.[Currency Factor],0) ELSE SL2.AMOUNT_TTL END,0) AS AMOUNT_IDR_TTL
								, ISNULL(SL2.AMOUNT_TTL,0) AS AMOUNT_TTL
								, ISNULL(UM.UM_AMOUNT_IDR,0) AS UM_AMOUNT_IDR
								, ISNULL(UM.UM_AMOUNT,0) AS UM_AMOUNT
								, SUBSTRING(SH.[Package Tracking No_],1,4) AS REV_YEAR
						FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Header] SH
						LEFT JOIN  (	SELECT X.[Document No_]
											,SUM(X.QTY) AS QTY
											,SUM(X.QTY_INV)AS QTY_INV
											,SUM(X.AMOUNT) AS AMOUNT
										FROM (
												SELECT [Document No_]
														, [Quantity] AS QTY
														, [Quantity Invoiced] AS QTY_INV
														, CASE WHEN [Quantity Invoiced] <> 0 AND [Quantity] <> [Quantity Invoiced] THEN
															([Amount] / [Quantity]) * ([Quantity] - [Quantity Invoiced])
														  ELSE
															[Amount]
														  END AS AMOUNT
												FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Line]
												WHERE [Document Type] = 1 AND
												 [Quantity] <> [Quantity Invoiced]
											) X
										GROUP BY X.[Document No_]
									)SL ON SL.[Document No_] = SH.[No_]
						LEFT JOIN  (
										SELECT [Document No_]
											 , SUM([Amount]) AS AMOUNT_TTL
												FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Line]
												WHERE [Document Type] = 1
										GROUP BY [Document No_]
									)SL2 ON SL2.[Document No_] = SH.[No_]
						LEFT JOIN	(
										SELECT Y.NO_SO
												,SUM(Y.UM_AMOUNT) AS UM_AMOUNT
												,SUM(Y.UM_AMOUNT_IDR) AS UM_AMOUNT_IDR
										FROM (
												SELECT [Prepayment Order No_] AS NO_SO
													  ,SUM(UMD.[Amount]) AS UM_AMOUNT
													  ,CASE WHEN UMH.[Currency Code] <> '' THEN ROUND(SUM(UMD.[Amount]) / UMH.[Currency Factor],0) ELSE SUM(UMD.[Amount]) END AS UM_AMOUNT_IDR

												FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Header] UMH
												INNER JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Invoice Line] UMD ON UMH.[No_] = UMD.[Document No_]
												GROUP BY UMH.[Prepayment Order No_], UMH.[Currency Code], UMH.[Currency Factor]
												UNION ALL
												SELECT [Prepayment Order No_] AS NO_SO
													  ,SUM(UMD.[Amount]) * -1 AS UM_AMOUNT
													  ,CASE WHEN UMH.[Currency Code] <> '' THEN ROUND(SUM(UMD.[Amount]) / UMH.[Currency Factor],0) ELSE SUM(UMD.[Amount]) * -1 END AS UM_AMOUNT_IDR

												FROM [AUTOJAYA].[dbo].[AUTOJAYA$Sales Cr_Memo Header] UMH
												INNER JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Sales Cr_Memo Line] UMD ON UMH.[No_] = UMD.[Document No_]
												GROUP BY UMH.[Prepayment Order No_], UMH.[Currency Code], UMH.[Currency Factor]
											) Y
										GROUP BY Y.NO_SO
									) UM ON UM.NO_SO = SH.[No_]
						LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Responsibility Center] CAB ON CAB.[Code] = SH.[Shortcut Dimension 1 Code]
						LEFT JOIN [AUTOJAYA].[dbo].[AUTOJAYA$Salesperson_Purchaser] SLS ON SLS.[Code] = SH.[Salesperson Code]
						WHERE SH.[Document Type] = 1
					) XY
			WHERE
			(	(
					((SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1) <= SUBSTRING(CONVERT(varchar, getdate(), 105), 7,4)) AND
					(XY.SO_YEAR <= SUBSTRING(CONVERT(varchar, getdate(), 105), 7,4)) AND
					(XY.REV_YEAR = '' OR (XY.REV_YEAR >= (SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1) AND XY.REV_YEAR <= (SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1)))
				) OR
				(
					((SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1) > SUBSTRING(CONVERT(varchar, getdate(), 105), 7,4)) AND
					(
						(
							XY.TIPE_2 <> 'SOAR' AND
							(
								((SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1) <= SUBSTRING(CONVERT(varchar, getdate(), 105), 7,4)) AND
								(XY.REV_YEAR = '' OR (XY.REV_YEAR >= (SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1) AND XY.REV_YEAR <= (SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1)))
							) OR
							(
								((SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1) > SUBSTRING(CONVERT(varchar, getdate(), 105), 7,4)) AND
								((XY.REV_YEAR >= (SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1) AND XY.REV_YEAR <= (SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1)))
							)
						) OR
						(
							XY.TIPE_2 = 'SOAR' AND
							(XY.SO_YEAR >= (SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1) AND XY.SO_YEAR <= (SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1)) AND
							(XY.REV_YEAR = '' OR (XY.REV_YEAR >= (SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1) AND XY.REV_YEAR <= (SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1)))
						)
					)
				)
			)  AND
			(XY.STATUS_SO = 'RELEASED')
			UNION ALL
			SELECT	'SOLUSI' AS COMPANY
					, XY.NO_SO
					, XY.TIPE
					, XY.CABANG
					, XY.LOC_CODE
					, XY.SALES_CODE
					, XY.SALES_NAME
					, XY.CUST_CODE
					, XY.CUST_NAME
					, XY.ORDER_DATE
					, XY.STATUS_SO
					, XY.TERM_OF_PAY
					, XY.NO_PO_CUST
					, XY.CURR_CODE
					, XY.CURR_FAKTOR
					, XY.SO_YEAR
					, XY.REV_YEAR
					, CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
						(XY.AMOUNT_IDR - XY.UM_AMOUNT_IDR)
						ELSE
							(XY.AMOUNT_IDR - ((XY.UM_AMOUNT_IDR*XY.AMOUNT_IDR)/(XY.AMOUNT_IDR_TTL)))
						END AS AMOUNT_IDR
					, CASE WHEN XY.AMOUNT_IDR_TTL = 0 THEN
						(XY.AMOUNT - XY.UM_AMOUNT)
						ELSE
						(XY.AMOUNT - ((XY.UM_AMOUNT*XY.AMOUNT) /(XY.AMOUNT_TTL)))
						END AS AMOUNT
			FROM	(
						SELECT SH.[No_] AS NO_SO
								, CASE WHEN SUBSTRING( SH.[No_], 1, 4) = 'SOSS' THEN 'SC' ELSE
									CASE WHEN SUBSTRING( SH.[No_], 1, 2) IN ('8S','9S') THEN 'AI' ELSE 'TD' END
								  END AS TIPE
								, SUBSTRING( SH.[No_], 1, 4) AS TIPE_2
								, CASE WHEN SH.[Location Code] = '' THEN 'HO-TD' ELSE SH.[Location Code] END AS LOC_CODE
								, ISNULL(CAB.[Name], 'JAKARTA') AS CABANG
								, CASE WHEN SH.[Salesperson Code] = '' THEN '.' ELSE SH.[Salesperson Code] END AS SALES_CODE
								, SLS.[Name] AS SALES_NAME
								, SH.[Bill-to Customer No_] AS CUST_CODE
								, SH.[Bill-to Name] AS CUST_NAME
								, SH.[Order Date] AS ORDER_DATE
								, SUBSTRING(CONVERT(varchar, SH.[Order Date], 105), 7,4) AS SO_YEAR
								, CASE	WHEN SH.[Status] = 0 THEN 'OPEN'
										WHEN SH.[Status] = 1 THEN 'RELEASED'
										WHEN SH.[Status] = 2 THEN 'PENDING APPROVAL'
										WHEN SH.[Status] = 3 THEN 'RELEASED'
										ELSE '' END AS STATUS_SO
								, SH.[Payment Terms Code] AS TERM_OF_PAY
								, SH.[External Document No_] AS NO_PO_CUST
								, SH.[Currency Code] AS CURR_CODE
								, SH.[Currency Factor] AS CURR_FAKTOR
								, ISNULL(CASE WHEN SH.[Currency Code] <> '' THEN ROUND(SL.AMOUNT / SH.[Currency Factor],0) ELSE SL.AMOUNT END,0) AS AMOUNT_IDR
								, ISNULL(SL.AMOUNT,0) AS AMOUNT
								, ISNULL(CASE WHEN SH.[Currency Code] <> '' THEN ROUND(SL2.AMOUNT_TTL / SH.[Currency Factor],0) ELSE SL2.AMOUNT_TTL END,0) AS AMOUNT_IDR_TTL
								, ISNULL(SL2.AMOUNT_TTL,0) AS AMOUNT_TTL
								, ISNULL(UM.UM_AMOUNT_IDR,0) AS UM_AMOUNT_IDR
								, ISNULL(UM.UM_AMOUNT,0) AS UM_AMOUNT
								, SUBSTRING(SH.[Package Tracking No_],1,4) AS REV_YEAR
						FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Header] SH
						INNER JOIN  (	SELECT X.[Document No_]
											,SUM(X.QTY) AS QTY
											,SUM(X.QTY_INV)AS QTY_INV
											,SUM(X.AMOUNT) AS AMOUNT
										FROM (
												SELECT [Document No_]
														, [Quantity] AS QTY
														, [Quantity Invoiced] AS QTY_INV
														, CASE WHEN [Quantity Invoiced] <> 0 AND [Quantity] <> [Quantity Invoiced] THEN
															([Amount] / [Quantity]) * ([Quantity] - [Quantity Invoiced])
														  ELSE
															[Amount]
														  END AS AMOUNT
												FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Line]
												WHERE [Document Type] = 1 AND
												 [Quantity] <> [Quantity Invoiced]
											) X
										GROUP BY X.[Document No_]
									)SL ON SL.[Document No_] = SH.[No_]
						LEFT JOIN  (
										SELECT [Document No_]
											 , SUM([Amount]) AS AMOUNT_TTL
												FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Line]
												WHERE [Document Type] = 1
										GROUP BY [Document No_]
									)SL2 ON SL2.[Document No_] = SH.[No_]
						LEFT JOIN	(
										SELECT Y.NO_SO
												,SUM(Y.UM_AMOUNT) AS UM_AMOUNT
												,SUM(Y.UM_AMOUNT_IDR) AS UM_AMOUNT_IDR
										FROM (
												SELECT [Prepayment Order No_] AS NO_SO
													  ,SUM(UMD.[Amount]) AS UM_AMOUNT
													  ,CASE WHEN UMH.[Currency Code] <> '' THEN ROUND(SUM(UMD.[Amount]) / UMH.[Currency Factor],0) ELSE SUM(UMD.[Amount]) END AS UM_AMOUNT_IDR

												FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Header] UMH
												INNER JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Invoice Line] UMD ON UMH.[No_] = UMD.[Document No_]
												GROUP BY UMH.[Prepayment Order No_], UMH.[Currency Code], UMH.[Currency Factor]
												UNION ALL
												SELECT [Prepayment Order No_] AS NO_SO
													  ,SUM(UMD.[Amount]) * -1 AS UM_AMOUNT
													  ,CASE WHEN UMH.[Currency Code] <> '' THEN ROUND(SUM(UMD.[Amount]) / UMH.[Currency Factor],0) ELSE SUM(UMD.[Amount]) * -1 END AS UM_AMOUNT_IDR

												FROM [AUTOJAYA].[dbo].[SOLUSI$Sales Cr_Memo Header] UMH
												INNER JOIN [AUTOJAYA].[dbo].[SOLUSI$Sales Cr_Memo Line] UMD ON UMH.[No_] = UMD.[Document No_]
												GROUP BY UMH.[Prepayment Order No_], UMH.[Currency Code], UMH.[Currency Factor]
											) Y
										GROUP BY Y.NO_SO
									) UM ON UM.NO_SO = SH.[No_]
						LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Responsibility Center] CAB ON CAB.[Code] = SH.[Shortcut Dimension 1 Code]
						LEFT JOIN [AUTOJAYA].[dbo].[SOLUSI$Salesperson_Purchaser] SLS ON SLS.[Code] = SH.[Salesperson Code]
						WHERE SH.[Document Type] = 1
					) XY
			WHERE
			(	(
					((SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1) <= SUBSTRING(CONVERT(varchar, getdate(), 105), 7,4)) AND
					(XY.SO_YEAR <= SUBSTRING(CONVERT(varchar, getdate(), 105), 7,4)) AND
					(XY.REV_YEAR = '' OR (XY.REV_YEAR >= (SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1) AND XY.REV_YEAR <= (SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1)))
				) OR
				(
					((SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1) > SUBSTRING(CONVERT(varchar, getdate(), 105), 7,4)) AND
					(
						(
							XY.TIPE_2 <> 'SOSR' AND
							(
								((SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1) <= SUBSTRING(CONVERT(varchar, getdate(), 105), 7,4)) AND
								(XY.REV_YEAR = '' OR (XY.REV_YEAR >= (SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1) AND XY.REV_YEAR <= (SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1)))
							) OR
							(
								((SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1) > SUBSTRING(CONVERT(varchar, getdate(), 105), 7,4)) AND
								((XY.REV_YEAR >= (SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1) AND XY.REV_YEAR <= (SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1)))
							)
						) OR
						(
							XY.TIPE_2 = 'SOSR' AND
							(XY.SO_YEAR >= (SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1) AND XY.SO_YEAR <= (SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1)) AND
							(XY.REV_YEAR = '' OR (XY.REV_YEAR >= (SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1) AND XY.REV_YEAR <= (SUBSTRING(CONVERT(varchar, $P{TglInvTo}, 105), 7,4) + 1)))
						)
					)
				)
			)  AND
			(XY.STATUS_SO = 'RELEASED')
			) XXX
			WHERE
					(XXX.COMPANY = $P{Company} OR $P{Company} = 'ALL') AND
					XXX.NO_PO_CUST NOT LIKE '%OTP%' AND
					XXX.NO_PO_CUST NOT LIKE 'BOOKING%'AND
					XXX.CUST_CODE NOT IN ('AUJA001' , 'AUJA002', 'SOPE001') AND
					XXX.NO_SO NOT IN ('SOST150107', 'SOST150657', 'HW15 C 000000274')
		) XIX
GROUP BY XIX.GROUP_NO
		,XIX.GROUP_DESC
		,XIX.GROUP_ITEM_CAT
		,XIX.ITEM_CAT]]>
	</queryString>
	<field name="GR_CRNXY" class="java.lang.Integer"/>
	<field name="GROUP_NO" class="java.lang.Integer"/>
	<field name="GROUP_DESC" class="java.lang.String"/>
	<field name="GROUP_ITEM_CAT" class="java.lang.String"/>
	<field name="ITEM_CAT" class="java.lang.String"/>
	<field name="AMT_HO" class="java.math.BigDecimal"/>
	<field name="AMT_SBY" class="java.math.BigDecimal"/>
	<field name="AMT_DPS" class="java.math.BigDecimal"/>
	<field name="AMT_CKR" class="java.math.BigDecimal"/>
	<field name="AMT_SMR" class="java.math.BigDecimal"/>
	<field name="TOTAL" class="java.math.BigDecimal"/>
	<field name="AMT_TARGET" class="java.math.BigDecimal"/>
	<field name="LBL_TARGET" class="java.lang.String"/>
	<sortField name="GR_CRNXY"/>
	<sortField name="GROUP_NO"/>
	<sortField name="GROUP_ITEM_CAT"/>
	<sortField name="ITEM_CAT"/>
	<variable name="TOTAL_1" class="java.math.BigDecimal" resetType="Group" resetGroup="NoGroup" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL}]]></variableExpression>
	</variable>
	<variable name="AMT_HO_1" class="java.math.BigDecimal" resetType="Group" resetGroup="NoGroup" calculation="Sum">
		<variableExpression><![CDATA[$F{AMT_HO}]]></variableExpression>
	</variable>
	<variable name="AMT_SBY_1" class="java.math.BigDecimal" resetType="Group" resetGroup="NoGroup" calculation="Sum">
		<variableExpression><![CDATA[$F{AMT_SBY}]]></variableExpression>
	</variable>
	<variable name="AMT_DPS_1" class="java.math.BigDecimal" resetType="Group" resetGroup="NoGroup" calculation="Sum">
		<variableExpression><![CDATA[$F{AMT_DPS}]]></variableExpression>
	</variable>
	<variable name="AMT_CKR_1" class="java.math.BigDecimal" resetType="Group" resetGroup="NoGroup" calculation="Sum">
		<variableExpression><![CDATA[$F{AMT_CKR}]]></variableExpression>
	</variable>
	<variable name="AMT_SMR_1" class="java.math.BigDecimal" resetType="Group" resetGroup="NoGroup" calculation="Sum">
		<variableExpression><![CDATA[$F{AMT_SMR}]]></variableExpression>
	</variable>
	<variable name="TOTAL_2" class="java.math.BigDecimal" resetType="Group" resetGroup="ItemCategory" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL}]]></variableExpression>
	</variable>
	<variable name="AMT_HO_2" class="java.math.BigDecimal" resetType="Group" resetGroup="ItemCategory" calculation="Sum">
		<variableExpression><![CDATA[$F{AMT_HO}]]></variableExpression>
	</variable>
	<variable name="AMT_SBY_2" class="java.math.BigDecimal" resetType="Group" resetGroup="ItemCategory" calculation="Sum">
		<variableExpression><![CDATA[$F{AMT_SBY}]]></variableExpression>
	</variable>
	<variable name="AMT_DPS_2" class="java.math.BigDecimal" resetType="Group" resetGroup="ItemCategory" calculation="Sum">
		<variableExpression><![CDATA[$F{AMT_DPS}]]></variableExpression>
	</variable>
	<variable name="AMT_CKR_2" class="java.math.BigDecimal" resetType="Group" resetGroup="ItemCategory" calculation="Sum">
		<variableExpression><![CDATA[$F{AMT_CKR}]]></variableExpression>
	</variable>
	<variable name="AMT_SMR_2" class="java.math.BigDecimal" resetType="Group" resetGroup="ItemCategory" calculation="Sum">
		<variableExpression><![CDATA[$F{AMT_SMR}]]></variableExpression>
	</variable>
	<variable name="TOTAL_3" class="java.math.BigDecimal" resetType="Group" resetGroup="crxy" calculation="Sum">
		<variableExpression><![CDATA[$F{TOTAL}]]></variableExpression>
	</variable>
	<variable name="Balance" class="java.math.BigDecimal">
		<variableExpression><![CDATA[$V{TOTAL_3} - $F{AMT_TARGET}]]></variableExpression>
		<initialValueExpression><![CDATA[$V{TOTAL_3} - $F{AMT_TARGET}]]></initialValueExpression>
	</variable>
	<group name="crxy">
		<groupExpression><![CDATA[$F{GR_CRNXY}]]></groupExpression>
		<groupFooter>
			<band height="85">
				<printWhenExpression><![CDATA[$F{GR_CRNXY} == 1]]></printWhenExpression>
				<staticText>
					<reportElement x="8" y="1" width="25" height="14" uuid="37e1fd62-62bf-42d2-9519-0fb60efabe29"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="33" y="1" width="200" height="14" uuid="46144eb2-f3ae-40a9-ad44-021486471b8d"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[Grand Total]]></text>
				</staticText>
				<staticText>
					<reportElement x="252" y="1" width="105" height="14" uuid="0a5b8fdb-ffa1-4d65-8347-1ff785c20a5d"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="233" y="1" width="19" height="14" uuid="86f7d565-d678-4fef-bd52-a96ce391c124"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<textField pattern="#,###" isBlankWhenNull="true">
					<reportElement x="500" y="1" width="105" height="14" uuid="96074e3e-061d-42e0-9ef1-de1fc51909a8"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{TOTAL_3}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="376" y="1" width="105" height="14" uuid="0f533d4d-8340-40c4-986e-ad11ed5645e8"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="357" y="1" width="19" height="14" uuid="4667906b-da18-4549-b4cb-c6bae2b39abc"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="481" y="1" width="19" height="14" uuid="d4a111ee-8231-4cc1-9298-1eef5fcbeb08"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Rp.]]></text>
				</staticText>
				<staticText>
					<reportElement x="8" y="15" width="25" height="14" uuid="738fe98e-ee24-4a40-aa13-a3851c529dcb"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="252" y="29" width="105" height="14" uuid="a19972dd-a2b5-47fb-8baf-585bf3df492f"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="8" y="43" width="25" height="14" uuid="d4e416fe-6c57-4025-bed4-e2767e9ccf62"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="233" y="29" width="19" height="14" uuid="e83ecb89-7c4d-4ea2-a67c-f93427bb85d4"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="357" y="29" width="19" height="14" uuid="22026d97-e8b6-4fd5-989a-c6aa691e57e3"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="481" y="29" width="19" height="14" uuid="bc527f79-65a7-40ff-aba1-c1eed8e5cf3b"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Rp.]]></text>
				</staticText>
				<staticText>
					<reportElement x="8" y="29" width="25" height="14" uuid="872f5320-2c24-4f20-915d-39a387fbef0e"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="376" y="29" width="105" height="14" uuid="e4c3b205-fdd4-4214-9649-f2ca9802f1ec"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="8" y="57" width="25" height="14" uuid="4475ef06-6c12-4ec6-852d-2b7e5d71c0df"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="376" y="57" width="105" height="14" uuid="47c13484-315f-49f9-a96b-c3a07d1ddf3b"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="8" y="71" width="25" height="14" uuid="b6b77da6-cf87-4c4a-b49c-10714e9a2638"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="252" y="57" width="105" height="14" uuid="4ff5b9ed-2e23-4ba9-8053-6c1710f7b763"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="357" y="57" width="19" height="14" uuid="7d256dd9-4173-4aea-ab86-1a619ed7d07b"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="233" y="57" width="19" height="14" uuid="72b4d05f-9a0d-4e2b-8a96-a4381e7e5472"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="481" y="57" width="19" height="14" uuid="1abbc88d-764c-41cd-ac8a-f9d67cd54559"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Rp.]]></text>
				</staticText>
				<staticText>
					<reportElement x="33" y="57" width="200" height="14" uuid="88970f85-014b-407e-9f99-efc790411c32"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[Balance ( Over / (Deficit) )]]></text>
				</staticText>
				<textField isStretchWithOverflow="true" pattern="#,###" isBlankWhenNull="true">
					<reportElement x="500" y="29" width="105" height="14" isPrintWhenDetailOverflows="true" uuid="df761411-43ef-41bc-ae4c-46ba846576d1"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{AMT_TARGET}]]></textFieldExpression>
				</textField>
				<textField isStretchWithOverflow="true" pattern="#,###;(#,###)" isBlankWhenNull="true">
					<reportElement x="500" y="57" width="105" height="14" isPrintWhenDetailOverflows="true" uuid="357e2beb-0574-4bb9-93b6-ff99798b8076"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{Balance}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="33" y="29" width="200" height="14" uuid="14ea92fa-c48c-4823-b628-561b5076ce89"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{LBL_TARGET}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<group name="NoGroup">
		<groupExpression><![CDATA[$F{GROUP_NO}]]></groupExpression>
		<groupHeader>
			<band height="15">
				<textField isBlankWhenNull="true">
					<reportElement x="8" y="1" width="25" height="14" uuid="bf99114e-0c64-45d3-b5ef-1f9831441711"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{GROUP_NO}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement x="33" y="1" width="200" height="14" uuid="5df2e85c-a37d-459b-9cd5-c2670eb41267"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{GROUP_DESC}]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Group" evaluationGroup="NoGroup" pattern="#,###" isBlankWhenNull="true">
					<reportElement x="500" y="1" width="105" height="14" uuid="14fde8d7-c8ce-4ae7-aaf4-202bef421b3a"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{TOTAL_1}]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Group" evaluationGroup="NoGroup" pattern="#,###" isBlankWhenNull="true">
					<reportElement x="605" y="1" width="105" height="14" uuid="f908eebc-2cfd-4762-8b06-15e57559a5bb"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{AMT_HO_1}]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Group" evaluationGroup="NoGroup" pattern="#,###" isBlankWhenNull="true">
					<reportElement x="710" y="1" width="105" height="14" uuid="5ca983bd-3357-4656-bdd4-57a1132974d1"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{AMT_SBY_1}]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Group" evaluationGroup="NoGroup" pattern="#,###" isBlankWhenNull="true">
					<reportElement x="815" y="1" width="105" height="14" uuid="d014ca11-0c7a-4557-8cae-6e67d0c251dd"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{AMT_DPS_1}]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Group" evaluationGroup="NoGroup" pattern="#,###" isBlankWhenNull="true">
					<reportElement x="920" y="1" width="105" height="14" uuid="f32b1267-c5e0-4673-84f8-2596cbf956a8"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{AMT_CKR_1}]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Group" evaluationGroup="NoGroup" pattern="#,###" isBlankWhenNull="true">
					<reportElement x="1025" y="1" width="105" height="14" uuid="1fba4753-54e1-412a-97ef-2a188dc12606"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{AMT_SMR_1}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="252" y="1" width="105" height="14" uuid="5ed29b7c-0532-4c3d-8ef9-7870d2cdbb09"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="233" y="1" width="19" height="14" uuid="56e3a221-d0dc-41c3-9c3d-657935dba6fe"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="357" y="1" width="19" height="14" uuid="bbea3352-0edd-4305-9d2b-be51bedaba7f"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="481" y="1" width="19" height="14" uuid="04d08705-78bd-44dc-bf00-1cbd68b4c719"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Rp.]]></text>
				</staticText>
				<staticText>
					<reportElement x="376" y="1" width="105" height="14" uuid="e9a2ebfa-1d54-4a4d-8392-b68a08b58b23"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="15">
				<staticText>
					<reportElement x="8" y="1" width="25" height="14" uuid="2795654d-59f2-4a20-a507-d86edf296cc0"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
			</band>
		</groupFooter>
	</group>
	<group name="ItemCategory">
		<groupExpression><![CDATA[$F{GROUP_ITEM_CAT}]]></groupExpression>
		<groupHeader>
			<band height="15">
				<printWhenExpression><![CDATA[$F{GROUP_NO}==1]]></printWhenExpression>
				<textField>
					<reportElement x="33" y="1" width="200" height="14" uuid="ca67c068-8103-40b8-8287-dfdae4f5db8e"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{GROUP_ITEM_CAT}]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Group" evaluationGroup="ItemCategory" pattern="#,###" isBlankWhenNull="true">
					<reportElement x="376" y="1" width="105" height="14" uuid="f657d473-9539-4672-8517-7637ad68de7a"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{TOTAL_2}]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Group" evaluationGroup="ItemCategory" pattern="#,###" isBlankWhenNull="true">
					<reportElement x="605" y="1" width="105" height="14" uuid="28f28021-352a-4272-ad84-37c8ab8a5c4d"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{AMT_HO_2}]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Group" evaluationGroup="ItemCategory" pattern="#,###" isBlankWhenNull="true">
					<reportElement x="710" y="1" width="105" height="14" uuid="1510b3cc-779c-4ca1-963c-92d149e57995"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{AMT_SBY_2}]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Group" evaluationGroup="ItemCategory" pattern="#,###" isBlankWhenNull="true">
					<reportElement x="815" y="1" width="105" height="14" uuid="27227a75-e528-4656-996d-546b5a4e065e"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{AMT_DPS_2}]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Group" evaluationGroup="ItemCategory" pattern="#,###" isBlankWhenNull="true">
					<reportElement x="920" y="1" width="105" height="14" uuid="2484bcba-f8fe-4385-a39f-38d9c2b682b1"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{AMT_CKR_2}]]></textFieldExpression>
				</textField>
				<textField evaluationTime="Group" evaluationGroup="ItemCategory" pattern="#,###" isBlankWhenNull="true">
					<reportElement x="1025" y="1" width="105" height="14" uuid="fae024c0-04ec-4cd1-af93-e255003f4504"/>
					<textElement textAlignment="Right">
						<font size="8" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{AMT_SMR_2}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="8" y="1" width="25" height="14" uuid="001be3fa-e44e-4650-9364-904ee5515293"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="233" y="1" width="19" height="14" uuid="72ba31af-c88c-4a96-869e-429014a934a9"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="252" y="1" width="105" height="14" uuid="891cbd11-0d08-4277-962c-488c7d4b17eb"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="357" y="1" width="19" height="14" uuid="ed31df5a-922e-4995-ad06-9c147e3b8aeb"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Rp.]]></text>
				</staticText>
				<staticText>
					<reportElement x="500" y="1" width="105" height="14" uuid="38294768-7e98-4728-8e0c-d58d6009c057"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<staticText>
					<reportElement x="481" y="1" width="19" height="14" uuid="24f5bcb8-56cc-48f9-a098-099f31993f44"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
			</band>
		</groupHeader>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="74" splitType="Stretch">
			<textField pattern="dd-MM-yyyy">
				<reportElement x="158" y="18" width="108" height="14" uuid="e983ef99-7a2c-412b-8c04-aa31da3407c1"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{TglInvFrom}]]></textFieldExpression>
			</textField>
			<textField pattern="dd-MM-yyyy">
				<reportElement x="294" y="18" width="187" height="14" uuid="a76e333a-f2cb-410c-a1dd-330ea4d1d958"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{TglInvTo}]]></textFieldExpression>
			</textField>
			<textField pattern="dd-MM-yyyy HH:mm:ss">
				<reportElement x="158" y="32" width="323" height="14" uuid="354c48b6-c745-4179-8c35-437bfbe26bc6"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="8" y="60" width="25" height="14" uuid="1a0a7d66-4dc0-4ec8-93c3-d8c90d44153b"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[No]]></text>
			</staticText>
			<staticText>
				<reportElement x="481" y="60" width="124" height="14" uuid="bc0b5f21-bd58-4128-90d9-0da9bfd247a3"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Value]]></text>
			</staticText>
			<staticText>
				<reportElement x="33" y="32" width="125" height="14" uuid="2416e567-b590-46cd-b14e-f9281133ba81"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Dicetak Pada :]]></text>
			</staticText>
			<staticText>
				<reportElement x="33" y="4" width="448" height="14" uuid="b3e39015-60b7-4554-84b0-56f951c68c37"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[(04019) Sales Revenue]]></text>
			</staticText>
			<staticText>
				<reportElement x="33" y="18" width="125" height="14" uuid="4eb2c989-0b8b-464e-9e93-b047e47ba9df"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Periode :]]></text>
			</staticText>
			<staticText>
				<reportElement x="8" y="32" width="25" height="14" uuid="86f4442f-d4fa-485e-a792-070757043699"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="266" y="18" width="28" height="14" uuid="7a7817d3-1ca0-4345-9306-f2cecc43279f"/>
				<textElement textAlignment="Center">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[S/D]]></text>
			</staticText>
			<staticText>
				<reportElement x="815" y="60" width="105" height="14" uuid="5e5ceff5-de3a-4cc9-a8c6-01c7ce8522f9"/>
				<textElement textAlignment="Right">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[DPS]]></text>
			</staticText>
			<staticText>
				<reportElement x="920" y="60" width="105" height="14" uuid="798b8235-df28-4de8-9158-3bf2fbfb4099"/>
				<textElement textAlignment="Right">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[CKR]]></text>
			</staticText>
			<staticText>
				<reportElement x="1025" y="60" width="105" height="14" uuid="87d55bb2-fb68-4e60-95e4-8bfdf7f67cc9"/>
				<textElement textAlignment="Right">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[SMR]]></text>
			</staticText>
			<staticText>
				<reportElement x="8" y="46" width="25" height="14" uuid="9291c97c-d705-4c4f-9b22-75a690c45d20"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="8" y="4" width="25" height="14" uuid="b6311f09-282d-4eb9-8e70-a658e3f827b1"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="8" y="18" width="25" height="14" uuid="795c6dcd-ca4b-491a-af39-28311afd70b3"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="33" y="46" width="448" height="14" uuid="c2958fed-a0e5-405b-876d-a86598f384bc"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="33" y="60" width="448" height="14" uuid="f47a3c22-aad1-4ef8-8762-fa524640460e"/>
				<textElement>
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[Keterangan]]></text>
			</staticText>
			<staticText>
				<reportElement x="605" y="60" width="105" height="14" uuid="1818ba43-b204-4c76-88c0-362881d0c1b4"/>
				<textElement textAlignment="Right">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[HO]]></text>
			</staticText>
			<staticText>
				<reportElement x="710" y="60" width="105" height="14" uuid="ca2ce7ef-7660-4370-879c-0101315383f6"/>
				<textElement textAlignment="Right">
					<font size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[SBY]]></text>
			</staticText>
		</band>
	</title>
	<detail>
		<band height="15" splitType="Stretch">
			<printWhenExpression><![CDATA[$F{GROUP_ITEM_CAT}.equals( "PS" )]]></printWhenExpression>
			<textField>
				<reportElement x="33" y="1" width="200" height="14" uuid="f3cec1b9-7fe6-48a6-82a8-65f3552fce5e"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{ITEM_CAT}]]></textFieldExpression>
			</textField>
			<textField pattern="#,###" isBlankWhenNull="true">
				<reportElement x="252" y="1" width="105" height="14" uuid="1594783e-23da-4d4a-af40-8dfd36911060"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{TOTAL}]]></textFieldExpression>
			</textField>
			<textField pattern="#,###" isBlankWhenNull="true">
				<reportElement x="605" y="1" width="105" height="14" uuid="358d9063-ef3b-42b0-be1c-101d09ad73b1"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{AMT_HO}]]></textFieldExpression>
			</textField>
			<textField pattern="#,###" isBlankWhenNull="true">
				<reportElement x="710" y="1" width="105" height="14" uuid="47d8606c-11ac-4dad-8ba5-edf4b0ef4b95"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{AMT_SBY}]]></textFieldExpression>
			</textField>
			<textField pattern="#,###" isBlankWhenNull="true">
				<reportElement x="815" y="1" width="105" height="14" uuid="a13936e8-6b92-49de-a634-8cf2964a2dbe"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{AMT_DPS}]]></textFieldExpression>
			</textField>
			<textField pattern="#,###" isBlankWhenNull="true">
				<reportElement x="920" y="1" width="105" height="14" uuid="b40352b4-da43-4f3e-abf3-77d64798a0aa"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{AMT_CKR}]]></textFieldExpression>
			</textField>
			<textField pattern="#,###" isBlankWhenNull="true">
				<reportElement x="1025" y="1" width="105" height="14" uuid="562d0c64-2d50-4369-94b6-23622ef2768c"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{AMT_SMR}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="8" y="1" width="25" height="14" uuid="93403b32-82a1-4cba-a0fb-aabfe157b97f"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="233" y="1" width="19" height="14" uuid="86c8bcdf-190c-479c-8d7f-908460b88d11"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[Rp.]]></text>
			</staticText>
			<staticText>
				<reportElement x="376" y="1" width="105" height="14" uuid="2e9267ef-463a-4272-be0f-c5d8998a27b0"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="357" y="1" width="19" height="14" uuid="be05d732-adf8-4c56-b970-3ea8329ca1dc"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="500" y="1" width="105" height="14" uuid="cb180ea8-e45f-4456-a7b2-8291838392ed"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
			<staticText>
				<reportElement x="481" y="1" width="19" height="14" uuid="f0da4591-dcb2-4b04-8986-a814426cd294"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<text><![CDATA[]]></text>
			</staticText>
		</band>
	</detail>
</jasperReport>
